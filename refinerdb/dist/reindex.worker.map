{"version":3,"sources":["../src/index.ts","../node_modules/tslib/tslib.es6.js","../src/functions/utils.ts","../src/helpers/debug.ts","../src/errors/errors.js","../src/functions/chaining-functions.js","../src/helpers/promise.js","../src/functions/temp-transaction.ts","../src/globals/constants.ts","../src/functions/combine.ts","../src/dbcore/keyrange.ts","../src/classes/table/table.ts","../src/helpers/Events.js","../src/functions/make-class-constructor.ts","../src/classes/table/table-constructor.ts","../src/classes/collection/collection-helpers.ts","../src/classes/collection/collection.ts","../src/classes/collection/collection-constructor.ts","../src/functions/compare-functions.ts","../src/classes/where-clause/where-clause-helpers.ts","../src/classes/where-clause/where-clause.ts","../src/classes/where-clause/where-clause-constructor.ts","../src/functions/quirks.ts","../src/functions/event-wrappers.ts","../src/classes/transaction/transaction.ts","../src/classes/transaction/transaction-constructor.ts","../src/helpers/index-spec.ts","../src/helpers/table-schema.ts","../src/dbcore/get-key-extractor.ts","../src/dbcore/get-effective-keys.ts","../src/dbcore/dbcore-indexeddb.ts","../src/classes/dexie/generate-middleware-stacks.ts","../src/classes/version/schema-helpers.ts","../src/classes/version/version.ts","../src/helpers/database-enumerator.ts","../src/classes/version/version-constructor.ts","../src/classes/dexie/vip.ts","../src/classes/dexie/dexie-open.ts","../src/helpers/yield-support.ts","../src/classes/dexie/transaction-helpers.ts","../src/dbcore/virtual-index-middleware.ts","../src/hooks/hooks-middleware.ts","../src/classes/dexie/dexie.ts","../src/classes/dexie/dexie-static-props.ts","../interfaces.ts","../helpers/indexers.ts","../../../node_modules/xstate/es/_virtual/_tslib.js","../../../node_modules/xstate/es/constants.js","../../../node_modules/xstate/es/environment.js","../../../node_modules/xstate/es/utils.js","../../../node_modules/xstate/es/mapState.js","../../../node_modules/xstate/es/types.js","../../../node_modules/xstate/es/actionTypes.js","../../../node_modules/xstate/es/actions.js","../../../node_modules/xstate/es/stateUtils.js","../../../node_modules/xstate/es/State.js","../../../node_modules/xstate/es/Actor.js","../../../node_modules/xstate/es/StateNode.js","../../../node_modules/xstate/es/Machine.js","../../../node_modules/xstate/es/scheduler.js","../../../node_modules/xstate/es/registry.js","../../../node_modules/xstate/es/devTools.js","../../../node_modules/xstate/es/interpreter.js","../../../node_modules/xstate/es/match.js","../../../node_modules/xstate/es/index.js","../stateMachine.ts","../../../node_modules/lodash/_arrayPush.js","../../../node_modules/lodash/_freeGlobal.js","../../../node_modules/lodash/_root.js","../../../node_modules/lodash/_Symbol.js","../../../node_modules/lodash/_getRawTag.js","../../../node_modules/lodash/_objectToString.js","../../../node_modules/lodash/_baseGetTag.js","../../../node_modules/lodash/isObjectLike.js","../../../node_modules/lodash/_baseIsArguments.js","../../../node_modules/lodash/isArguments.js","../../../node_modules/lodash/isArray.js","../../../node_modules/lodash/_isFlattenable.js","../../../node_modules/lodash/_baseFlatten.js","../../../node_modules/lodash/flatten.js","../../../node_modules/lodash/isObject.js","../../../node_modules/lodash/isFunction.js","../../../node_modules/lodash/_coreJsData.js","../../../node_modules/lodash/_isMasked.js","../../../node_modules/lodash/_toSource.js","../../../node_modules/lodash/_baseIsNative.js","../../../node_modules/lodash/_getValue.js","../../../node_modules/lodash/_getNative.js","../../../node_modules/lodash/_nativeCreate.js","../../../node_modules/lodash/_hashClear.js","../../../node_modules/lodash/_hashDelete.js","../../../node_modules/lodash/_hashGet.js","../../../node_modules/lodash/_hashHas.js","../../../node_modules/lodash/_hashSet.js","../../../node_modules/lodash/_Hash.js","../../../node_modules/lodash/_listCacheClear.js","../../../node_modules/lodash/eq.js","../../../node_modules/lodash/_assocIndexOf.js","../../../node_modules/lodash/_listCacheDelete.js","../../../node_modules/lodash/_listCacheGet.js","../../../node_modules/lodash/_listCacheHas.js","../../../node_modules/lodash/_listCacheSet.js","../../../node_modules/lodash/_ListCache.js","../../../node_modules/lodash/_Map.js","../../../node_modules/lodash/_mapCacheClear.js","../../../node_modules/lodash/_isKeyable.js","../../../node_modules/lodash/_getMapData.js","../../../node_modules/lodash/_mapCacheDelete.js","../../../node_modules/lodash/_mapCacheGet.js","../../../node_modules/lodash/_mapCacheHas.js","../../../node_modules/lodash/_mapCacheSet.js","../../../node_modules/lodash/_MapCache.js","../../../node_modules/lodash/_setCacheAdd.js","../../../node_modules/lodash/_setCacheHas.js","../../../node_modules/lodash/_SetCache.js","../../../node_modules/lodash/_baseFindIndex.js","../../../node_modules/lodash/_baseIsNaN.js","../../../node_modules/lodash/_strictIndexOf.js","../../../node_modules/lodash/_baseIndexOf.js","../../../node_modules/lodash/_arrayIncludes.js","../../../node_modules/lodash/_arrayIncludesWith.js","../../../node_modules/lodash/_cacheHas.js","../../../node_modules/lodash/_Set.js","../../../node_modules/lodash/noop.js","../../../node_modules/lodash/_setToArray.js","../../../node_modules/lodash/_createSet.js","../../../node_modules/lodash/_baseUniq.js","../../../node_modules/lodash/uniq.js","../../../node_modules/lodash/_arrayMap.js","../../../node_modules/lodash/_baseUnary.js","../../../node_modules/lodash/_baseIntersection.js","../../../node_modules/lodash/identity.js","../../../node_modules/lodash/_apply.js","../../../node_modules/lodash/_overRest.js","../../../node_modules/lodash/constant.js","../../../node_modules/lodash/_defineProperty.js","../../../node_modules/lodash/_baseSetToString.js","../../../node_modules/lodash/_shortOut.js","../../../node_modules/lodash/_setToString.js","../../../node_modules/lodash/_baseRest.js","../../../node_modules/lodash/isLength.js","../../../node_modules/lodash/isArrayLike.js","../../../node_modules/lodash/isArrayLikeObject.js","../../../node_modules/lodash/_castArrayLikeObject.js","../../../node_modules/lodash/intersection.js","../helpers/binarySearch.ts","../helpers/finders.ts","../../../node_modules/lodash/_stackClear.js","../../../node_modules/lodash/_stackDelete.js","../../../node_modules/lodash/_stackGet.js","../../../node_modules/lodash/_stackHas.js","../../../node_modules/lodash/_stackSet.js","../../../node_modules/lodash/_Stack.js","../../../node_modules/lodash/_arrayEach.js","../../../node_modules/lodash/_baseAssignValue.js","../../../node_modules/lodash/_assignValue.js","../../../node_modules/lodash/_copyObject.js","../../../node_modules/lodash/_baseTimes.js","../../../node_modules/lodash/stubFalse.js","../../../node_modules/lodash/isBuffer.js","../../../node_modules/lodash/_isIndex.js","../../../node_modules/lodash/_baseIsTypedArray.js","../../../node_modules/lodash/_nodeUtil.js","../../../node_modules/lodash/isTypedArray.js","../../../node_modules/lodash/_arrayLikeKeys.js","../../../node_modules/lodash/_isPrototype.js","../../../node_modules/lodash/_overArg.js","../../../node_modules/lodash/_nativeKeys.js","../../../node_modules/lodash/_baseKeys.js","../../../node_modules/lodash/keys.js","../../../node_modules/lodash/_baseAssign.js","../../../node_modules/lodash/_nativeKeysIn.js","../../../node_modules/lodash/_baseKeysIn.js","../../../node_modules/lodash/keysIn.js","../../../node_modules/lodash/_baseAssignIn.js","../../../node_modules/lodash/_cloneBuffer.js","../../../node_modules/lodash/_copyArray.js","../../../node_modules/lodash/_arrayFilter.js","../../../node_modules/lodash/stubArray.js","../../../node_modules/lodash/_getSymbols.js","../../../node_modules/lodash/_copySymbols.js","../../../node_modules/lodash/_getPrototype.js","../../../node_modules/lodash/_getSymbolsIn.js","../../../node_modules/lodash/_copySymbolsIn.js","../../../node_modules/lodash/_baseGetAllKeys.js","../../../node_modules/lodash/_getAllKeys.js","../../../node_modules/lodash/_getAllKeysIn.js","../../../node_modules/lodash/_DataView.js","../../../node_modules/lodash/_Promise.js","../../../node_modules/lodash/_WeakMap.js","../../../node_modules/lodash/_getTag.js","../../../node_modules/lodash/_initCloneArray.js","../../../node_modules/lodash/_Uint8Array.js","../../../node_modules/lodash/_cloneArrayBuffer.js","../../../node_modules/lodash/_cloneDataView.js","../../../node_modules/lodash/_cloneRegExp.js","../../../node_modules/lodash/_cloneSymbol.js","../../../node_modules/lodash/_cloneTypedArray.js","../../../node_modules/lodash/_initCloneByTag.js","../../../node_modules/lodash/_baseCreate.js","../../../node_modules/lodash/_initCloneObject.js","../../../node_modules/lodash/_baseIsMap.js","../../../node_modules/lodash/isMap.js","../../../node_modules/lodash/_baseIsSet.js","../../../node_modules/lodash/isSet.js","../../../node_modules/lodash/_baseClone.js","../../../node_modules/lodash/isSymbol.js","../../../node_modules/lodash/_isKey.js","../../../node_modules/lodash/memoize.js","../../../node_modules/lodash/_memoizeCapped.js","../../../node_modules/lodash/_stringToPath.js","../../../node_modules/lodash/_baseToString.js","../../../node_modules/lodash/toString.js","../../../node_modules/lodash/_castPath.js","../../../node_modules/lodash/last.js","../../../node_modules/lodash/_toKey.js","../../../node_modules/lodash/_baseGet.js","../../../node_modules/lodash/_baseSlice.js","../../../node_modules/lodash/_parent.js","../../../node_modules/lodash/_baseUnset.js","../../../node_modules/lodash/isPlainObject.js","../../../node_modules/lodash/_customOmitClone.js","../../../node_modules/lodash/_flatRest.js","../../../node_modules/lodash/omit.js","../helpers/filterParser.ts","../../../../../Users/apetersen/AppData/Roaming/npm/node_modules/parcel-bundler/node_modules/querystring-es3/decode.js","../../../../../Users/apetersen/AppData/Roaming/npm/node_modules/parcel-bundler/node_modules/querystring-es3/encode.js","../../../../../Users/apetersen/AppData/Roaming/npm/node_modules/parcel-bundler/node_modules/querystring-es3/index.js","../helpers/cache.ts","../helpers/reindex.ts","../RefinerDB.ts","../../../node_modules/symbol-observable/es/ponyfill.js","../../../node_modules/symbol-observable/es/index.js","../../../node_modules/is-observable/index.js","../../../node_modules/threads/dist/common.js","../../../node_modules/threads/dist/symbols.js","../../../node_modules/threads/dist/transferable.js","../../../node_modules/threads/dist/types/messages.js","../../../node_modules/threads/dist/worker/implementation.browser.js","../../../node_modules/threads/dist/worker/implementation.tiny-worker.js","../../../node_modules/threads/dist/worker_threads.js","../../../node_modules/threads/dist/worker/implementation.worker_threads.js","../../../../../Users/apetersen/AppData/Roaming/npm/node_modules/parcel-bundler/node_modules/process/browser.js","../../../node_modules/threads/dist/worker/implementation.js","../../../node_modules/threads/dist/worker/index.js","../../../node_modules/threads/worker.js","reindex.worker.ts"],"names":["Debug.setDebug","asap","props","Promise","keys","Debug.debug","Debug.getErrorWithStack","Dexie","_Dexie","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__values","o","m","Symbol","iterator","next","value","done","__read","r","ar","push","error","__spread","concat","STATE_DELIMITER","EMPTY_ACTIVITY_MAP","DEFAULT_GUARD_TYPE","TARGETLESS_KEY","IS_PRODUCTION","matchesState","parentStateId","childStateId","delimiter","parentStateValue","toStateValue","childStateValue","isString","every","key","getEventType","event","type","Error","toStatePath","stateId","isArray","toString","split","isStateLike","state","stateValue","pathToStateValue","statePath","marker","mapValues","collection","iteratee","result","collectionKeys","mapFilterValues","predicate","e_1","_a","_b","_c","item","e_1_1","return","path","object","e_2","props_1","props_1_1","e_2_1","nestedPath","accessorProp","e_3","props_2","props_2_1","prop","e_3_1","toStatePaths","flatten","map","subStateValue","subPath","array","toArrayStrict","toArray","undefined","mapContext","mapper","context","_event","e_5","isFunction","data","subMapper","e_5_1","isBuiltInEvent","eventType","test","isPromiseLike","then","partition","items","e_6","truthy","falsy","items_1","items_1_1","e_6_1","updateHistoryStates","hist","states","subHist","current","updateHistoryValue","updateContext","assignActions","updatedContext","warn","reduce","acc","assignAction","e_7","assignment","meta","action","partialUpdate","propAssignment","e_7_1","Array","toGuard","condition","guardMap","name","isObservable","subscribe","message","console","args","symbolObservable","observable","isMachine","uniqueId","currentId","toEventObject","payload","toSCXMLEvent","scxmlEvent","$$type","eventObject","toTransitionConfigArray","configLike","transitions","transitionLike","target","normalizeTarget","reportUnhandledExceptionOnInvocation","originalError","currentError","id","originalStackTrace","stack","stackTrace","mapState","stateMap","foundStateId","mappedStateId","ActionTypes","SpecialTargets","start","Start","stop","Stop","raise","Raise","send","Send","cancel","Cancel","nullEvent","NullEvent","Assign","after","After","doneState","DoneState","log","Log","init","Init","invoke","Invoke","errorExecution","ErrorExecution","errorPlatform","ErrorPlatform","ErrorCustom","update","Update","pure","Pure","initEvent","getActionFunction","actionType","actionFunctionMap","toActionObject","actionObject","exec","other","defineProperty","enumerable","configurable","toActionObjects","subAction","toActivityDefinition","raise$1","to","Internal","resolveRaise","options","send$1","delay","resolveSend","ctx","delaysMap","resolvedDelay","resolvedEvent","configDelay","resolvedTarget","sendParent","Parent","sendUpdate","respond","_","__","origin","defaultLogExpr","expr","label","log$1","resolveLog","sendId","cancel$1","activity","activityDef","assign$1","delayRef","idSuffix","doneInvoke","DoneInvoke","forwardTo","escalate","errorData","error$1","isLeafNode","stateNode","getChildren","getAllStateNodes","stateNodes","getConfiguration","prevStateNodes","e_4","_d","prevAdjList","getAdjList","Set","configuration","configuration_1","configuration_1_1","parent","has","add","adjList","configuration_2","configuration_2_1","get","_e","_f","child","forEach","sn","initialStateNodes","configuration_3","configuration_3_1","e_4_1","getValueFromAdj","baseNode","childStateNodes","childStateNode","csn","Map","configuration_4","configuration_4_1","set","getValue","rootNode","iterable","some","member","nextEvents","ownEvents","isInFinalState","stateValuesEqual","a","b","aKeys","bKeys","isState","bindActionToState","boundAction","State","config","actions","activities","events","_sessionid","historyValue","history","matches","bind","toStrings","children","from","create","inert","_this","valueKeys","toJSON","jsonValues","createNullActor","unsubscribe","createInvocableActor","invokeDefinition","tempActor","isActor","NULL_EVENT","STATE_IDENTIFIER","WILDCARD","EMPTY_OBJECT","isStateId","str","createDefaultOptions","guards","services","delays","validateArrayifiedTransitions","hasNonLastUnguardedTarget","slice","transition","eventText","StateNode","order","__xstatenode","__cache","relativeValue","initialStateValue","initialState","on","candidates","delayedTransitions","idMap","_parent","_key","machine","join","version","parallel","initial","stateConfig","dfs","_transient","strict","onEntry","entry","onExit","exit","invokeConfig","src","invokeSrc","_init","withConfig","withContext","definition","getDelayedTransitions","formatTransitions","getCandidates","eventName","transient","filter","sameEventType","afterConfig","mutateEntryExit","configTransition","resolvedTransition","isNaN","delayedTransition","formatTransition","getStateNodes","getStateNode","subStateKeys","subStateNodes","subStateKey","allSubStateNodes","subStateNode","handles","includes","resolveState","resolve","transitionLeafNode","transitionCompoundNode","_transition","transitionParallelNode","transitionMap","stateTransitions","enabledTransitions","st","entryNodes","entrySet","exitSet","source","selectedTransition","nextStateNodes","candidate","cond","stateIn","in","resolvedContext","isInState","getStateNodeById","guardPassed","evaluateGuard","err","allNextStateNodes","getRelativeStateNodes","isInternal","internal","nodesFromChild","escapes","nodes","guard","guardMeta","condFn","getActions","currentContext","prevState","prevConfig","resolvedConfig","resolvedConfig_1","resolvedConfig_1_1","prevConfig_1","prevConfig_1_1","doneEvents","grandparent","parentNode","sort","entryStates","exitStates","entryActions","exitActions","currentState","resolvedStateValue","getResolvedPath","stateTransition","resolveTransition","resolveRaisedTransition","originalEvent","currentActions","unshift","actions_1","actions_1_1","start$1","stop$1","otherActions","resolvedActions","sendAction","raisedEvents","nonRaisedActions","resolvedConfiguration","isDone","nextState","changed","maybeNextState","raisedEvent","shift","stateKey","resolvedStateId","getStateNodeByPath","arrayStatePath","currentStateNode","stateIdentifier","getInitialState","historyConfig","relativeStateId","resolveHistory","initialStateNodePaths","initialPath","getFromRelativePath","relativePath","childStatePath","relativeStateValue","historyTarget","relativeChildPath","subHistoryValue","subStatePath","childStateIds","stateIds","e_8","event_1","e_8_1","resolveTarget","_target","isInternalTarget","targetStateNode","transitionConfig","normalizedTarget","e_9","onConfig","wildcardConfigs","strictOnConfigs_1","arrayified","doneConfig","onDone","String","invokeDef","settleTransitions","onError","formattedTransitions","delayedTransitions_1","delayedTransitions_1_1","e_9_1","Machine","initialContext","resolvedInitialContext","createMachine","defaultOptions","deferEvents","Scheduler","processingEvent","queue","initialized","initialize","callback","schedule","process","flushEvents","task","clear","nextCallback","sessionIdIndex","registry","register","actor","lookup","actorRef","getDevTools","w","window","__xstate__","registerService","service","devTools","InterpreterStatus","DEFAULT_SPAWN_OPTIONS","sync","autoForward","withServiceScope","serviceStack","fn","pop","Interpreter","sessionId","scheduler","delayedEventsMap","listeners","contextListeners","stopListeners","doneListeners","eventListeners","sendListeners","_status","NotStarted","batch","Stopped","JSON","stringify","Running","forward","_state","sendTo","isParent","resolvedOptions","clock","logger","resolvedId","_initialState","execute","actionsConfig","listener","_g","_h","_j","_k","contextListener","finalChildStateNode","find","doneData","_l","_m","onTransition","nextListenerOrObserver","errorListener","completeListener","resolvedCompleteListener","complete","delete","onEvent","onSend","onChange","onStop","off","resolvedState","attachDev","e_10","_o","_p","_q","clearTimeout","e_10_1","e_11","batchChanged","batchedActions","_loop_1","events_1","events_1_1","e_11_1","sender","nextEvent","e_12","e_12_1","defer","setTimeout","actionOrExec","serviceCreator","spawnPromise","spawnCallback","spawnObservable","spawnMachine","spawnActivity","stopChild","childId","spawn","entity","spawnActor","childService","doneEvent","promise","canceled","response","errorEvent","handleError","unsubscribed","callbackStop","receivers","newListener","receiver","subscription","implementation","dispose","spawnEffect","__REDUX_DEVTOOLS_EXTENSION__","devToolsOptions","connect","autoPause","stateSanitizer","features","jump","skip","global","ms","interpret","resolveSpawnOptions","nameOrOptions","interpreter","matchState","patterns","defaultValue","patterns_1","patterns_1_1","obj","module","exports","qs","sep","eq","regexp","maxKeys","len","x","kstr","vstr","k","v","replace","idx","substr","decodeURIComponent","xs","stringifyPrimitive","isFinite","objectKeys","ks","encodeURIComponent","f","res","decode","parse","require","encode","symbolObservablePonyfill","root","self","Function","default","Boolean","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","runClearTimeout","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","Item","noop","nextTick","title","browser","env","argv","versions","addListener","once","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask"],"mappings":"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","file":"reindex.worker.map","sourceRoot":"..\\src\\workers","sourcesContent":["import { Dexie } from './classes/dexie';\nimport { DexieConstructor } from './public/types/dexie-constructor';\nimport { DexiePromise } from './helpers/promise';\nimport { mapError } from './errors';\nimport * as Debug from './helpers/debug';\nimport { dexieStackFrameFilter } from './globals/constants';\nimport { initDatabaseEnumerator } from './helpers/database-enumerator';\n\n// Generate all static properties such as Dexie.maxKey etc\n// (implement interface DexieConstructor):\nimport './classes/dexie/dexie-static-props';\n\n// Init Database Enumerator (for Dexie.getDatabaseNames())\ninitDatabaseEnumerator((Dexie as any as DexieConstructor).dependencies.indexedDB);\n\n// Set rejectionMapper of DexiePromise so that it generally tries to map\n// DOMErrors and DOMExceptions to a DexieError instance with same name but with\n// async stack support and with a prototypal inheritance from DexieError and Error.\n// of Map DOMErrors and DOMExceptions to corresponding Dexie errors.\nDexiePromise.rejectionMapper = mapError;\n\n// Let the async stack filter focus on app code and filter away frames from dexie.min.js:\nDebug.setDebug(Debug.debug, dexieStackFrameFilter);\n\nexport default Dexie;\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","﻿declare var global;\nexport const keys = Object.keys;\nexport const isArray = Array.isArray;\nconst _global =\n    typeof self !== 'undefined' ? self :\n    typeof window !== 'undefined' ? window :\n    global;\nif (typeof Promise !== 'undefined' && !_global.Promise){\n    // In jsdom, this it can be the case that Promise is not put on the global object.\n    // If so, we need to patch the global object for the rest of the code to work as expected.\n    // Other dexie code expects Promise to be on the global object (like normal browser environments)\n    _global.Promise = Promise;\n}\nexport { _global }\n\nexport function extend(obj, extension) {\n    if (typeof extension !== 'object') return obj;\n    keys(extension).forEach(function (key) {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\n\nexport const getProto = Object.getPrototypeOf;\nexport const _hasOwn = {}.hasOwnProperty;\nexport function hasOwn(obj, prop) {\n    return _hasOwn.call(obj, prop);\n}\n\nexport function props (proto, extension) {\n    if (typeof extension === 'function') extension = extension(getProto(proto));\n    keys(extension).forEach(key => {\n        setProp(proto, key, extension[key]);\n    });\n}\n\nexport const defineProperty = Object.defineProperty;\n\nexport function setProp(obj, prop, functionOrGetSet, options?) {\n    defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ?\n        {get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true} :\n        {value: functionOrGetSet, configurable: true, writable: true}, options));\n}\n\nexport function derive(Child) {\n    return {\n        from: function (Parent) {\n            Child.prototype = Object.create(Parent.prototype);\n            setProp(Child.prototype, \"constructor\", Child);\n            return {\n                extend: props.bind(null, Child.prototype)\n            };\n        }\n    };\n}\n\nexport const getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\nexport function getPropertyDescriptor(obj, prop) {\n    const pd = getOwnPropertyDescriptor(obj, prop);\n    let proto;\n    return pd || (proto = getProto(obj)) && getPropertyDescriptor (proto, prop);\n}\n\nconst _slice = [].slice;\nexport function slice(args, start?, end?) {\n    return _slice.call(args, start, end);\n}\n\nexport function override(origFunc, overridedFactory) {\n    return overridedFactory(origFunc);\n}\n\nexport function assert (b) {\n    if (!b) throw new Error(\"Assertion Failed\");\n}\n\nexport function asap(fn) {\n    if (_global.setImmediate) setImmediate(fn); else setTimeout(fn, 0);\n}\n\nexport function getUniqueArray(a) {\n    return a.filter((value, index, self) => self.indexOf(value) === index);\n}\n\n/** Generate an object (hash map) based on given array.\n * @param extractor Function taking an array item and its index and returning an array of 2 items ([key, value]) to\n *        instert on the resulting object for each item in the array. If this function returns a falsy value, the\n *        current item wont affect the resulting object.\n */\nexport function arrayToObject (array, extractor) {\n    return array.reduce((result, item, i) => {\n        var nameAndValue = extractor(item, i);\n        if (nameAndValue) result[nameAndValue[0]] = nameAndValue[1];\n        return result;\n    }, {});\n}\n\nexport function trycatcher(fn, reject) {\n    return function () {\n        try {\n            fn.apply(this, arguments);\n        } catch (e) {\n            reject(e);\n        }\n    };\n}\n\nexport function tryCatch(fn: (...args: any[])=>void, onerror, args?) : void {\n    try {\n        fn.apply(null, args);\n    } catch (ex) {\n        onerror && onerror(ex);\n    }\n}\n\nexport function getByKeyPath(obj, keyPath) {\n    // http://www.w3.org/TR/IndexedDB/#steps-for-extracting-a-key-from-a-value-using-a-key-path\n    if (hasOwn(obj, keyPath)) return obj[keyPath]; // This line is moved from last to first for optimization purpose.\n    if (!keyPath) return obj;\n    if (typeof keyPath !== 'string') {\n        var rv = [];\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            var val = getByKeyPath(obj, keyPath[i]);\n            rv.push(val);\n        }\n        return rv;\n    }\n    var period = keyPath.indexOf('.');\n    if (period !== -1) {\n        var innerObj = obj[keyPath.substr(0, period)];\n        return innerObj === undefined ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n    }\n    return undefined;\n}\n\nexport function setByKeyPath(obj, keyPath, value) {\n    if (!obj || keyPath === undefined) return;\n    if ('isFrozen' in Object && Object.isFrozen(obj)) return;\n    if (typeof keyPath !== 'string' && 'length' in keyPath) {\n        assert(typeof value !== 'string' && 'length' in value);\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            setByKeyPath(obj, keyPath[i], value[i]);\n        }\n    } else {\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var currentKeyPath = keyPath.substr(0, period);\n            var remainingKeyPath = keyPath.substr(period + 1);\n            if (remainingKeyPath === \"\")\n                if (value === undefined) {\n                    if (isArray(obj) && !isNaN(parseInt(currentKeyPath))) obj.splice(currentKeyPath, 1);\n                    else delete obj[currentKeyPath];\n                } else obj[currentKeyPath] = value;\n            else {\n                var innerObj = obj[currentKeyPath];\n                if (!innerObj) innerObj = (obj[currentKeyPath] = {});\n                setByKeyPath(innerObj, remainingKeyPath, value);\n            }\n        } else {\n            if (value === undefined) {\n                if (isArray(obj) && !isNaN(parseInt(keyPath))) obj.splice(keyPath, 1);\n                else delete obj[keyPath];\n            } else obj[keyPath] = value;\n        }\n    }\n}\n\nexport function delByKeyPath(obj, keyPath) {\n    if (typeof keyPath === 'string')\n        setByKeyPath(obj, keyPath, undefined);\n    else if ('length' in keyPath)\n        [].map.call(keyPath, function(kp) {\n            setByKeyPath(obj, kp, undefined);\n        });\n}\n\nexport function shallowClone(obj) {\n    var rv = {};\n    for (var m in obj) {\n        if (hasOwn(obj, m)) rv[m] = obj[m];\n    }\n    return rv;\n}\n\nconst concat = [].concat;\nexport function flatten<T> (a: (T | T[])[]) : T[] {\n    return concat.apply([], a);\n}\n\n//https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm\nconst intrinsicTypeNames =\n    \"Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set\"\n    .split(',').concat(\n        flatten([8,16,32,64].map(num=>[\"Int\",\"Uint\",\"Float\"].map(t=>t+num+\"Array\")))\n    ).filter(t=>_global[t]);\nconst intrinsicTypes = intrinsicTypeNames.map(t=>_global[t]);\nconst intrinsicTypeNameSet = arrayToObject(intrinsicTypeNames, x=>[x,true]);\n\nexport function deepClone<T>(any: T): T {\n    if (!any || typeof any !== 'object') return any;\n    var rv;\n    if (isArray(any)) {\n        rv = [];\n        for (var i = 0, l = any.length; i < l; ++i) {\n            rv.push(deepClone(any[i]));\n        }\n    } else if (intrinsicTypes.indexOf(any.constructor) >= 0) {\n        rv = any;\n    } else {\n        rv = any.constructor ? Object.create(any.constructor.prototype) : {};\n        for (var prop in any) {\n            if (hasOwn(any, prop)) {\n                rv[prop] = deepClone(any[prop]);\n            }\n        }\n    }\n    return rv;\n}\n\nconst {toString} = {};\nexport function toStringTag(o: Object) {\n    return toString.call(o).slice(8, -1);\n}\n\nexport const getValueOf = (val:any, type: string) => \n    type === \"Array\" ? ''+val.map(v => getValueOf(v, toStringTag(v))) :\n    type === \"ArrayBuffer\" ? ''+new Uint8Array(val) :\n    type === \"Date\" ? val.getTime() :\n    ArrayBuffer.isView(val) ? ''+new Uint8Array(val.buffer) :\n    val;\n\n export function getObjectDiff(a, b, rv?, prfx?) {\n    // Compares objects a and b and produces a diff object.\n    rv = rv || {};\n    prfx = prfx || '';\n    keys(a).forEach(prop => {\n        if (!hasOwn(b, prop))\n            rv[prfx+prop] = undefined; // Property removed\n        else {\n            var ap = a[prop],\n                bp = b[prop];\n            if (typeof ap === 'object' && typeof bp === 'object' && ap && bp)\n            {\n                const apTypeName = toStringTag(ap);\n                const bpTypeName = toStringTag(bp);\n\n                if (apTypeName === bpTypeName) {\n                    if (intrinsicTypeNameSet[apTypeName]) {\n                        // This is an intrinsic type. Don't go deep diffing it.\n                        // Instead compare its value in best-effort:\n                        // (Can compare real values of Date, ArrayBuffers and views)\n                        if (getValueOf(ap, apTypeName) !== getValueOf(bp, bpTypeName)) {\n                            rv[prfx + prop] = b[prop]; // Date / ArrayBuffer etc is of different value\n                        }\n                    } else {\n                        // This is not an intrinsic object. Compare the it deeply:\n                        getObjectDiff(ap, bp, rv, prfx + prop + \".\");\n                    }\n                } else {\n                    rv[prfx + prop] = b[prop];// Property changed to other type\n                }                \n            } else if (ap !== bp)\n                rv[prfx + prop] = b[prop];// Primitive value changed\n        }\n    });\n    keys(b).forEach(prop => {\n        if (!hasOwn(a, prop)) {\n            rv[prfx+prop] = b[prop]; // Property added\n        }\n    });\n    return rv;\n}\n\n// If first argument is iterable or array-like, return it as an array\nexport const iteratorSymbol = typeof Symbol !== 'undefined' && Symbol.iterator;\nexport const getIteratorOf = iteratorSymbol ? function(x) {\n    var i;\n    return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n} : function () { return null; };\n\nexport const NO_CHAR_ARRAY = {};\n// Takes one or several arguments and returns an array based on the following criteras:\n// * If several arguments provided, return arguments converted to an array in a way that\n//   still allows javascript engine to optimize the code.\n// * If single argument is an array, return a clone of it.\n// * If this-pointer equals NO_CHAR_ARRAY, don't accept strings as valid iterables as a special\n//   case to the two bullets below.\n// * If single argument is an iterable, convert it to an array and return the resulting array.\n// * If single argument is array-like (has length of type number), convert it to an array.\nexport function getArrayOf (arrayLike) {\n    var i, a, x, it;\n    if (arguments.length === 1) {\n        if (isArray(arrayLike)) return arrayLike.slice();\n        if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string') return [arrayLike];\n        if ((it = getIteratorOf(arrayLike))) {\n            a = [];\n            while ((x = it.next()), !x.done) a.push(x.value);\n            return a;\n        }\n        if (arrayLike == null) return [arrayLike];\n        i = arrayLike.length;\n        if (typeof i === 'number') {\n            a = new Array(i);\n            while (i--) a[i] = arrayLike[i];\n            return a;\n        }\n        return [arrayLike];\n    }\n    i = arguments.length;\n    a = new Array(i);\n    while (i--) a[i] = arguments[i];\n    return a;\n}\n","// By default, debug will be true only if platform is a web platform and its page is served from localhost.\n// When debug = true, error's stacks will contain asyncronic long stacks.\nexport var debug = typeof location !== 'undefined' &&\n        // By default, use debug mode if served from localhost.\n        /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\n\nexport function setDebug(value, filter) {\n    debug = value;\n    libraryFilter = filter;\n}\n\nexport var libraryFilter = () => true;\n\nexport const NEEDS_THROW_FOR_STACK = !new Error(\"\").stack;\n\nexport function getErrorWithStack() {\n    \"use strict\";\n    if (NEEDS_THROW_FOR_STACK) try {\n        // Doing something naughty in strict mode here to trigger a specific error\n        // that can be explicitely ignored in debugger's exception settings.\n        // If we'd just throw new Error() here, IE's debugger's exception settings\n        // will just consider it as \"exception thrown by javascript code\" which is\n        // something you wouldn't want it to ignore.\n        getErrorWithStack.arguments;\n        throw new Error(); // Fallback if above line don't throw.\n    } catch(e) {\n        return e;\n    }\n    return new Error();\n}\n\nexport function prettyStack(exception, numIgnoredFrames) {\n    var stack = exception.stack;\n    if (!stack) return \"\";\n    numIgnoredFrames = (numIgnoredFrames || 0);\n    if (stack.indexOf(exception.name) === 0)\n        numIgnoredFrames += (exception.name + exception.message).split('\\n').length;\n    return stack.split('\\n')\n        .slice(numIgnoredFrames)\n        .filter(libraryFilter)\n        .map(frame => \"\\n\" + frame)\n        .join('');\n}\n\n// TODO: Replace this in favor of a decorator instead.\nexport function deprecated<T> (what: string, fn: (...args)=>T) {\n    return function () {\n        console.warn(`${what} is deprecated. See http://dexie.org/docs/Deprecations. ${prettyStack(getErrorWithStack(), 1)}`);\n        return fn.apply(this, arguments);\n    } as (...args)=>T\n}\n","import { derive, setProp } from '../functions/utils';\nimport { getErrorWithStack, prettyStack } from '../helpers/debug';\n\nvar dexieErrorNames = [\n    'Modify',\n    'Bulk',\n    'OpenFailed',\n    'VersionChange',\n    'Schema',\n    'Upgrade',\n    'InvalidTable',\n    'MissingAPI',\n    'NoSuchDatabase',\n    'InvalidArgument',\n    'SubTransaction',\n    'Unsupported',\n    'Internal',\n    'DatabaseClosed',\n    'PrematureCommit',\n    'ForeignAwait'\n];\n\nvar idbDomErrorNames = [\n    'Unknown',\n    'Constraint',\n    'Data',\n    'TransactionInactive',\n    'ReadOnly',\n    'Version',\n    'NotFound',\n    'InvalidState',\n    'InvalidAccess',\n    'Abort',\n    'Timeout',\n    'QuotaExceeded',\n    'Syntax',\n    'DataClone'\n];\n\nvar errorList = dexieErrorNames.concat(idbDomErrorNames);\n\nvar defaultTexts = {\n    VersionChanged: \"Database version changed by other database connection\",\n    DatabaseClosed: \"Database has been closed\",\n    Abort: \"Transaction aborted\",\n    TransactionInactive: \"Transaction has already completed or failed\"\n};\n\n//\n// DexieError - base class of all out exceptions.\n//\nexport function DexieError (name, msg) {\n    // Reason we don't use ES6 classes is because:\n    // 1. It bloats transpiled code and increases size of minified code.\n    // 2. It doesn't give us much in this case.\n    // 3. It would require sub classes to call super(), which\n    //    is not needed when deriving from Error.\n    this._e = getErrorWithStack();\n    this.name = name;\n    this.message = msg;\n}\n\nderive(DexieError).from(Error).extend({\n    stack: {\n        get: function() {\n            return this._stack ||\n                (this._stack = this.name + \": \" + this.message + prettyStack(this._e, 2));\n        }\n    },\n    toString: function(){ return this.name + \": \" + this.message; }\n});\n\nfunction getMultiErrorMessage (msg, failures) {\n    return msg + \". Errors: \" + Object.keys(failures)\n        .map(key=>failures[key].toString())\n        .filter((v,i,s)=>s.indexOf(v) === i) // Only unique error strings\n        .join('\\n');\n}\n\n//\n// ModifyError - thrown in Collection.modify()\n// Specific constructor because it contains members failures and failedKeys.\n//\nexport function ModifyError (msg, failures, successCount, failedKeys) {\n    this._e = getErrorWithStack();\n    this.failures = failures;\n    this.failedKeys = failedKeys;\n    this.successCount = successCount;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(ModifyError).from(DexieError);\n\nexport function BulkError (msg, failures) {\n    this._e = getErrorWithStack();\n    this.name = \"BulkError\";\n    this.failures = failures;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(BulkError).from(DexieError);\n\n//\n//\n// Dynamically generate error names and exception classes based\n// on the names in errorList.\n//\n//\n\n// Map of {ErrorName -> ErrorName + \"Error\"}\nexport var errnames = errorList.reduce((obj,name)=>(obj[name]=name+\"Error\",obj),{});\n\n// Need an alias for DexieError because we're gonna create subclasses with the same name.\nconst BaseException = DexieError;\n// Map of {ErrorName -> exception constructor}\nexport var exceptions = errorList.reduce((obj,name)=>{\n    // Let the name be \"DexieError\" because this name may\n    // be shown in call stack and when debugging. DexieError is\n    // the most true name because it derives from DexieError,\n    // and we cannot change Function.name programatically without\n    // dynamically create a Function object, which would be considered\n    // 'eval-evil'.\n    var fullName = name + \"Error\";\n    function DexieError (msgOrInner, inner){\n        this._e = getErrorWithStack();\n        this.name = fullName;\n        if (!msgOrInner) {\n            this.message = defaultTexts[name] || fullName;\n            this.inner = null;\n        } else if (typeof msgOrInner === 'string') {\n            this.message = `${msgOrInner}${!inner ? '' : '\\n ' + inner}`;\n            this.inner = inner || null;\n        } else if (typeof msgOrInner === 'object') {\n            this.message = `${msgOrInner.name} ${msgOrInner.message}`;\n            this.inner = msgOrInner;\n        }\n    }\n    derive(DexieError).from(BaseException);\n    obj[name]=DexieError;\n    return obj;\n},{});\n\n// Use ECMASCRIPT standard exceptions where applicable:\nexceptions.Syntax = SyntaxError;\nexceptions.Type = TypeError;\nexceptions.Range = RangeError;\n\nexport var exceptionMap = idbDomErrorNames.reduce((obj, name)=>{\n    obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\n\nexport function mapError (domError, message) {\n    if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name])\n        return domError;\n    var rv = new exceptionMap[domError.name](message || domError.message, domError);\n    if (\"stack\" in domError) {\n        // Derive stack from inner exception if it has a stack\n        setProp(rv, \"stack\", {get: function(){\n            return this.inner.stack;\n        }});\n    }\n    return rv;\n}\n\nexport var fullNameExceptions = errorList.reduce((obj, name)=>{\n    if ([\"Syntax\",\"Type\",\"Range\"].indexOf(name) === -1)\n        obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\n\nfullNameExceptions.ModifyError = ModifyError;\nfullNameExceptions.DexieError = DexieError;\nfullNameExceptions.BulkError = BulkError;\n","import {extend} from './utils';\n\nexport function nop() { }\nexport function mirror(val) { return val; }\nexport function pureFunctionChain(f1, f2) {\n    // Enables chained events that takes ONE argument and returns it to the next function in chain.\n    // This pattern is used in the hook(\"reading\") event.\n    if (f1 == null || f1 === mirror) return f2;\n    return function (val) {\n        return f2(f1(val));\n    };\n}\n\nexport function callBoth(on1, on2) {\n    return function () {\n        on1.apply(this, arguments);\n        on2.apply(this, arguments);\n    };\n}\n\nexport function hookCreatingChain(f1, f2) {\n    // Enables chained events that takes several arguments and may modify first argument by making a modification and then returning the same instance.\n    // This pattern is used in the hook(\"creating\") event.\n    if (f1 === nop) return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res !== undefined) arguments[0] = res;\n        var onsuccess = this.onsuccess, // In case event listener has set this.onsuccess\n            onerror = this.onerror;     // In case event listener has set this.onerror\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res2 !== undefined ? res2 : res;\n    };\n}\n\nexport function hookDeletingChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function () {\n        f1.apply(this, arguments);\n        var onsuccess = this.onsuccess, // In case event listener has set this.onsuccess\n            onerror = this.onerror;     // In case event listener has set this.onerror\n        this.onsuccess = this.onerror = null;\n        f2.apply(this, arguments);\n        if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n    };\n}\n\nexport function hookUpdatingChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function (modifications) {\n        var res = f1.apply(this, arguments);\n        extend(modifications, res); // If f1 returns new modifications, extend caller's modifications with the result before calling next in chain.\n        var onsuccess = this.onsuccess, // In case event listener has set this.onsuccess\n            onerror = this.onerror;     // In case event listener has set this.onerror\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess) this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror) this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res === undefined ?\n            (res2 === undefined ? undefined : res2) :\n            (extend(res, res2));\n    };\n}\n\nexport function reverseStoppableEventChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function () {\n        if (f2.apply(this, arguments) === false) return false;\n        return f1.apply(this, arguments);\n    };\n}\n\nexport function nonStoppableEventChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function () {\n        f1.apply(this, arguments);\n        f2.apply(this, arguments);\n    };\n}\n\nexport function promisableChain(f1, f2) {\n    if (f1 === nop) return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res && typeof res.then === 'function') {\n            var thiz = this,\n                i = arguments.length,\n                args = new Array(i);\n            while (i--) args[i] = arguments[i];\n            return res.then(function () {\n                return f2.apply(thiz, args);\n            });\n        }\n        return f2.apply(this, arguments);\n    };\n}\n","/*\n * Copyright (c) 2014-2017 David Fahlander\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/LICENSE-2.0\n */\nimport {tryCatch, props, setProp, _global,\n    getPropertyDescriptor, getArrayOf, extend} from '../functions/utils';\nimport {nop, callBoth, mirror} from '../functions/chaining-functions';\nimport {debug, prettyStack, getErrorWithStack} from './debug';\nimport {exceptions} from '../errors';\n\n//\n// Promise and Zone (PSD) for Dexie library\n//\n// I started out writing this Promise class by copying promise-light (https://github.com/taylorhakes/promise-light) by\n// https://github.com/taylorhakes - an A+ and ECMASCRIPT 6 compliant Promise implementation.\n//\n// In previous versions this was fixed by not calling setTimeout when knowing that the resolve() or reject() came from another\n// tick. In Dexie v1.4.0, I've rewritten the Promise class entirely. Just some fragments of promise-light is left. I use\n// another strategy now that simplifies everything a lot: to always execute callbacks in a new micro-task, but have an own micro-task\n// engine that is indexedDB compliant across all browsers.\n// Promise class has also been optimized a lot with inspiration from bluebird - to avoid closures as much as possible.\n// Also with inspiration from bluebird, asyncronic stacks in debug mode.\n//\n// Specific non-standard features of this Promise class:\n// * Custom zone support (a.k.a. PSD) with ability to keep zones also when using native promises as well as\n//   native async / await.\n// * Promise.follow() method built upon the custom zone engine, that allows user to track all promises created from current stack frame\n//   and below + all promises that those promises creates or awaits.\n// * Detect any unhandled promise in a PSD-scope (PSD.onunhandled). \n//\n// David Fahlander, https://github.com/dfahlander\n//\n\n// Just a pointer that only this module knows about.\n// Used in Promise constructor to emulate a private constructor.\nvar INTERNAL = {};\n\n// Async stacks (long stacks) must not grow infinitely.\nconst\n    LONG_STACKS_CLIP_LIMIT = 100,\n    // When calling error.stack or promise.stack, limit the number of asyncronic stacks to print out. \n    MAX_LONG_STACKS = 20,\n    ZONE_ECHO_LIMIT = 100,\n    [resolvedNativePromise, nativePromiseProto, resolvedGlobalPromise] = typeof Promise === 'undefined' ?\n        [] :\n        (()=>{\n            let globalP = Promise.resolve();\n            if (typeof crypto === 'undefined' || !crypto.subtle)\n                return [globalP, globalP.__proto__, globalP];\n            // Generate a native promise (as window.Promise may have been patched)\n            const nativeP = crypto.subtle.digest(\"SHA-512\", new Uint8Array([0]));\n            return [\n                nativeP,\n                nativeP.__proto__,\n                globalP\n            ];\n        })(),\n    nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\n\nexport const NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\nconst patchGlobalPromise = !!resolvedGlobalPromise;\n\nvar stack_being_generated = false;\n\n/* The default function used only for the very first promise in a promise chain.\n   As soon as then promise is resolved or rejected, all next tasks will be executed in micro ticks\n   emulated in this module. For indexedDB compatibility, this means that every method needs to \n   execute at least one promise before doing an indexedDB operation. Dexie will always call \n   db.ready().then() for every operation to make sure the indexedDB event is started in an\n   indexedDB-compatible emulated micro task loop.\n*/\nvar schedulePhysicalTick = resolvedGlobalPromise ?\n    () => {resolvedGlobalPromise.then(physicalTick);}\n    :\n    _global.setImmediate ? \n        // setImmediate supported. Those modern platforms also supports Function.bind().\n        setImmediate.bind(null, physicalTick) :\n        _global.MutationObserver ?\n            // MutationObserver supported\n            () => {\n                var hiddenDiv = document.createElement(\"div\");\n                (new MutationObserver(() => {\n                    physicalTick();\n                    hiddenDiv = null;\n                })).observe(hiddenDiv, { attributes: true });\n                hiddenDiv.setAttribute('i', '1');\n            } :\n            // No support for setImmediate or MutationObserver. No worry, setTimeout is only called\n            // once time. Every tick that follows will be our emulated micro tick.\n            // Could have uses setTimeout.bind(null, 0, physicalTick) if it wasnt for that FF13 and below has a bug \n            ()=>{setTimeout(physicalTick,0);};\n\n// Configurable through Promise.scheduler.\n// Don't export because it would be unsafe to let unknown\n// code call it unless they do try..catch within their callback.\n// This function can be retrieved through getter of Promise.scheduler though,\n// but users must not do Promise.scheduler = myFuncThatThrowsException\nvar asap = function (callback, args) {\n    microtickQueue.push([callback, args]);\n    if (needsNewPhysicalTick) {\n        schedulePhysicalTick();\n        needsNewPhysicalTick = false;\n    }\n};\n\nvar isOutsideMicroTick = true, // True when NOT in a virtual microTick.\n    needsNewPhysicalTick = true, // True when a push to microtickQueue must also schedulePhysicalTick()\n    unhandledErrors = [], // Rejected promises that has occured. Used for triggering 'unhandledrejection'.\n    rejectingErrors = [], // Tracks if errors are being re-rejected during onRejected callback.\n    currentFulfiller = null,\n    rejectionMapper = mirror; // Remove in next major when removing error mapping of DOMErrors and DOMExceptions\n    \nexport var globalPSD = {\n    id: 'global',\n    global: true,\n    ref: 0,\n    unhandleds: [],\n    onunhandled: globalError,\n    pgp: false,\n    env: {},\n    finalize: function () {\n        this.unhandleds.forEach(uh => {\n            try {\n                globalError(uh[0], uh[1]);\n            } catch (e) {}\n        });\n    }\n};\n\nexport var PSD = globalPSD;\n\nexport var microtickQueue = []; // Callbacks to call in this or next physical tick.\nexport var numScheduledCalls = 0; // Number of listener-calls left to do in this physical tick.\nexport var tickFinalizers = []; // Finalizers to call when there are no more async calls scheduled within current physical tick.\n\nexport default function DexiePromise(fn) {\n    if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');    \n    this._listeners = [];\n    this.onuncatched = nop; // Deprecate in next major. Not needed. Better to use global error handler.\n    \n    // A library may set `promise._lib = true;` after promise is created to make resolve() or reject()\n    // execute the microtask engine implicitely within the call to resolve() or reject().\n    // To remain A+ compliant, a library must only set `_lib=true` if it can guarantee that the stack\n    // only contains library code when calling resolve() or reject().\n    // RULE OF THUMB: ONLY set _lib = true for promises explicitely resolving/rejecting directly from\n    // global scope (event handler, timer etc)!\n    this._lib = false;\n    // Current async scope\n    var psd = (this._PSD = PSD);\n\n    if (debug) {\n        this._stackHolder = getErrorWithStack();\n        this._prev = null;\n        this._numPrev = 0; // Number of previous promises (for long stacks)\n    }\n    \n    if (typeof fn !== 'function') {\n        if (fn !== INTERNAL) throw new TypeError('Not a function');\n        // Private constructor (INTERNAL, state, value).\n        // Used internally by Promise.resolve() and Promise.reject().\n        this._state = arguments[1];\n        this._value = arguments[2];\n        if (this._state === false)\n            handleRejection(this, this._value); // Map error, set stack and addPossiblyUnhandledError().\n        return;\n    }\n    \n    this._state = null; // null (=pending), false (=rejected) or true (=resolved)\n    this._value = null; // error or result\n    ++psd.ref; // Refcounting current scope\n    executePromiseTask(this, fn);\n}\n\n// Prepare a property descriptor to put onto Promise.prototype.then\nconst thenProp = {\n    get: function() {\n        var psd = PSD, microTaskId = totalEchoes;\n\n        function then (onFulfilled, onRejected) {\n            var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n            if (possibleAwait) decrementExpectedAwaits();\n            var rv = new DexiePromise((resolve, reject) => {\n                propagateToListener(this, new Listener(\n                    nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait),\n                    nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait),\n                    resolve,\n                    reject,\n                    psd));\n            });\n            debug && linkToPreviousPromise(rv, this);\n            return rv;\n        }\n\n        then.prototype = INTERNAL; // For idempotense, see setter below.\n\n        return then;\n    },\n    // Be idempotent and allow another framework (such as zone.js or another instance of a Dexie.Promise module) to replace Promise.prototype.then\n    // and when that framework wants to restore the original property, we must identify that and restore the original property descriptor.\n    set: function (value) {\n        setProp (this, 'then', value && value.prototype === INTERNAL ?\n            thenProp : // Restore to original property descriptor.\n            {\n                get: function(){\n                    return value; // Getter returning provided value (behaves like value is just changed)\n                },\n                set: thenProp.set // Keep a setter that is prepared to restore original.\n            }\n        );\n    }\n};\n\nprops(DexiePromise.prototype, {\n    then: thenProp, // Defined above.\n    _then: function (onFulfilled, onRejected) {\n        // A little tinier version of then() that don't have to create a resulting promise.\n        propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));        \n    },\n\n    catch: function (onRejected) {\n        if (arguments.length === 1) return this.then(null, onRejected);\n        // First argument is the Error type to catch\n        var type = arguments[0],\n            handler = arguments[1];\n        return typeof type === 'function' ? this.then(null, err =>\n            // Catching errors by its constructor type (similar to java / c++ / c#)\n            // Sample: promise.catch(TypeError, function (e) { ... });\n            err instanceof type ? handler(err) : PromiseReject(err))\n        : this.then(null, err =>\n            // Catching errors by the error.name property. Makes sense for indexedDB where error type\n            // is always DOMError but where e.name tells the actual error type.\n            // Sample: promise.catch('ConstraintError', function (e) { ... });\n            err && err.name === type ? handler(err) : PromiseReject(err));\n    },\n\n    finally: function (onFinally) {\n        return this.then(value => {\n            onFinally();\n            return value;\n        }, err => {\n            onFinally();\n            return PromiseReject(err);\n        });\n    },\n    \n    stack: {\n        get: function() {\n            if (this._stack) return this._stack;\n            try {\n                stack_being_generated = true;\n                var stacks = getStack (this, [], MAX_LONG_STACKS);\n                var stack = stacks.join(\"\\nFrom previous: \");\n                if (this._state !== null) this._stack = stack; // Stack may be updated on reject.\n                return stack;\n            } finally {\n                stack_being_generated = false;\n            }\n        }\n    },\n\n    timeout: function (ms, msg) {\n        return ms < Infinity ?\n            new DexiePromise((resolve, reject) => {\n                var handle = setTimeout(() => reject(new exceptions.Timeout(msg)), ms);\n                this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n            }) : this;\n    }\n});\n\nif (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n    setProp(DexiePromise.prototype, Symbol.toStringTag, 'Dexie.Promise');\n\n// Now that Promise.prototype is defined, we have all it takes to set globalPSD.env.\n// Environment globals snapshotted on leaving global zone\nglobalPSD.env = snapShot();\n\nfunction Listener(onFulfilled, onRejected, resolve, reject, zone) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.resolve = resolve;\n    this.reject = reject;\n    this.psd = zone;\n}\n\n// Promise Static Properties\nprops (DexiePromise, {\n    all: function () {\n        var values = getArrayOf.apply(null, arguments) // Supports iterables, implicit arguments and array-like.\n            .map(onPossibleParallellAsync); // Handle parallell async/awaits \n        return new DexiePromise(function (resolve, reject) {\n            if (values.length === 0) resolve([]);\n            var remaining = values.length;\n            values.forEach((a,i) => DexiePromise.resolve(a).then(x => {\n                values[i] = x;\n                if (!--remaining) resolve(values);\n            }, reject));\n        });\n    },\n    \n    resolve: value => {\n        if (value instanceof DexiePromise) return value;\n        if (value && typeof value.then === 'function') return new DexiePromise((resolve, reject)=>{\n            value.then(resolve, reject);\n        });\n        var rv = new DexiePromise(INTERNAL, true, value);\n        linkToPreviousPromise(rv, currentFulfiller);\n        return rv;\n    },\n    \n    reject: PromiseReject,\n    \n    race: function () {\n        var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n        return new DexiePromise((resolve, reject) => {\n            values.map(value => DexiePromise.resolve(value).then(resolve, reject));\n        });\n    },\n\n    PSD: {\n        get: ()=>PSD,\n        set: value => PSD = value\n    },\n\n    //totalEchoes: {get: ()=>totalEchoes},\n\n    //task: {get: ()=>task},\n    \n    newPSD: newScope,\n    \n    usePSD: usePSD,\n    \n    scheduler: {\n        get: () => asap,\n        set: value => {asap = value}\n    },\n    \n    rejectionMapper: {\n        get: () => rejectionMapper,\n        set: value => {rejectionMapper = value;} // Map reject failures\n    },\n            \n    follow: (fn, zoneProps) => {\n        return new DexiePromise((resolve, reject) => {\n            return newScope((resolve, reject) => {\n                var psd = PSD;\n                psd.unhandleds = []; // For unhandled standard- or 3rd party Promises. Checked at psd.finalize()\n                psd.onunhandled = reject; // Triggered directly on unhandled promises of this library.\n                psd.finalize = callBoth(function () {\n                    // Unhandled standard or 3rd part promises are put in PSD.unhandleds and\n                    // examined upon scope completion while unhandled rejections in this Promise\n                    // will trigger directly through psd.onunhandled\n                    run_at_end_of_this_or_next_physical_tick(()=>{\n                        this.unhandleds.length === 0 ? resolve() : reject(this.unhandleds[0]);\n                    });\n                }, psd.finalize);\n                fn();\n            }, zoneProps, resolve, reject);\n        });\n    }\n});\n\n/**\n* Take a potentially misbehaving resolver function and make sure\n* onFulfilled and onRejected are only called once.\n*\n* Makes no guarantees about asynchrony.\n*/\nfunction executePromiseTask (promise, fn) {\n    // Promise Resolution Procedure:\n    // https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    try {\n        fn(value => {\n            if (promise._state !== null) return; // Already settled\n            if (value === promise) throw new TypeError('A promise cannot be resolved with itself.');\n            var shouldExecuteTick = promise._lib && beginMicroTickScope();\n            if (value && typeof value.then === 'function') {\n                executePromiseTask(promise, (resolve, reject) => {\n                    value instanceof DexiePromise ?\n                        value._then(resolve, reject) :\n                        value.then(resolve, reject);\n                });\n            } else {\n                promise._state = true;\n                promise._value = value;\n                propagateAllListeners(promise);\n            }\n            if (shouldExecuteTick) endMicroTickScope();\n        }, handleRejection.bind(null, promise)); // If Function.bind is not supported. Exception is handled in catch below\n    } catch (ex) {\n        handleRejection(promise, ex);\n    }\n}\n\nfunction handleRejection (promise, reason) {\n    rejectingErrors.push(reason);\n    if (promise._state !== null) return;\n    var shouldExecuteTick = promise._lib && beginMicroTickScope();\n    reason = rejectionMapper(reason);\n    promise._state = false;\n    promise._value = reason;\n    debug && reason !== null && typeof reason === 'object' && !reason._promise && tryCatch(()=>{\n        var origProp = getPropertyDescriptor(reason, \"stack\");        \n        reason._promise = promise;    \n        setProp(reason, \"stack\", {\n            get: () =>\n                stack_being_generated ?\n                    origProp && (origProp.get ?\n                                origProp.get.apply(reason) :\n                                origProp.value) :\n                    promise.stack\n        });\n    });\n    // Add the failure to a list of possibly uncaught errors\n    addPossiblyUnhandledError(promise);\n    propagateAllListeners(promise);\n    if (shouldExecuteTick) endMicroTickScope();\n}\n\nfunction propagateAllListeners (promise) {\n    //debug && linkToPreviousPromise(promise);\n    var listeners = promise._listeners;\n    promise._listeners = [];\n    for (var i = 0, len = listeners.length; i < len; ++i) {\n        propagateToListener(promise, listeners[i]);\n    }\n    var psd = promise._PSD;\n    --psd.ref || psd.finalize(); // if psd.ref reaches zero, call psd.finalize();\n    if (numScheduledCalls === 0) {\n        // If numScheduledCalls is 0, it means that our stack is not in a callback of a scheduled call,\n        // and that no deferreds where listening to this rejection or success.\n        // Since there is a risk that our stack can contain application code that may\n        // do stuff after this code is finished that may generate new calls, we cannot\n        // call finalizers here.\n        ++numScheduledCalls;\n        asap(()=>{\n            if (--numScheduledCalls === 0) finalizePhysicalTick(); // Will detect unhandled errors\n        }, []);\n    }\n}\n\nfunction propagateToListener(promise, listener) {\n    if (promise._state === null) {\n        promise._listeners.push(listener);\n        return;\n    }\n\n    var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n    if (cb === null) {\n        // This Listener doesnt have a listener for the event being triggered (onFulfilled or onReject) so lets forward the event to any eventual listeners on the Promise instance returned by then() or catch()\n        return (promise._state ? listener.resolve : listener.reject) (promise._value);\n    }\n    ++listener.psd.ref;\n    ++numScheduledCalls;\n    asap (callListener, [cb, promise, listener]);\n}\n\nfunction callListener (cb, promise, listener) {\n    try {\n        // Set static variable currentFulfiller to the promise that is being fullfilled,\n        // so that we connect the chain of promises (for long stacks support)\n        currentFulfiller = promise;\n        \n        // Call callback and resolve our listener with it's return value.\n        var ret, value = promise._value;\n            \n        if (promise._state) {\n            // cb is onResolved\n            ret = cb (value);\n        } else {\n            // cb is onRejected\n            if (rejectingErrors.length) rejectingErrors = [];\n            ret = cb(value);\n            if (rejectingErrors.indexOf(value) === -1)\n                markErrorAsHandled(promise); // Callback didnt do Promise.reject(err) nor reject(err) onto another promise.\n        }\n        listener.resolve(ret);\n    } catch (e) {\n        // Exception thrown in callback. Reject our listener.\n        listener.reject(e);\n    } finally {\n        // Restore env and currentFulfiller.\n        currentFulfiller = null;\n        if (--numScheduledCalls === 0) finalizePhysicalTick();\n        --listener.psd.ref || listener.psd.finalize();\n    }\n}\n\nfunction getStack (promise, stacks, limit) {\n    if (stacks.length === limit) return stacks;\n    var stack = \"\";\n    if (promise._state === false) {\n        var failure = promise._value,\n            errorName,\n            message;\n        \n        if (failure != null) {\n            errorName = failure.name || \"Error\";\n            message = failure.message || failure;\n            stack = prettyStack(failure, 0);\n        } else {\n            errorName = failure; // If error is undefined or null, show that.\n            message = \"\";\n        }\n        stacks.push(errorName + (message ? \": \" + message : \"\") + stack);\n    }\n    if (debug) {\n        stack = prettyStack(promise._stackHolder, 2);\n        if (stack && stacks.indexOf(stack) === -1) stacks.push(stack);\n        if (promise._prev) getStack(promise._prev, stacks, limit);\n    }\n    return stacks;\n}\n\nfunction linkToPreviousPromise(promise, prev) {\n    // Support long stacks by linking to previous completed promise.\n    var numPrev = prev ? prev._numPrev + 1 : 0;\n    if (numPrev < LONG_STACKS_CLIP_LIMIT) { // Prohibit infinite Promise loops to get an infinite long memory consuming \"tail\".\n        promise._prev = prev;\n        promise._numPrev = numPrev;\n    }\n}\n\n/* The callback to schedule with setImmediate() or setTimeout().\n   It runs a virtual microtick and executes any callback registered in microtickQueue.\n */\nfunction physicalTick() {\n    beginMicroTickScope() && endMicroTickScope();\n}\n\nexport function beginMicroTickScope() {\n    var wasRootExec = isOutsideMicroTick;\n    isOutsideMicroTick = false;\n    needsNewPhysicalTick = false;\n    return wasRootExec;\n}\n\n/* Executes micro-ticks without doing try..catch.\n   This can be possible because we only use this internally and\n   the registered functions are exception-safe (they do try..catch\n   internally before calling any external method). If registering\n   functions in the microtickQueue that are not exception-safe, this\n   would destroy the framework and make it instable. So we don't export\n   our asap method.\n*/\nexport function endMicroTickScope() {\n    var callbacks, i, l;\n    do {\n        while (microtickQueue.length > 0) {\n            callbacks = microtickQueue;\n            microtickQueue = [];\n            l = callbacks.length;\n            for (i = 0; i < l; ++i) {\n                var item = callbacks[i];\n                item[0].apply(null, item[1]);\n            }\n        }\n    } while (microtickQueue.length > 0);\n    isOutsideMicroTick = true;\n    needsNewPhysicalTick = true;\n}\n\nfunction finalizePhysicalTick() {\n    var unhandledErrs = unhandledErrors;\n    unhandledErrors = [];\n    unhandledErrs.forEach(p => {\n        p._PSD.onunhandled.call(null, p._value, p);\n    });\n    var finalizers = tickFinalizers.slice(0); // Clone first because finalizer may remove itself from list.\n    var i = finalizers.length;\n    while (i) finalizers[--i]();    \n}\n\nfunction run_at_end_of_this_or_next_physical_tick (fn) {\n    function finalizer() {\n        fn();\n        tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n    }\n    tickFinalizers.push(finalizer);\n    ++numScheduledCalls;\n    asap(()=>{\n        if (--numScheduledCalls === 0) finalizePhysicalTick();\n    }, []);\n}\n\nfunction addPossiblyUnhandledError(promise) {\n    // Only add to unhandledErrors if not already there. The first one to add to this list\n    // will be upon the first rejection so that the root cause (first promise in the\n    // rejection chain) is the one listed.\n    if (!unhandledErrors.some(p => p._value === promise._value))\n        unhandledErrors.push(promise);\n}\n\nfunction markErrorAsHandled(promise) {\n    // Called when a reject handled is actually being called.\n    // Search in unhandledErrors for any promise whos _value is this promise_value (list\n    // contains only rejected promises, and only one item per error)\n    var i = unhandledErrors.length;\n    while (i) if (unhandledErrors[--i]._value === promise._value) {\n        // Found a promise that failed with this same error object pointer,\n        // Remove that since there is a listener that actually takes care of it.\n        unhandledErrors.splice(i, 1);\n        return;\n    }\n}\n\nfunction PromiseReject (reason) {\n    return new DexiePromise(INTERNAL, false, reason);\n}\n\nexport function wrap (fn, errorCatcher) {\n    var psd = PSD;\n    return function() {\n        var wasRootExec = beginMicroTickScope(),\n            outerScope = PSD;\n\n        try {\n            switchToZone(psd, true);\n            return fn.apply(this, arguments);\n        } catch (e) {\n            errorCatcher && errorCatcher(e);\n        } finally {\n            switchToZone(outerScope, false);\n            if (wasRootExec) endMicroTickScope();\n        }\n    };\n}\n\n\n//\n// variables used for native await support\n//\nconst task = { awaits: 0, echoes: 0, id: 0}; // The ongoing macro-task when using zone-echoing.\nvar taskCounter = 0; // ID counter for macro tasks.\nvar zoneStack = []; // Stack of left zones to restore asynchronically.\nvar zoneEchoes = 0; // zoneEchoes is a must in order to persist zones between native await expressions.\nvar totalEchoes = 0; // ID counter for micro-tasks. Used to detect possible native await in our Promise.prototype.then.\n\n\nvar zone_id_counter = 0;\nexport function newScope (fn, props, a1, a2) {\n    var parent = PSD,\n        psd = Object.create(parent);\n    psd.parent = parent;\n    psd.ref = 0;\n    psd.global = false;\n    psd.id = ++zone_id_counter;\n    // Prepare for promise patching (done in usePSD):\n    var globalEnv = globalPSD.env;\n    psd.env = patchGlobalPromise ? {\n        Promise: DexiePromise, // Changing window.Promise could be omitted for Chrome and Edge, where IDB+Promise plays well!\n        PromiseProp: {value: DexiePromise, configurable: true, writable: true},\n        all: DexiePromise.all,\n        race: DexiePromise.race,\n        resolve: DexiePromise.resolve,\n        reject: DexiePromise.reject,\n        nthen: getPatchedPromiseThen (globalEnv.nthen, psd), // native then\n        gthen: getPatchedPromiseThen (globalEnv.gthen, psd) // global then\n    } : {};\n    if (props) extend(psd, props);\n    \n    // unhandleds and onunhandled should not be specifically set here.\n    // Leave them on parent prototype.\n    // unhandleds.push(err) will push to parent's prototype\n    // onunhandled() will call parents onunhandled (with this scope's this-pointer though!)\n    ++parent.ref;\n    psd.finalize = function () {\n        --this.parent.ref || this.parent.finalize();\n    }\n    var rv = usePSD (psd, fn, a1, a2);\n    if (psd.ref === 0) psd.finalize();\n    return rv;\n}\n\n// Function to call if scopeFunc returns NativePromise\n// Also for each NativePromise in the arguments to Promise.all()\nexport function incrementExpectedAwaits() {\n    if (!task.id) task.id = ++taskCounter;\n    ++task.awaits;\n    task.echoes += ZONE_ECHO_LIMIT;\n    return task.id;\n}\n\n// Function to call when 'then' calls back on a native promise where onAwaitExpected() had been called.\n// Also call this when a native await calls then method on a promise. In that case, don't supply\n// sourceTaskId because we already know it refers to current task.\nexport function decrementExpectedAwaits(sourceTaskId) {\n    if (!task.awaits || (sourceTaskId && sourceTaskId !== task.id)) return;\n    if (--task.awaits === 0) task.id = 0;\n    task.echoes = task.awaits * ZONE_ECHO_LIMIT; // Will reset echoes to 0 if awaits is 0.\n}\n\nif ((''+nativePromiseThen).indexOf('[native code]') === -1) {\n    // If the native promise' prototype is patched, we cannot rely on zone echoing.\n    // Disable that here:\n    incrementExpectedAwaits = decrementExpectedAwaits = nop;\n}\n\n// Call from Promise.all() and Promise.race()\nexport function onPossibleParallellAsync (possiblePromise) {\n    if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n        incrementExpectedAwaits(); \n        return possiblePromise.then(x => {\n            decrementExpectedAwaits();\n            return x;\n        }, e => {\n            decrementExpectedAwaits();\n            return rejection(e);\n        });\n    }\n    return possiblePromise;\n}\n\nfunction zoneEnterEcho(targetZone) {\n    ++totalEchoes;\n    //console.log(\"Total echoes \", totalEchoes);\n    if (!task.echoes || --task.echoes === 0) {\n        task.echoes = task.id = 0; // Cancel zone echoing.\n    }\n\n    zoneStack.push(PSD);\n    switchToZone(targetZone, true);\n}\n\nfunction zoneLeaveEcho() {\n    var zone = zoneStack[zoneStack.length-1];\n    zoneStack.pop();\n    switchToZone(zone, false);\n}\n\nfunction switchToZone (targetZone, bEnteringZone) {\n    var currentZone = PSD;\n    if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (!--zoneEchoes || targetZone !== PSD)) {\n        // Enter or leave zone asynchronically as well, so that tasks initiated during current tick\n        // will be surrounded by the zone when they are invoked.\n        enqueueNativeMicroTask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n    }\n    if (targetZone === PSD) return;\n\n    PSD = targetZone; // The actual zone switch occurs at this line.\n\n    // Snapshot on every leave from global zone.\n    if (currentZone === globalPSD) globalPSD.env = snapShot();\n\n    if (patchGlobalPromise) {\n        // Let's patch the global and native Promises (may be same or may be different)\n        var GlobalPromise = globalPSD.env.Promise;\n        // Swich environments (may be PSD-zone or the global zone. Both apply.)\n        var targetEnv = targetZone.env;\n\n        // Change Promise.prototype.then for native and global Promise (they MAY differ on polyfilled environments, but both can be accessed)\n        // Must be done on each zone change because the patched method contains targetZone in its closure.\n        nativePromiseProto.then = targetEnv.nthen;\n        GlobalPromise.prototype.then = targetEnv.gthen;\n\n        if (currentZone.global || targetZone.global) {\n            // Leaving or entering global zone. It's time to patch / restore global Promise.\n\n            // Set this Promise to window.Promise so that transiled async functions will work on Firefox, Safari and IE, as well as with Zonejs and angular.\n            Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n\n            // Support Promise.all() etc to work indexedDB-safe also when people are including es6-promise as a module (they might\n            // not be accessing global.Promise but a local reference to it)\n            GlobalPromise.all = targetEnv.all;\n            GlobalPromise.race = targetEnv.race;\n            GlobalPromise.resolve = targetEnv.resolve;\n            GlobalPromise.reject = targetEnv.reject;\n        }\n    }\n}\n\nfunction snapShot () {\n    var GlobalPromise = _global.Promise;\n    return patchGlobalPromise ? {\n        Promise: GlobalPromise,\n        PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n        all: GlobalPromise.all,\n        race: GlobalPromise.race,\n        resolve: GlobalPromise.resolve,\n        reject: GlobalPromise.reject,\n        nthen: nativePromiseProto.then,\n        gthen: GlobalPromise.prototype.then\n    } : {};\n}\n\nexport function usePSD (psd, fn, a1, a2, a3) {\n    var outerScope = PSD;\n    try {\n        switchToZone(psd, true);\n        return fn(a1, a2, a3);\n    } finally {\n        switchToZone(outerScope, false);\n    }\n}\n\nfunction enqueueNativeMicroTask (job) {\n    //\n    // Precondition: nativePromiseThen !== undefined\n    //\n    nativePromiseThen.call(resolvedNativePromise, job);\n}\n\nfunction nativeAwaitCompatibleWrap(fn, zone, possibleAwait) {\n    return typeof fn !== 'function' ? fn : function () {\n        var outerZone = PSD;\n        if (possibleAwait) incrementExpectedAwaits();\n        switchToZone(zone, true);\n        try {\n            return fn.apply(this, arguments);\n        } finally {\n            switchToZone(outerZone, false);\n        }\n    };\n}\n\nfunction getPatchedPromiseThen (origThen, zone) {\n    return function (onResolved, onRejected) {\n        return origThen.call(this,\n            nativeAwaitCompatibleWrap(onResolved, zone, false),\n            nativeAwaitCompatibleWrap(onRejected, zone, false));\n    };\n}\n\nconst UNHANDLEDREJECTION = \"unhandledrejection\";\n\nfunction globalError(err, promise) {\n    var rv;\n    try {\n        rv = promise.onuncatched(err);\n    } catch (e) {}\n    if (rv !== false) try {\n        var event, eventData = {promise: promise, reason: err};\n        if (_global.document && document.createEvent) {\n            event = document.createEvent('Event');\n            event.initEvent(UNHANDLEDREJECTION, true, true);\n            extend(event, eventData);\n        } else if (_global.CustomEvent) {\n            event = new CustomEvent(UNHANDLEDREJECTION, {detail: eventData});\n            extend(event, eventData);\n        }\n        if (event && _global.dispatchEvent) {\n            dispatchEvent(event);\n            if (!_global.PromiseRejectionEvent && _global.onunhandledrejection)\n                // No native support for PromiseRejectionEvent but user has set window.onunhandledrejection. Manually call it.\n                try {_global.onunhandledrejection(event);} catch (_) {}\n        }\n        if (debug && event && !event.defaultPrevented) {\n            console.warn(`Unhandled rejection: ${err.stack || err}`);\n        }\n    } catch (e) {}\n}\n\nexport var rejection = DexiePromise.reject;\n\nexport {DexiePromise};\n","import { PSD, rejection, newScope } from \"../helpers/promise\";\nimport { DexieOptions } from \"../public/types/dexie-constructor\";\nimport { exceptions } from \"../errors\";\nimport { nop } from \"./chaining-functions\";\nimport { Transaction } from \"../classes/transaction\";\nimport { Dexie } from '../classes/dexie';\n\n/* Generate a temporary transaction when db operations are done outside a transaction scope.\n*/\nexport function tempTransaction (\n  db: Dexie,\n  mode: IDBTransactionMode,\n  storeNames: string[],\n  fn: (resolve, reject, trans: Transaction) => any)\n  // Last argument is \"writeLocked\". But this doesnt apply to oneshot direct db operations, so we ignore it.\n{\n  if (!db._state.openComplete && (!PSD.letThrough)) {\n    if (!db._state.isBeingOpened) {\n      if (!db._options.autoOpen)\n        return rejection(new exceptions.DatabaseClosed());\n      db.open().catch(nop); // Open in background. If if fails, it will be catched by the final promise anyway.\n    }\n    return db._state.dbReadyPromise.then(() => tempTransaction(db, mode, storeNames, fn));\n  } else {\n    var trans = db._createTransaction(mode, storeNames, db._dbSchema);\n    try { trans.create(); } catch (ex) { return rejection(ex); }\n    return trans._promise(mode, (resolve, reject) => {\n      return newScope(() => { // OPTIMIZATION POSSIBLE? newScope() not needed because it's already done in _promise.\n        PSD.trans = trans;\n        return fn(resolve, reject, trans);\n      });\n    }).then(result => {\n      // Instead of resolving value directly, wait with resolving it until transaction has completed.\n      // Otherwise the data would not be in the DB if requesting it in the then() operation.\n      // Specifically, to ensure that the following expression will work:\n      //\n      //   db.friends.put({name: \"Arne\"}).then(function () {\n      //       db.friends.where(\"name\").equals(\"Arne\").count(function(count) {\n      //           assert (count === 1);\n      //       });\n      //   });\n      //\n      return trans._completion.then(() => result);\n    });/*.catch(err => { // Don't do this as of now. If would affect bulk- and modify methods in a way that could be more intuitive. But wait! Maybe change in next major.\n          trans._reject(err);\n          return rejection(err);\n      });*/\n  }\n}\n","import { Dexie } from \"../classes/dexie\";\n\nexport const DEXIE_VERSION = '{version}'; // Replaced by build-script.\nexport const maxString = String.fromCharCode(65535);\nexport const minKey = -Infinity; // minKey can be constant. maxKey must be a prop of Dexie (_maxKey)\nexport const INVALID_KEY_ARGUMENT =\n  \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\nexport const STRING_EXPECTED = \"String expected.\";\nexport const connections: Dexie[] = [];\nexport const isIEOrEdge =\n  typeof navigator !== 'undefined' && /(MSIE|Trident|Edge)/.test(navigator.userAgent);\nexport const hasIEDeleteObjectStoreBug = isIEOrEdge;\nexport const hangsOnDeleteLargeKeyRange = isIEOrEdge;\nexport const dexieStackFrameFilter = frame => !/(dexie\\.js|dexie\\.min\\.js)/.test(frame);\nexport const DBNAMES_DB = '__dbnames';\nexport const READONLY = 'readonly';\nexport const READWRITE = 'readwrite';\n","export function combine(filter1, filter2) {\n  return filter1 ?\n      filter2 ?\n          function () { return filter1.apply(this, arguments) && filter2.apply(this, arguments); } :\n          filter1 :\n      filter2;\n}\n","import { KeyRange, RangeType } from '../public/types/dbcore';\n\nvar x: KeyRange;\n\nexport const AnyRange: KeyRange = {\n  type: RangeType.Any,\n  lower: -Infinity,\n  lowerOpen: false,\n  upper: [[]], // BUGBUG: depends on indexeddb impl.\n  upperOpen: false\n}\n\nexport const NeverRange: KeyRange = {\n  type: RangeType.Never,\n  lower: -Infinity,\n  lowerOpen: true,\n  upper: -Infinity,\n  upperOpen: true\n}\n","import { ModifyError, BulkError, errnames, exceptions, fullNameExceptions, mapError } from '../../errors';\nimport { Table as ITable } from '../../public/types/table';\nimport { TableSchema } from '../../public/types/table-schema';\nimport { TableHooks } from '../../public/types/table-hooks';\nimport { DexiePromise as Promise, PSD, newScope, wrap, rejection, beginMicroTickScope, endMicroTickScope } from '../../helpers/promise';\nimport Events from '../../helpers/Events';\nimport { hookCreatingChain, nop, pureFunctionChain, mirror, hookUpdatingChain, hookDeletingChain } from '../../functions/chaining-functions';\nimport { Transaction } from '../transaction';\nimport { Dexie } from '../dexie';\nimport { tempTransaction } from '../../functions/temp-transaction';\nimport { eventRejectHandler, hookedEventRejectHandler, hookedEventSuccessHandler, BulkErrorHandlerCatchAll, eventSuccessHandler } from '../../functions/event-wrappers';\nimport { WhereClause } from '../where-clause/where-clause';\nimport { Collection } from '../collection';\nimport { isArray, keys, getByKeyPath, hasOwn, setByKeyPath, deepClone, tryCatch, arrayToObject, extend } from '../../functions/utils';\nimport { maxString } from '../../globals/constants';\nimport { combine } from '../../functions/combine';\nimport { PromiseExtended } from \"../../public/types/promise-extended\";\nimport { IndexableType } from '../../public/types/indexable-type';\nimport { debug } from '../../helpers/debug';\nimport { DBCoreTransactionMode, DBCore, DBCoreTransaction, DBCoreTable, RangeType } from '../../public/types/dbcore';\nimport { AnyRange } from '../../dbcore/keyrange';\n\n/** class Table\n * \n * http://dexie.org/docs/Table/Table\n */\nexport class Table implements ITable<any, IndexableType> {\n  db: Dexie;\n  _tx?: Transaction;\n  name: string;\n  schema: TableSchema;\n  hook: TableHooks;\n  core: DBCoreTable;\n\n  _trans(\n    mode: IDBTransactionMode,\n    fn: (idbtrans: IDBTransaction, dxTrans: Transaction) => PromiseLike<any> | void,\n    writeLocked?: boolean | string) : PromiseExtended<any>\n  {\n    const trans: Transaction = this._tx || PSD.trans;\n    const tableName = this.name;\n    \n    function checkTableInTransaction(resolve, reject, trans: Transaction) {\n      if (!trans.schema[tableName])\n        throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n      return fn(trans.idbtrans, trans);\n    }\n    // Surround all in a microtick scope.\n    // Reason: Browsers (modern Safari + older others)\n    // still as of 2018-10-10 has problems keeping a transaction\n    // alive between micro ticks. Safari because if transaction\n    // is created but not used in same microtick, it will go\n    // away. That specific issue could be solved in DBCore\n    // by opening the transaction just before using it instead.\n    // But older Firefoxes and IE11 (with Promise polyfills)\n    // will still have probs.\n    // The beginMicrotickScope()/endMicrotickScope() works\n    // in cooperation with Dexie.Promise to orchestrate\n    // the micro-ticks in endMicrotickScope() rather than\n    // in native engine.\n    const wasRootExec = beginMicroTickScope();\n    try {\n      return trans && trans.db === this.db ?\n        trans === PSD.trans ?\n          trans._promise(mode, checkTableInTransaction, writeLocked) :\n          newScope(() => trans._promise(mode, checkTableInTransaction, writeLocked), { trans: trans, transless: PSD.transless || PSD }) :\n        tempTransaction(this.db, mode, [this.name], checkTableInTransaction);\n    } finally {\n      if (wasRootExec) endMicroTickScope();\n    }\n  }\n\n  /** Table.get()\n   * \n   * http://dexie.org/docs/Table/Table.get()\n   * \n   **/\n  get(keyOrCrit, cb?) {\n    if (keyOrCrit && keyOrCrit.constructor === Object)\n      return this.where(keyOrCrit as { [key: string]: IndexableType }).first(cb);\n\n    return this._trans('readonly', (trans) => {\n      return this.core.get({trans, key: keyOrCrit})\n        .then(res => this.hook.reading.fire(res));\n    }).then(cb);\n  }\n\n  /** Table.where()\n   * \n   * http://dexie.org/docs/Table/Table.where()\n   * \n   **/\n  where(indexOrCrit: string | string[] | { [key: string]: IndexableType }) {\n    if (typeof indexOrCrit === 'string')\n      return new this.db.WhereClause(this, indexOrCrit);\n    if (isArray(indexOrCrit))\n      return new this.db.WhereClause(this, `[${indexOrCrit.join('+')}]`);\n    // indexOrCrit is an object map of {[keyPath]:value} \n    const keyPaths = keys(indexOrCrit);\n    if (keyPaths.length === 1)\n      // Only one critera. This was the easy case:\n      return this\n        .where(keyPaths[0])\n        .equals(indexOrCrit[keyPaths[0]]);\n\n    // Multiple criterias.\n    // Let's try finding a compound index that matches all keyPaths in\n    // arbritary order:\n    const compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(ix =>\n      ix.compound &&\n      keyPaths.every(keyPath => ix.keyPath.indexOf(keyPath) >= 0) &&\n      (ix.keyPath as string[]).every(keyPath => keyPaths.indexOf(keyPath) >= 0))[0];\n\n    if (compoundIndex && this.db._maxKey !== maxString)\n      // Cool! We found such compound index\n      // and this browser supports compound indexes (maxKey !== maxString)!\n      return this\n        .where(compoundIndex.name)\n        .equals((compoundIndex.keyPath as string[]).map(kp => indexOrCrit[kp]));\n\n    if (!compoundIndex && debug) console.warn(\n      `The query ${JSON.stringify(indexOrCrit)} on ${this.name} would benefit of a ` +\n      `compound index [${keyPaths.join('+')}]`);\n\n    // Ok, now let's fallback to finding at least one matching index\n    // and filter the rest.\n    const { idxByName } = this.schema;\n    const idb = this.db._deps.indexedDB;\n\n    function equals (a, b) {\n      try {\n        return idb.cmp(a,b) === 0; // Works with all indexable types including binary keys.\n      } catch (e) {\n        return false;\n      }\n    }\n\n    const [idx, filterFunction] = keyPaths.reduce(([prevIndex, prevFilterFn], keyPath) => {\n      const index = idxByName[keyPath];\n      const value = indexOrCrit[keyPath];\n      return [\n        prevIndex || index, // idx::=Pick index of first matching keypath\n        prevIndex || !index ? // filter::=null if not needed, otherwise combine function filter\n          combine(\n            prevFilterFn,\n            index && index.multi ?\n              x => {\n                const prop = getByKeyPath(x, keyPath);\n                return isArray(prop) && prop.some(item => equals(value, item));\n              } : x => equals(value, getByKeyPath(x, keyPath)))\n          : prevFilterFn\n      ];\n    }, [null, null]);\n\n    return idx ?\n      this.where(idx.name).equals(indexOrCrit[idx.keyPath])\n        .filter(filterFunction) :\n      compoundIndex ?\n        this.filter(filterFunction) : // Has compound but browser bad. Allow filter.\n        this.where(keyPaths).equals(''); // No index at all. Fail lazily with \"[a+b+c] is not indexed\"\n  }\n\n  /** Table.filter()\n   * \n   * http://dexie.org/docs/Table/Table.filter()\n   * \n   **/\n  filter(filterFunction: (obj: any) => boolean) {\n    return this.toCollection().and(filterFunction);\n  }\n\n  /** Table.count()\n   * \n   * http://dexie.org/docs/Table/Table.count()\n   * \n   **/\n  count(thenShortcut?: any) {\n    return this.toCollection().count(thenShortcut);\n  }\n\n  /** Table.offset()\n   * \n   * http://dexie.org/docs/Table/Table.offset()\n   * \n   **/\n  offset(offset: number) {\n    return this.toCollection().offset(offset);\n  }\n\n  /** Table.limit()\n   * \n   * http://dexie.org/docs/Table/Table.limit()\n   * \n   **/\n  limit(numRows: number) {\n    return this.toCollection().limit(numRows);\n  }\n\n  /** Table.each()\n   * \n   * http://dexie.org/docs/Table/Table.each()\n   * \n   **/\n  each(callback: (obj: any, cursor: { key: IndexableType, primaryKey: IndexableType }) => any) {\n    return this.toCollection().each(callback);\n  }\n\n  /** Table.toArray()\n   * \n   * http://dexie.org/docs/Table/Table.toArray()\n   * \n   **/\n  toArray(thenShortcut?: any) {\n    return this.toCollection().toArray(thenShortcut);\n  }\n\n  /** Table.toCollection()\n   * \n   * http://dexie.org/docs/Table/Table.toCollection()\n   * \n   **/\n  toCollection() {\n    return new this.db.Collection(new this.db.WhereClause(this));\n  }\n\n  /** Table.orderBy()\n   * \n   * http://dexie.org/docs/Table/Table.orderBy()\n   * \n   **/\n  orderBy(index: string | string[]) {\n    return new this.db.Collection(\n      new this.db.WhereClause(this, isArray(index) ?\n        `[${index.join('+')}]` :\n        index));\n  }\n\n  /** Table.reverse()\n   * \n   * http://dexie.org/docs/Table/Table.reverse()\n   * \n   **/\n  reverse(): Collection {\n    return this.toCollection().reverse();\n  }\n\n  /** Table.mapToClass()\n   * \n   * http://dexie.org/docs/Table/Table.mapToClass()\n   * \n   **/\n  mapToClass(constructor: Function) {\n    this.schema.mappedClass = constructor;\n    // Now, subscribe to the when(\"reading\") event to make all objects that come out from this table inherit from given class\n    // no matter which method to use for reading (Table.get() or Table.where(...)... )\n    const readHook = obj => {\n      if (!obj) return obj; // No valid object. (Value is null). Return as is.\n      // Create a new object that derives from constructor:\n      const res = Object.create(constructor.prototype);\n      // Clone members:\n      for (var m in obj) if (hasOwn(obj, m)) try { res[m] = obj[m]; } catch (_) { }\n      return res;\n    };\n\n    if (this.schema.readHook) {\n      this.hook.reading.unsubscribe(this.schema.readHook);\n    }\n    this.schema.readHook = readHook;\n    this.hook(\"reading\", readHook);\n    return constructor;\n  }\n\n  /** @deprecated */\n  defineClass() {\n    function Class (content){\n      extend(this, content);\n    };\n    return this.mapToClass(Class);\n  }\n\n  /** Table.add()\n   * \n   * http://dexie.org/docs/Table/Table.add()\n   * \n   **/\n  add(obj, key?: IndexableType): PromiseExtended<IndexableType> {\n    return this._trans('readwrite', trans => {\n      return this.core.mutate({trans, type: 'add', keys: key != null ? [key] : null, values: [obj]});\n    }).then(res => res.numFailures ? Promise.reject(res.failures[0]) : res.lastResult)\n    .then(lastResult => {\n      if (!this.core.schema.primaryKey.outbound) {\n        try{setByKeyPath(obj, this.core.schema.primaryKey.keyPath, lastResult);}catch(_){};\n      }\n      return lastResult;\n    });\n  }\n\n  /** Table.update()\n   * \n   * http://dexie.org/docs/Table/Table.update()\n   * \n   **/\n  update(keyOrObject, modifications: { [keyPath: string]: any; }): PromiseExtended<number> {\n    if (typeof modifications !== 'object' || isArray(modifications))\n      throw new exceptions.InvalidArgument(\"Modifications must be an object.\");\n    if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n      // object to modify. Also modify given object with the modifications:\n      keys(modifications).forEach(keyPath => {\n        setByKeyPath(keyOrObject, keyPath, modifications[keyPath]);\n      });\n      const key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n      if (key === undefined) return rejection(new exceptions.InvalidArgument(\n        \"Given object does not contain its primary key\"));\n      return this.where(\":id\").equals(key).modify(modifications);\n    } else {\n      // key to modify\n      return this.where(\":id\").equals(keyOrObject).modify(modifications);\n    }\n  }\n\n  /** Table.put()\n   * \n   * http://dexie.org/docs/Table/Table.put()\n   * \n   **/\n  put(obj, key?: IndexableType): PromiseExtended<IndexableType> {\n    return this._trans(\n      'readwrite',\n      trans => this.core.mutate({trans, type: 'put', values: [obj], keys: key != null ? [key] : null}))\n    .then(res => res.numFailures ? Promise.reject(res.failures[0]) : res.lastResult)\n    .then(lastResult => {\n      if (!this.core.schema.primaryKey.outbound) {\n        try{setByKeyPath(obj, this.core.schema.primaryKey.keyPath, lastResult);}catch(_){};\n      }\n      return lastResult;\n    });\n  }\n\n  /** Table.delete()\n   * \n   * http://dexie.org/docs/Table/Table.delete()\n   * \n   **/\n  delete(key: IndexableType): PromiseExtended<void> {\n    return this._trans('readwrite',\n      trans => this.core.mutate({trans, type: 'delete', keys: [key]}))\n    .then(res => res.numFailures ? Promise.reject(res.failures[0]) : undefined);\n  }\n\n  /** Table.clear()\n   * \n   * http://dexie.org/docs/Table/Table.clear()\n   * \n   **/\n  clear() {\n    return this._trans('readwrite',\n      trans => this.core.mutate({trans, type: 'deleteRange', range: AnyRange}))\n        .then(res => res.numFailures ? Promise.reject(res.failures[0]) : undefined);\n  }\n\n  /** Table.bulkGet()\n   * \n   * http://dexie.org/docs/Table/Table.bulkGet()\n   * \n   * @param keys \n   */\n  bulkGet(keys: IndexableType[]) {\n    return this._trans('readonly', trans => {\n      return this.core.getMany({\n        keys,\n        trans\n      });\n    });\n  }\n\n  /** Table.bulkAdd()\n   * \n   * http://dexie.org/docs/Table/Table.bulkAdd()\n   * \n   **/\n  bulkAdd(objects: any[], keys?: ReadonlyArray<IndexableType>) {\n    return this._trans('readwrite', trans => {\n      const {outbound} = this.core.schema.primaryKey;\n      if (!outbound && keys)\n        throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n      if (keys && keys.length !== objects.length)\n        throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n\n      const numObjects = objects.length; // Pick length here to allow garbage collection of objects later\n      return this.core.mutate({trans, type: 'add', keys: keys as IndexableType[], values: objects})\n        .then(({numFailures, lastResult, failures}) => {\n          if (numFailures === 0) return lastResult;\n          throw new BulkError(\n            `${this.name}.bulkAdd(): ${numFailures} of ${numObjects} operations failed`,\n              Object.keys(failures).map(pos => failures[pos]));\n        });\n    });\n  }\n\n\n  /** Table.bulkPut()\n   * \n   * http://dexie.org/docs/Table/Table.bulkPut()\n   * \n   **/\n  bulkPut(objects: any[], keys?: ReadonlyArray<IndexableType>) {\n    return this._trans('readwrite', trans => {\n      const {outbound} = this.core.schema.primaryKey;\n      if (!outbound && keys)\n        throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n      if (keys && keys.length !== objects.length)\n        throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n\n      const numObjects = objects.length; // Pick length here to allow garbage collection of objects later\n      return this.core.mutate({trans, type: 'put', keys: keys as IndexableType[], values: objects})\n        .then(({numFailures, lastResult, failures}) => {\n          if (numFailures === 0) return lastResult;\n          throw new BulkError(\n            `${this.name}.bulkPut(): ${numFailures} of ${numObjects} operations failed`,\n              Object.keys(failures).map(pos => failures[pos]));\n        });\n    });\n  }\n\n  /** Table.bulkDelete()\n   * \n   * http://dexie.org/docs/Table/Table.bulkDelete()\n   * \n   **/\n  bulkDelete(keys: ReadonlyArray<IndexableType>): PromiseExtended<void> {\n    const numKeys = keys.length;\n    return this._trans('readwrite', trans => {\n      return this.core.mutate({trans, type: 'delete', keys: keys as IndexableType[]});\n    }).then(({numFailures, lastResult, failures}) => {\n      if (numFailures === 0) return lastResult;\n      throw new BulkError(\n        `${this.name}.bulkDelete(): ${numFailures} of ${numKeys} operations failed`, failures);\n    });\n  }\n}\n","import {keys, isArray, asap} from '../functions/utils';\nimport {nop, mirror, reverseStoppableEventChain} from '../functions/chaining-functions';\nimport {exceptions} from '../errors';\n\nexport default function Events(ctx) {\n    var evs = {};\n    var rv = function (eventName, subscriber) {\n        if (subscriber) {\n            // Subscribe. If additional arguments than just the subscriber was provided, forward them as well.\n            var i = arguments.length, args = new Array(i - 1);\n            while (--i) args[i - 1] = arguments[i];\n            evs[eventName].subscribe.apply(null, args);\n            return ctx;\n        } else if (typeof (eventName) === 'string') {\n            // Return interface allowing to fire or unsubscribe from event\n            return evs[eventName];\n        }\n    };\n    rv.addEventType = add;\n    \n    for (var i = 1, l = arguments.length; i < l; ++i) {\n        add(arguments[i]);\n    }\n    \n    return rv;\n\n    function add(eventName, chainFunction, defaultFunction) {\n        if (typeof eventName === 'object') return addConfiguredEvents(eventName);\n        if (!chainFunction) chainFunction = reverseStoppableEventChain;\n        if (!defaultFunction) defaultFunction = nop;\n\n        var context = {\n            subscribers: [],\n            fire: defaultFunction,\n            subscribe: function (cb) {\n                if (context.subscribers.indexOf(cb) === -1) {\n                    context.subscribers.push(cb);\n                    context.fire = chainFunction(context.fire, cb);\n                }\n            },\n            unsubscribe: function (cb) {\n                context.subscribers = context.subscribers.filter(function (fn) { return fn !== cb; });\n                context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n            }\n        };\n        evs[eventName] = rv[eventName] = context;\n        return context;\n    }\n\n    function addConfiguredEvents(cfg) {\n        // events(this, {reading: [functionChain, nop]});\n        keys(cfg).forEach(function (eventName) {\n            var args = cfg[eventName];\n            if (isArray(args)) {\n                add(eventName, cfg[eventName][0], cfg[eventName][1]);\n            } else if (args === 'asap') {\n                // Rather than approaching event subscription using a functional approach, we here do it in a for-loop where subscriber is executed in its own stack\n                // enabling that any exception that occur wont disturb the initiator and also not nescessary be catched and forgotten.\n                var context = add(eventName, mirror, function fire() {\n                    // Optimazation-safe cloning of arguments into args.\n                    var i = arguments.length, args = new Array(i);\n                    while (i--) args[i] = arguments[i];\n                    // All each subscriber:\n                    context.subscribers.forEach(function (fn) {\n                        asap(function fireEvent() {\n                            fn.apply(null, args);\n                        });\n                    });\n                });\n            } else throw new exceptions.InvalidArgument(\"Invalid event config\");\n        });\n    }\n}\n","import { arrayToObject, derive } from './utils';\n\n\nexport function makeClassConstructor<TConstructor> (prototype: Object, constructor: Function) {\n  /*const propertyDescriptorMap = arrayToObject(\n    Object.getOwnPropertyNames(prototype),\n    propKey => [propKey, Object.getOwnPropertyDescriptor(prototype, propKey)]);\n\n  // Both derive and clone the prototype.\n  //   derive: So that x instanceof T returns true when T is the class template.\n  //   clone: Optimizes method access a bit (but actually not nescessary)\n  const derivedPrototypeClone = Object.create(prototype, propertyDescriptorMap);\n  derivedPrototypeClone.constructor = constructor;\n  constructor.prototype = derivedPrototypeClone;\n  return constructor as any as TConstructor;*/\n\n  // Keep the above code in case we want to clone AND derive the parent prototype.\n  // Reason would be optimization of property access.\n  // The code below will only create a prototypal inheritance from given constructor function\n  // to given prototype.\n  derive(constructor).from({prototype});\n  return constructor as any as TConstructor;  \n}\n","import { Dexie } from '../dexie';\nimport { TableSchema } from '../../public/types/table-schema';\nimport { Transaction } from '../transaction/transaction';\nimport { hookCreatingChain, pureFunctionChain, nop, mirror, hookUpdatingChain, hookDeletingChain } from '../../functions/chaining-functions';\nimport { TableHooks } from '../../public/types/table-hooks';\nimport { Table } from './table';\nimport Events from '../../helpers/Events';\nimport { makeClassConstructor } from '../../functions/make-class-constructor';\n\nexport interface TableConstructor {\n  new (name: string, tableSchema: TableSchema, optionalTrans?: Transaction) : Table;\n  prototype: Table;\n}\n\n/** Generates a Table constructor bound to given Dexie instance.\n * \n * The purpose of having dynamically created constructors, is to allow\n * addons to extend classes for a certain Dexie instance without affecting\n * other db instances.\n */\nexport function createTableConstructor (db: Dexie) {\n  return makeClassConstructor<TableConstructor>(\n    Table.prototype,\n\n    function Table (this: Table, name: string, tableSchema: TableSchema, trans?: Transaction) {\n      this.db = db;\n      this._tx = trans;\n      this.name = name;\n      this.schema = tableSchema;\n      this.hook = db._allTables[name] ? db._allTables[name].hook : Events(null, {\n        \"creating\": [hookCreatingChain, nop],\n        \"reading\": [pureFunctionChain, mirror],\n        \"updating\": [hookUpdatingChain, nop],\n        \"deleting\": [hookDeletingChain, nop]\n      }) as TableHooks;\n    }\n\n  );\n}\n","import { combine } from \"../../functions/combine\";\nimport { exceptions } from \"../../errors\";\nimport { hasOwn, trycatcher } from \"../../functions/utils\";\nimport { wrap } from \"../../helpers/promise\";\nimport { eventRejectHandler } from \"../../functions/event-wrappers\";\nimport { Collection } from './';\nimport { DBCoreCursor, DBCoreTable, DBCoreTransaction, DBCoreTableSchema, RangeType } from '../../public/types/dbcore';\nimport { Table } from '../table';\nimport { nop } from '../../functions/chaining-functions';\n\ntype CollectionContext = Collection[\"_ctx\"];\n\nexport function isPlainKeyRange (ctx: CollectionContext, ignoreLimitFilter?: boolean) {\n  return !(ctx.filter || ctx.algorithm || ctx.or) &&\n      (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n}    \n\nexport function addFilter(ctx: CollectionContext, fn: Function) {\n  ctx.filter = combine(ctx.filter, fn);\n}\n\nexport function addReplayFilter (ctx: CollectionContext, factory, isLimitFilter?) {\n  var curr = ctx.replayFilter;\n  ctx.replayFilter = curr ? ()=>combine(curr(), factory()) : factory;\n  ctx.justLimit = isLimitFilter && !curr;\n}\n\nexport function addMatchFilter(ctx: CollectionContext, fn) {\n  ctx.isMatch = combine(ctx.isMatch, fn);\n}\n\nexport function getIndexOrStore(ctx: CollectionContext, coreSchema: DBCoreTableSchema) {\n  // TODO: Rewrite this. No need to know ctx.isPrimKey. ctx.index should hold the keypath.\n  // Still, throw if not found!\n  if (ctx.isPrimKey) return coreSchema.primaryKey;\n  const index = coreSchema.getIndexByKeyPath(ctx.index);\n  if (!index) throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + coreSchema.name + \" is not indexed\");\n  return index;\n}\n\nexport function openCursor(ctx: CollectionContext, coreTable: DBCoreTable, trans: DBCoreTransaction) {\n  const index = getIndexOrStore(ctx, coreTable.schema);\n  return coreTable.openCursor({\n    trans,\n    values: !ctx.keysOnly,\n    reverse: ctx.dir === 'prev',\n    unique: !!ctx.unique,\n    query: {\n      index, \n      range: ctx.range\n    }\n  });\n}\n\nexport function iter (\n  ctx: CollectionContext, \n  fn: (item, cursor: DBCoreCursor, advance: Function)=>void,\n  coreTrans: DBCoreTransaction,\n  coreTable: DBCoreTable): Promise<any>\n{\n  const filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n  if (!ctx.or) {\n      return iterate(\n        openCursor(ctx, coreTable, coreTrans),\n        combine(ctx.algorithm, filter), fn, !ctx.keysOnly && ctx.valueMapper);\n  } else {\n      const set = {};\n\n      const union = (item: any, cursor: DBCoreCursor, advance) => {\n          if (!filter || filter(cursor, advance, result=>cursor.stop(result), err => cursor.fail(err))) {\n              var primaryKey = cursor.primaryKey;\n              var key = '' + primaryKey;\n              if (key === '[object ArrayBuffer]') key = '' + new Uint8Array(primaryKey);\n              if (!hasOwn(set, key)) {\n                  set[key] = true;\n                  fn(item, cursor, advance);\n              }\n          }\n      }\n\n      return Promise.all([\n        ctx.or._iterate(union, coreTrans),\n        iterate(openCursor(ctx, coreTable, coreTrans), ctx.algorithm, union, !ctx.keysOnly && ctx.valueMapper)\n      ]);\n  }\n}\n\nfunction iterate(cursorPromise: Promise<DBCoreCursor>, filter, fn, valueMapper): Promise<any> {\n  \n  // Apply valueMapper (hook('reading') or mappped class)\n  var mappedFn = valueMapper ? (x,c,a) => fn(valueMapper(x),c,a) : fn;\n  // Wrap fn with PSD and microtick stuff from Promise.\n  var wrappedFn = wrap(mappedFn);\n  \n  return cursorPromise.then(cursor => {\n    if (cursor) {\n      return cursor.start(()=>{\n        var c = ()=>cursor.continue();\n        if (!filter || filter(cursor, advancer => c = advancer, val=>{cursor.stop(val);c=nop}, e => {cursor.fail(e);c = nop;}))\n          wrappedFn(cursor.value, cursor, advancer => c = advancer);\n        c();\n      });\n    }\n  });\n}\n","import { Collection as ICollection } from \"../../public/types/collection\";\nimport { WhereClause } from \"../where-clause/where-clause\";\nimport { Dexie } from \"../dexie\";\nimport { Table } from \"../table\";\nimport { IndexableType, IndexableTypeArrayReadonly } from \"../../public/types/indexable-type\";\nimport { PromiseExtended } from \"../../public/types/promise-extended\";\nimport { iter, isPlainKeyRange, getIndexOrStore, addReplayFilter, addFilter, addMatchFilter } from \"./collection-helpers\";\nimport { rejection } from \"../../helpers/promise\";\nimport { combine } from \"../../functions/combine\";\nimport { extend, hasOwn, deepClone, getObjectDiff, keys, setByKeyPath, getByKeyPath, shallowClone, tryCatch, flatten } from \"../../functions/utils\";\nimport { eventRejectHandler, eventSuccessHandler, hookedEventRejectHandler, hookedEventSuccessHandler } from \"../../functions/event-wrappers\";\nimport { mirror, nop } from \"../../functions/chaining-functions\";\nimport { ModifyError } from \"../../errors\";\nimport { hangsOnDeleteLargeKeyRange } from \"../../globals/constants\";\nimport { ThenShortcut } from \"../../public/types/then-shortcut\";\nimport { Transaction } from '../transaction';\nimport { DBCoreCursor, DBCoreTransaction, RangeType, MutateResponse, KeyRange } from '../../public/types/dbcore';\nimport { AnyRange } from '../../dbcore/keyrange';\n\n/** class Collection\n * \n * http://dexie.org/docs/Collection/Collection\n */\nexport class Collection implements ICollection {\n  db: Dexie;\n  _ctx: {\n    table: Table;\n    index?: string | null;\n    isPrimKey?: boolean;\n    range: KeyRange;\n    keysOnly: boolean;\n    dir: \"next\" | \"prev\";\n    unique: \"\" | \"unique\";\n    algorithm?: Function | null;\n    filter?: Function | null;\n    replayFilter: Function | null;\n    justLimit: boolean; // True if a replayFilter is just a filter that performs a \"limit\" operation (or none at all)\n    isMatch: Function | null;\n    offset: number,\n    limit: number,\n    error: any, // If set, any promise must be rejected with this error\n    or: Collection,\n    valueMapper: (any) => any\n  }\n  \n  _ondirectionchange?: Function;\n\n  _read<T>(fn: (idbtrans: IDBTransaction, dxTrans: Transaction) => PromiseLike<T>, cb?): PromiseExtended<T> {\n    var ctx = this._ctx;\n    return ctx.error ?\n      ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n      ctx.table._trans('readonly', fn).then(cb);\n  }\n\n  _write<T>(fn: (idbtrans: IDBTransaction, dxTrans: Transaction) => PromiseLike<T>): PromiseExtended<T> {\n    var ctx = this._ctx;\n    return ctx.error ?\n      ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n      ctx.table._trans('readwrite', fn, \"locked\"); // When doing write operations on collections, always lock the operation so that upcoming operations gets queued.\n  }\n\n  _addAlgorithm(fn) {\n    var ctx = this._ctx;\n    ctx.algorithm = combine(ctx.algorithm, fn);\n  }\n\n  _iterate(\n    fn: (item, cursor: DBCoreCursor, advance: Function) => void,\n    coreTrans: DBCoreTransaction) : Promise<any>\n  {\n    return iter(this._ctx, fn, coreTrans, this._ctx.table.core);\n  }\n\n  /** Collection.clone()\n   * \n   * http://dexie.org/docs/Collection/Collection.clone()\n   * \n   **/\n  clone(props?) {\n    var rv = Object.create(this.constructor.prototype),\n      ctx = Object.create(this._ctx);\n    if (props) extend(ctx, props);\n    rv._ctx = ctx;\n    return rv;\n  }\n\n  /** Collection.raw()\n   * \n   * http://dexie.org/docs/Collection/Collection.raw()\n   * \n   **/\n  raw() {\n    this._ctx.valueMapper = null;\n    return this;\n  }\n\n  /** Collection.each()\n   * \n   * http://dexie.org/docs/Collection/Collection.each()\n   * \n   **/\n  each(fn: (obj, cursor: DBCoreCursor) => any): PromiseExtended<void> {\n    var ctx = this._ctx;\n\n    return this._read(trans => iter(ctx, fn, trans, ctx.table.core));\n  }\n\n  /** Collection.count()\n   * \n   * http://dexie.org/docs/Collection/Collection.count()\n   * \n   **/\n  count(cb?) {\n    return this._read(trans => {\n      const ctx = this._ctx;\n      const coreTable = ctx.table.core;\n      if (isPlainKeyRange(ctx, true)) {\n        // This is a plain key range. We can use the count() method if the index.\n        return coreTable.count({\n          trans,\n          query: {\n            index: getIndexOrStore(ctx, coreTable.schema),\n            range: ctx.range\n          }\n        }).then(count => Math.min(count, ctx.limit));\n      } else {\n        // Algorithms, filters or expressions are applied. Need to count manually.\n        var count = 0;\n        return iter(ctx, () => { ++count; return false; }, trans, coreTable)\n        .then(()=>count);\n      }\n    }).then(cb);\n  }\n\n  /** Collection.sortBy()\n   * \n   * http://dexie.org/docs/Collection/Collection.sortBy()\n   * \n   **/\n  sortBy(keyPath: string): PromiseExtended<any[]>;\n  sortBy<R>(keyPath: string, thenShortcut: ThenShortcut<any[], R>) : PromiseExtended<R>;\n  sortBy(keyPath: string, cb?: ThenShortcut<any[], any>) {\n    const parts = keyPath.split('.').reverse(),\n      lastPart = parts[0],\n      lastIndex = parts.length - 1;\n    function getval(obj, i) {\n      if (i) return getval(obj[parts[i]], i - 1);\n      return obj[lastPart];\n    }\n    var order = this._ctx.dir === \"next\" ? 1 : -1;\n\n    function sorter(a, b) {\n      var aVal = getval(a, lastIndex),\n        bVal = getval(b, lastIndex);\n      return aVal < bVal ? -order : aVal > bVal ? order : 0;\n    }\n    return this.toArray(function (a) {\n      return a.sort(sorter);\n    }).then(cb);\n  }\n\n  /** Collection.toArray()\n   * \n   * http://dexie.org/docs/Collection/Collection.toArray()\n   * \n   **/\n  toArray(cb?): PromiseExtended<any[]> {\n    return this._read(trans => {\n      var ctx = this._ctx;\n      if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n        // Special optimation if we could use IDBObjectStore.getAll() or\n        // IDBKeyRange.getAll():\n        const {valueMapper} = ctx;\n        const index = getIndexOrStore(ctx, ctx.table.core.schema);\n        return ctx.table.core.query({\n          trans,\n          limit: ctx.limit,\n          values: true,\n          query: {\n            index,\n            range: ctx.range\n          }\n        }).then(({result}) => valueMapper ? result.map(valueMapper) : result);\n      } else {\n        // Getting array through a cursor.\n        const a = [];\n        return iter(ctx, item => a.push(item), trans, ctx.table.core).then(()=>a);\n      }\n    }, cb);\n  }\n\n  /** Collection.offset()\n   * \n   * http://dexie.org/docs/Collection/Collection.offset()\n   * \n   **/\n  offset(offset: number) : Collection{\n    var ctx = this._ctx;\n    if (offset <= 0) return this;\n    ctx.offset += offset; // For count()\n    if (isPlainKeyRange(ctx)) {\n      addReplayFilter(ctx, () => {\n        var offsetLeft = offset;\n        return (cursor, advance) => {\n          if (offsetLeft === 0) return true;\n          if (offsetLeft === 1) { --offsetLeft; return false; }\n          advance(() => {\n            cursor.advance(offsetLeft);\n            offsetLeft = 0;\n          });\n          return false;\n        };\n      });\n    } else {\n      addReplayFilter(ctx, () => {\n        var offsetLeft = offset;\n        return () => (--offsetLeft < 0);\n      });\n    }\n    return this;\n  }\n\n  /** Collection.limit()\n   * \n   * http://dexie.org/docs/Collection/Collection.limit()\n   * \n   **/\n  limit(numRows: number) : Collection {\n    this._ctx.limit = Math.min(this._ctx.limit, numRows); // For count()\n    addReplayFilter(this._ctx, () => {\n      var rowsLeft = numRows;\n      return function (cursor, advance, resolve) {\n        if (--rowsLeft <= 0) advance(resolve); // Stop after this item has been included\n        return rowsLeft >= 0; // If numRows is already below 0, return false because then 0 was passed to numRows initially. Otherwise we wouldnt come here.\n      };\n    }, true);\n    return this;\n  }\n\n  /** Collection.until()\n   * \n   * http://dexie.org/docs/Collection/Collection.until()\n   * \n   **/\n  until(filterFunction: (x) => boolean, bIncludeStopEntry?) {\n    addFilter(this._ctx, function (cursor, advance, resolve) {\n      if (filterFunction(cursor.value)) {\n        advance(resolve);\n        return bIncludeStopEntry;\n      } else {\n        return true;\n      }\n    });\n    return this;\n  }\n\n  /** Collection.first()\n   * \n   * http://dexie.org/docs/Collection/Collection.first()\n   * \n   **/\n  first(cb?) {\n    return this.limit(1).toArray(function (a) { return a[0]; }).then(cb);\n  }\n\n  /** Collection.last()\n   * \n   * http://dexie.org/docs/Collection/Collection.last()\n   * \n   **/\n  last(cb?) {\n    return this.reverse().first(cb);\n  }\n\n  /** Collection.filter()\n   * \n   * http://dexie.org/docs/Collection/Collection.filter()\n   * \n   **/\n  filter(filterFunction: (x) => boolean): Collection {\n    /// <param name=\"jsFunctionFilter\" type=\"Function\">function(val){return true/false}</param>\n    addFilter(this._ctx, function (cursor) {\n      return filterFunction(cursor.value);\n    });\n    // match filters not used in Dexie.js but can be used by 3rd part libraries to test a\n    // collection for a match without querying DB. Used by Dexie.Observable.\n    addMatchFilter(this._ctx, filterFunction);\n    return this;\n  }\n\n  /** Collection.and()\n   * \n   * http://dexie.org/docs/Collection/Collection.and()\n   * \n   **/\n  and(filter: (x) => boolean) {\n    return this.filter(filter);\n  }\n\n  /** Collection.or()\n   * \n   * http://dexie.org/docs/Collection/Collection.or()\n   * \n   **/\n  or(indexName: string) {\n    return new this.db.WhereClause(this._ctx.table, indexName, this);\n  }\n\n  /** Collection.reverse()\n   * \n   * http://dexie.org/docs/Collection/Collection.reverse()\n   * \n   **/\n  reverse() {\n    this._ctx.dir = (this._ctx.dir === \"prev\" ? \"next\" : \"prev\");\n    if (this._ondirectionchange) this._ondirectionchange(this._ctx.dir);\n    return this;\n  }\n\n  /** Collection.desc()\n   * \n   * http://dexie.org/docs/Collection/Collection.desc()\n   * \n   **/\n  desc() {\n    return this.reverse();\n  }\n\n  /** Collection.eachKey()\n   * \n   * http://dexie.org/docs/Collection/Collection.eachKey()\n   * \n   **/\n  eachKey(cb?) {\n    var ctx = this._ctx;\n    ctx.keysOnly = !ctx.isMatch;\n    return this.each(function (val, cursor) { cb(cursor.key, cursor); });\n  }\n\n  /** Collection.eachUniqueKey()\n   * \n   * http://dexie.org/docs/Collection/Collection.eachUniqueKey()\n   * \n   **/\n  eachUniqueKey(cb?) {\n    this._ctx.unique = \"unique\";\n    return this.eachKey(cb);\n  }\n\n  /** Collection.eachPrimaryKey()\n   * \n   * http://dexie.org/docs/Collection/Collection.eachPrimaryKey()\n   * \n   **/\n  eachPrimaryKey(cb?) {\n    var ctx = this._ctx;\n    ctx.keysOnly = !ctx.isMatch;\n    return this.each(function (val, cursor) { cb(cursor.primaryKey, cursor); });\n  }\n\n  /** Collection.keys()\n   * \n   * http://dexie.org/docs/Collection/Collection.keys()\n   * \n   **/\n  keys(cb?) {\n    var ctx = this._ctx;\n    ctx.keysOnly = !ctx.isMatch;\n    var a = [];\n    return this.each(function (item, cursor) {\n      a.push(cursor.key);\n    }).then(function () {\n      return a;\n    }).then(cb);\n  }\n\n  /** Collection.primaryKeys()\n   * \n   * http://dexie.org/docs/Collection/Collection.primaryKeys()\n   * \n   **/\n  primaryKeys(cb?) : PromiseExtended<IndexableType[]> {\n    var ctx = this._ctx;\n    if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n      // Special optimation if we could use IDBObjectStore.getAllKeys() or\n      // IDBKeyRange.getAllKeys():\n      return this._read(trans => {\n        var index = getIndexOrStore(ctx, ctx.table.core.schema);\n        return ctx.table.core.query({\n          trans,\n          values: false,\n          limit: ctx.limit,\n          query: {\n            index,\n            range: ctx.range\n          }});\n      }).then(({result})=>result).then(cb);\n    }\n    ctx.keysOnly = !ctx.isMatch;\n    var a = [];\n    return this.each(function (item, cursor) {\n      a.push(cursor.primaryKey);\n    }).then(function () {\n      return a;\n    }).then(cb);\n  }\n\n  /** Collection.uniqueKeys()\n   * \n   * http://dexie.org/docs/Collection/Collection.uniqueKeys()\n   * \n   **/\n  uniqueKeys(cb?) {\n    this._ctx.unique = \"unique\";\n    return this.keys(cb);\n  }\n\n  /** Collection.firstKey()\n   * \n   * http://dexie.org/docs/Collection/Collection.firstKey()\n   * \n   **/\n  firstKey(cb?) {\n    return this.limit(1).keys(function (a) { return a[0]; }).then(cb);\n  }\n\n  /** Collection.lastKey()\n   * \n   * http://dexie.org/docs/Collection/Collection.lastKey()\n   * \n   **/\n  lastKey(cb?) {\n    return this.reverse().firstKey(cb);\n  }\n\n  /** Collection.distinct()\n   * \n   * http://dexie.org/docs/Collection/Collection.distinct()\n   * \n   **/\n  distinct() {\n    var ctx = this._ctx,\n      idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n    if (!idx || !idx.multi) return this; // distinct() only makes differencies on multiEntry indexes.\n    var set = {};\n    addFilter(this._ctx, function (cursor: DBCoreCursor) {\n      var strKey = cursor.primaryKey.toString(); // Converts any Date to String, String to String, Number to String and Array to comma-separated string\n      var found = hasOwn(set, strKey);\n      set[strKey] = true;\n      return !found;\n    });\n    return this;\n  }\n\n  //\n  // Methods that mutate storage\n  //\n\n  /** Collection.modify()\n   * \n   * http://dexie.org/docs/Collection/Collection.modify()\n   * \n   **/\n  modify(changes: { [keyPath: string]: any }) : PromiseExtended<number>\n  modify(changes: (obj: any, ctx:{value: any, primKey: IndexableType}) => void | boolean): PromiseExtended<number> {\n    var ctx = this._ctx;\n    return this._write(trans => {\n      var modifyer: (obj: any, ctx:{value: any, primKey: IndexableType}) => void | boolean\n      if (typeof changes === 'function') {\n        // Changes is a function that may update, add or delete propterties or even require a deletion the object itself (delete this.item)\n        modifyer = changes;\n      } else {\n        // changes is a set of {keyPath: value} and no one is listening to the updating hook.\n        var keyPaths = keys(changes);\n        var numKeys = keyPaths.length;\n        modifyer = function (item) {\n          var anythingModified = false;\n          for (var i = 0; i < numKeys; ++i) {\n            var keyPath = keyPaths[i], val = changes[keyPath];\n            if (getByKeyPath(item, keyPath) !== val) {\n              setByKeyPath(item, keyPath, val); // Adding {keyPath: undefined} means that the keyPath should be deleted. Handled by setByKeyPath\n              anythingModified = true;\n            }\n          }\n          return anythingModified;\n        };\n      }\n\n      const coreTable = ctx.table.core;\n      const {outbound, extractKey} = coreTable.schema.primaryKey;\n      const limit = 'testmode' in Dexie ? 1 : 2000;\n      const {cmp} = this.db.core;\n      const totalFailures = [];\n      let successCount = 0;\n      const failedKeys: IndexableType[] = [];\n      const applyMutateResult = (expectedCount: number, res: MutateResponse) => {\n        const {failures, numFailures} = res;\n        successCount += expectedCount - numFailures;\n        for (let pos in failures) {\n          totalFailures.push(failures[pos]);\n        }\n      }\n      return this.clone().primaryKeys().then(keys => {\n\n        const nextChunk = (offset: number) => {\n          const count = Math.min(limit, keys.length - offset);\n          return coreTable.getMany({trans, keys: keys.slice(offset, offset + count)}).then(values => {\n            const addValues = [];\n            const putValues = [];\n            const putKeys = outbound ? [] : null;\n            const deleteKeys = [];\n            for (let i=0; i<count; ++i) {\n              const origValue = values[i];\n              const ctx = {\n                value: deepClone(origValue),\n                primKey: keys[offset+i]\n              };\n              if (modifyer.call(ctx, ctx.value, ctx) !== false) {\n                if (ctx.value == null) {\n                  // Deleted\n                  deleteKeys.push(keys[offset+i]);\n                } else if (!outbound && cmp(extractKey(origValue), extractKey(ctx.value)) !== 0) {\n                  // Changed primary key of inbound\n                  deleteKeys.push(keys[offset+i]);\n                  addValues.push(ctx.value)\n                } else {\n                  // Changed value\n                  putValues.push(ctx.value);\n                  if (outbound) putKeys.push(keys[offset+i]);\n                }\n              }\n            }\n            \n            return Promise.resolve(addValues.length > 0 &&\n              coreTable.mutate({trans, type: 'add', values: addValues})\n                .then(res => {\n                  for (let pos in res.failures) {\n                    // Remove from deleteKeys the key of the object that failed to change its primary key\n                    deleteKeys.splice(parseInt(pos), 1);\n                  }\n                  applyMutateResult(addValues.length, res);\n                })\n            ).then(res=>putValues.length > 0 &&\n                coreTable.mutate({trans, type: 'put', keys: putKeys, values: putValues})\n                  .then(res=>applyMutateResult(putValues.length, res))\n            ).then(()=>deleteKeys.length > 0 &&\n                coreTable.mutate({trans, type: 'delete', keys: deleteKeys})\n                  .then(res=>applyMutateResult(deleteKeys.length, res))\n            ).then(()=>{\n              return keys.length > offset + count && nextChunk(offset + limit);\n            });\n          });\n        }\n\n        return nextChunk(0).then(()=>{\n          if (totalFailures.length > 0)\n            throw new ModifyError(\"Error modifying one or more objects\", totalFailures, successCount, failedKeys as IndexableTypeArrayReadonly);\n\n          return keys.length;\n        });\n      });\n\n    });\n  }\n\n  /** Collection.delete()\n   * \n   * http://dexie.org/docs/Collection/Collection.delete()\n   * \n   **/\n  delete() : PromiseExtended<number> {\n    var ctx = this._ctx,\n      range = ctx.range;\n      //deletingHook = ctx.table.hook.deleting.fire,\n      //hasDeleteHook = deletingHook !== nop;\n    if (isPlainKeyRange(ctx) &&\n      ((ctx.isPrimKey && !hangsOnDeleteLargeKeyRange) || range.type === RangeType.Any)) // if no range, we'll use clear().\n    {\n      // May use IDBObjectStore.delete(IDBKeyRange) in this case (Issue #208)\n      // For chromium, this is the way most optimized version.\n      // For IE/Edge, this could hang the indexedDB engine and make operating system instable\n      // (https://gist.github.com/dfahlander/5a39328f029de18222cf2125d56c38f7)\n      return this._write(trans => {\n        // Our API contract is to return a count of deleted items, so we have to count() before delete().\n        const {primaryKey} = ctx.table.core.schema;\n        const coreRange = range;\n        return ctx.table.core.count({trans, query: {index: primaryKey, range: coreRange}}).then(count => {\n          return ctx.table.core.mutate({trans, type: 'deleteRange', range: coreRange})\n          .then(({failures, lastResult, results, numFailures}) => {\n            if (numFailures) throw new ModifyError(\"Could not delete some values\",\n              Object.keys(failures).map(pos => failures[pos]),\n              count - numFailures);\n            return count - numFailures;\n          });\n        });\n      });\n    }\n\n    return this.modify((value, ctx) => ctx.value = null);\n  }\n}\n\n\n","import { Dexie } from '../../classes/dexie';\nimport { makeClassConstructor } from '../../functions/make-class-constructor';\nimport { Collection } from './collection';\nimport { WhereClause } from '../where-clause/where-clause';\nimport { AnyRange } from '../../dbcore/keyrange';\nimport { KeyRange } from '../../public/types/dbcore';\nimport { mirror } from '../../functions/chaining-functions';\n\n/** Constructs a Collection instance. */\nexport interface CollectionConstructor {\n  new(whereClause?: WhereClause | null, keyRangeGenerator?: () => KeyRange): Collection;\n  prototype: Collection;\n}\n\n/** Generates a Collection constructor bound to given Dexie instance.\n * \n * The purpose of having dynamically created constructors, is to allow\n * addons to extend classes for a certain Dexie instance without affecting\n * other db instances.\n */\nexport function createCollectionConstructor(db: Dexie) {\n  return makeClassConstructor<CollectionConstructor>(\n    Collection.prototype,\n\n    function Collection(\n      this: Collection,\n      whereClause?: WhereClause | null,\n      keyRangeGenerator?: () => KeyRange)\n    {\n      this.db = db;\n      let keyRange = AnyRange, error = null;\n      if (keyRangeGenerator) try {\n        keyRange = keyRangeGenerator();\n      } catch (ex) {\n        error = ex;\n      }\n\n      const whereCtx = whereClause._ctx;\n      const table = whereCtx.table;\n      const readingHook = table.hook.reading.fire;\n      this._ctx = {\n        table: table,\n        index: whereCtx.index,\n        isPrimKey: (!whereCtx.index || (table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name)),\n        range: keyRange,\n        keysOnly: false,\n        dir: \"next\",\n        unique: \"\",\n        algorithm: null,\n        filter: null,\n        replayFilter: null,\n        justLimit: true, // True if a replayFilter is just a filter that performs a \"limit\" operation (or none at all)\n        isMatch: null,\n        offset: 0,\n        limit: Infinity,\n        error: error, // If set, any promise must be rejected with this error\n        or: whereCtx.or,\n        valueMapper: readingHook !== mirror ? readingHook : null\n      };\n    }\n  );\n}\n","import { IndexableType } from '../public/types/indexable-type';\n\nexport function simpleCompare(a, b) {\n  return a < b ? -1 : a === b ? 0 : 1;\n}\n\nexport function simpleCompareReverse(a, b) {\n  return a > b ? -1 : a === b ? 0 : 1;\n}\n","import { WhereClause } from './where-clause';\nimport { Collection } from '../collection';\nimport { Dexie } from '../dexie';\nimport { STRING_EXPECTED } from '../../globals/constants';\nimport { simpleCompare, simpleCompareReverse } from '../../functions/compare-functions';\nimport { CollectionConstructor } from '../collection';\nimport { IndexableType } from '../../public';\nimport { KeyRange, RangeType } from '../../public/types/dbcore';\n\nexport function fail(collectionOrWhereClause: Collection | WhereClause, err, T?) {\n  var collection = collectionOrWhereClause instanceof WhereClause ?\n      new collectionOrWhereClause.Collection (collectionOrWhereClause) :\n      collectionOrWhereClause;\n      \n  collection._ctx.error = T ? new T(err) : new TypeError(err);\n  return collection;\n}\n\nexport function emptyCollection(whereClause: WhereClause) {\n  return new whereClause.Collection (whereClause, () => rangeEqual(\"\")).limit(0);\n}\n\nexport function upperFactory(dir: 'next' | 'prev') {\n  return dir === \"next\" ?\n    (s: string) => s.toUpperCase() :\n    (s: string) => s.toLowerCase();\n}\n\nexport function lowerFactory(dir: 'next' | 'prev') {\n  return dir === \"next\" ?\n    (s: string) => s.toLowerCase() :\n    (s: string) => s.toUpperCase();\n}\n\nexport function nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n  var length = Math.min(key.length, lowerNeedle.length);\n  var llp = -1;\n  for (var i = 0; i < length; ++i) {\n      var lwrKeyChar = lowerKey[i];\n      if (lwrKeyChar !== lowerNeedle[i]) {\n          if (cmp(key[i], upperNeedle[i]) < 0) return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n          if (cmp(key[i], lowerNeedle[i]) < 0) return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n          if (llp >= 0) return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n          return null;\n      }\n      if (cmp(key[i], lwrKeyChar) < 0) llp = i;\n  }\n  if (length < lowerNeedle.length && dir === \"next\") return key + upperNeedle.substr(key.length);\n  if (length < key.length && dir === \"prev\") return key.substr(0, upperNeedle.length);\n  return (llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1));\n}\n\nexport function addIgnoreCaseAlgorithm(whereClause: WhereClause, match, needles, suffix) {\n  /// <param name=\"needles\" type=\"Array\" elementType=\"String\"></param>\n  var upper, lower, compare, upperNeedles, lowerNeedles, direction, nextKeySuffix,\n      needlesLen = needles.length;\n  if (!needles.every(s => typeof s === 'string')) {\n      return fail(whereClause, STRING_EXPECTED);\n  }\n  function initDirection(dir) {\n      upper = upperFactory(dir);\n      lower = lowerFactory(dir);\n      compare = (dir === \"next\" ? simpleCompare : simpleCompareReverse);\n      var needleBounds = needles.map(function (needle){\n          return {lower: lower(needle), upper: upper(needle)};\n      }).sort(function(a,b) {\n          return compare(a.lower, b.lower);\n      });\n      upperNeedles = needleBounds.map(function (nb){ return nb.upper; });\n      lowerNeedles = needleBounds.map(function (nb){ return nb.lower; });\n      direction = dir;\n      nextKeySuffix = (dir === \"next\" ? \"\" : suffix);\n  }\n  initDirection(\"next\");\n\n  var c = new whereClause.Collection (\n      whereClause,\n      ()=>createRange(upperNeedles[0], lowerNeedles[needlesLen-1] + suffix)\n  );\n\n  c._ondirectionchange = function (direction) {\n      // This event onlys occur before filter is called the first time.\n      initDirection(direction);\n  };\n\n  var firstPossibleNeedle = 0;\n\n  c._addAlgorithm(function (cursor, advance, resolve) {\n      /// <param name=\"cursor\" type=\"IDBCursor\"></param>\n      /// <param name=\"advance\" type=\"Function\"></param>\n      /// <param name=\"resolve\" type=\"Function\"></param>\n      var key = cursor.key;\n      if (typeof key !== 'string') return false;\n      var lowerKey = lower(key);\n      if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n          return true;\n      } else {\n          var lowestPossibleCasing = null;\n          for (var i=firstPossibleNeedle; i<needlesLen; ++i) {\n              var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n              if (casing === null && lowestPossibleCasing === null)\n                  firstPossibleNeedle = i + 1;\n              else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                  lowestPossibleCasing = casing;\n              }\n          }\n          if (lowestPossibleCasing !== null) {\n              advance(function () { cursor.continue(lowestPossibleCasing + nextKeySuffix); });\n          } else {\n              advance(resolve);\n          }\n          return false;\n      }\n  });\n  return c;\n}\n\nexport function createRange (lower: IndexableType, upper: IndexableType, lowerOpen?: boolean, upperOpen?: boolean): KeyRange {\n    return {\n        type: RangeType.Range,\n        lower,\n        upper,\n        lowerOpen,\n        upperOpen\n    };\n}\n\nexport function rangeEqual (value: IndexableType) : KeyRange {\n    return {\n        type: RangeType.Equal,\n        lower: value,\n        upper: value\n    };\n}\n","import { WhereClause as IWhereClause } from \"../../public/types/where-clause\";\nimport { Collection } from \"../collection\";\nimport { Table } from \"../table\";\nimport { IndexableTypeArray, IndexableType } from \"../../public/types/indexable-type\";\nimport { emptyCollection, fail, addIgnoreCaseAlgorithm, createRange, rangeEqual } from './where-clause-helpers';\nimport { INVALID_KEY_ARGUMENT, STRING_EXPECTED, maxString, minKey } from '../../globals/constants';\nimport { getArrayOf, NO_CHAR_ARRAY } from '../../functions/utils';\nimport { exceptions } from '../../errors';\nimport { Dexie } from '../dexie';\nimport { Collection as ICollection} from \"../../public/types/collection\";\nimport { RangeType } from '../../public/types/dbcore';\n\n/** class WhereClause\n * \n * http://dexie.org/docs/WhereClause/WhereClause\n */\nexport class WhereClause implements IWhereClause {\n  db: Dexie;\n  _IDBKeyRange: typeof IDBKeyRange;\n  _ctx: {\n    table: Table;\n    index: string;\n    or: Collection;\n  }\n  _cmp: (a: IndexableType, b: IndexableType) => number;\n  _ascending: (a: IndexableType, b: IndexableType) => number;\n  _descending: (a: IndexableType, b: IndexableType) => number;\n  _min: (a: IndexableType, b: IndexableType) => IndexableType;\n  _max: (a: IndexableType, b: IndexableType) => IndexableType;\n\n  get Collection() {\n    return this._ctx.table.db.Collection;\n  }\n\n  /** WhereClause.between()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.between()\n   * \n   **/\n  between(lower: IndexableType, upper: IndexableType, includeLower?: boolean, includeUpper?: boolean) {\n    includeLower = includeLower !== false;   // Default to true\n    includeUpper = includeUpper === true;    // Default to false\n    try {\n      if ((this._cmp(lower, upper) > 0) ||\n        (this._cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)))\n        return emptyCollection(this); // Workaround for idiotic W3C Specification that DataError must be thrown if lower > upper. The natural result would be to return an empty collection.\n      return new this.Collection(this, ()=>createRange(lower, upper, !includeLower, !includeUpper));\n    } catch (e) {\n      return fail(this, INVALID_KEY_ARGUMENT);\n    }\n  }\n\n  /** WhereClause.equals()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.equals()\n   * \n   **/\n  equals(value: IndexableType) {\n    return new this.Collection(this, () => rangeEqual(value)) as ICollection;\n  }\n\n  /** WhereClause.above()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.above()\n   * \n   **/\n  above(value: IndexableType) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => createRange(value, undefined, true));\n  }\n\n  /** WhereClause.aboveOrEqual()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.aboveOrEqual()\n   * \n   **/\n  aboveOrEqual(value: IndexableType) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => createRange(value, undefined, false));\n  }\n\n  /** WhereClause.below()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.below()\n   * \n   **/\n  below(value: IndexableType) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => createRange(undefined, value, false, true));\n  }\n\n  /** WhereClause.belowOrEqual()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.belowOrEqual()\n   * \n   **/\n  belowOrEqual(value: IndexableType) {\n    if (value == null) return fail(this, INVALID_KEY_ARGUMENT);\n    return new this.Collection(this, () => createRange(undefined, value));\n  }\n\n  /** WhereClause.startsWith()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.startsWith()\n   * \n   **/\n  startsWith(str: string) {\n    if (typeof str !== 'string') return fail(this, STRING_EXPECTED);\n    return this.between(str, str + maxString, true, true);\n  }\n\n  /** WhereClause.startsWithIgnoreCase()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.startsWithIgnoreCase()\n   * \n   **/\n  startsWithIgnoreCase(str: string) {\n    if (str === \"\") return this.startsWith(str);\n    return addIgnoreCaseAlgorithm(this, (x, a) => x.indexOf(a[0]) === 0, [str], maxString);\n  }\n\n  /** WhereClause.equalsIgnoreCase()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.equalsIgnoreCase()\n   * \n   **/\n  equalsIgnoreCase(str: string) {\n    return addIgnoreCaseAlgorithm(this, (x, a) => x === a[0], [str], \"\");\n  }\n\n  /** WhereClause.anyOfIgnoreCase()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.anyOfIgnoreCase()\n   * \n   **/\n  anyOfIgnoreCase(...values: string[]): Collection;\n  anyOfIgnoreCase(values: string[]): Collection;\n  anyOfIgnoreCase() {\n    var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    if (set.length === 0) return emptyCollection(this);\n    return addIgnoreCaseAlgorithm(this, (x, a) => a.indexOf(x) !== -1, set, \"\");\n  }\n\n  /** WhereClause.startsWithAnyOfIgnoreCase()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.startsWithAnyOfIgnoreCase()\n   * \n   **/\n  startsWithAnyOfIgnoreCase(...values: string[]): Collection;\n  startsWithAnyOfIgnoreCase(values: string[]): Collection;\n  startsWithAnyOfIgnoreCase() {\n    var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    if (set.length === 0) return emptyCollection(this);\n    return addIgnoreCaseAlgorithm(this, (x, a) => a.some(n => x.indexOf(n) === 0), set, maxString);\n  }\n\n  /** WhereClause.anyOf()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.anyOf()\n   * \n   **/\n  anyOf(...values: string[]): Collection;\n  anyOf(values: string[]): Collection;\n  anyOf() {\n    const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    let compare = this._cmp;\n    try { set.sort(compare); } catch (e) { return fail(this, INVALID_KEY_ARGUMENT); }\n    if (set.length === 0) return emptyCollection(this);\n    const c = new this.Collection(this, () => createRange(set[0], set[set.length - 1]));\n\n    c._ondirectionchange = direction => {\n      compare = (direction === \"next\" ?\n        this._ascending :\n        this._descending);\n      set.sort(compare);\n    };\n\n    let i = 0;\n    c._addAlgorithm((cursor, advance, resolve) => {\n      const key = cursor.key;\n      while (compare(key, set[i]) > 0) {\n        // The cursor has passed beyond this key. Check next.\n        ++i;\n        if (i === set.length) {\n          // There is no next. Stop searching.\n          advance(resolve);\n          return false;\n        }\n      }\n      if (compare(key, set[i]) === 0) {\n        // The current cursor value should be included and we should continue a single step in case next item has the same key or possibly our next key in set.\n        return true;\n      } else {\n        // cursor.key not yet at set[i]. Forward cursor to the next key to hunt for.\n        advance(() => { cursor.continue(set[i]); });\n        return false;\n      }\n    });\n    return c;\n  }\n\n  /** WhereClause.notEqual()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.notEqual()\n   * \n   **/\n  notEqual(value: IndexableType) {\n    return this.inAnyRange([[minKey, value], [value, this.db._maxKey]], { includeLowers: false, includeUppers: false });\n  }\n\n  /** WhereClause.noneOf()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.noneOf()\n   * \n   **/\n  noneOf(...values: string[]): Collection;\n  noneOf(values: string[]): Collection;\n  noneOf() {\n    const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n    if (set.length === 0) return new this.Collection(this); // Return entire collection.\n    try { set.sort(this._ascending); } catch (e) { return fail(this, INVALID_KEY_ARGUMENT); }\n    // Transform [\"a\",\"b\",\"c\"] to a set of ranges for between/above/below: [[minKey,\"a\"], [\"a\",\"b\"], [\"b\",\"c\"], [\"c\",maxKey]]\n    const ranges = set.reduce(\n      (res, val) => res ?\n        res.concat([[res[res.length - 1][1], val]]) :\n        [[minKey, val]],\n      null);\n    ranges.push([set[set.length - 1], this.db._maxKey]);\n    return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n  }\n\n  /** WhereClause.inAnyRange()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.inAnyRange()\n   * \n   **/\n  inAnyRange(\n    ranges: ReadonlyArray<{ 0: IndexableType, 1: IndexableType }>,\n    options?: { includeLowers?: boolean, includeUppers?: boolean })\n  {\n    const cmp = this._cmp,\n          ascending = this._ascending,\n          descending = this._descending,\n          min = this._min,\n          max = this._max;\n\n    if (ranges.length === 0) return emptyCollection(this);\n    if (!ranges.every(range =>\n      range[0] !== undefined &&\n      range[1] !== undefined &&\n      ascending(range[0], range[1]) <= 0)) {\n      return fail(\n        this,\n        \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\",\n        exceptions.InvalidArgument);\n    }\n    const includeLowers = !options || options.includeLowers !== false;   // Default to true\n    const includeUppers = options && options.includeUppers === true;    // Default to false\n\n    function addRange(ranges, newRange) {\n      let i = 0, l = ranges.length;\n      for (; i < l; ++i) {\n        const range = ranges[i];\n        if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n          range[0] = min(range[0], newRange[0]);\n          range[1] = max(range[1], newRange[1]);\n          break;\n        }\n      }\n      if (i === l)\n        ranges.push(newRange);\n      return ranges;\n    }\n\n    let sortDirection = ascending;\n    function rangeSorter(a, b) { return sortDirection(a[0], b[0]); }\n\n    // Join overlapping ranges\n    let set;\n    try {\n      set = ranges.reduce(addRange, []);\n      set.sort(rangeSorter);\n    } catch (ex) {\n      return fail(this, INVALID_KEY_ARGUMENT);\n    }\n\n    let rangePos = 0;\n    const keyIsBeyondCurrentEntry = includeUppers ?\n      key => ascending(key, set[rangePos][1]) > 0 :\n      key => ascending(key, set[rangePos][1]) >= 0;\n\n    const keyIsBeforeCurrentEntry = includeLowers ?\n      key => descending(key, set[rangePos][0]) > 0 :\n      key => descending(key, set[rangePos][0]) >= 0;\n\n    function keyWithinCurrentRange(key) {\n      return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n    }\n\n    let checkKey = keyIsBeyondCurrentEntry;\n\n    const c = new this.Collection(\n      this,\n      () => createRange(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers));\n\n    c._ondirectionchange = direction => {\n      if (direction === \"next\") {\n        checkKey = keyIsBeyondCurrentEntry;\n        sortDirection = ascending;\n      } else {\n        checkKey = keyIsBeforeCurrentEntry;\n        sortDirection = descending;\n      }\n      set.sort(rangeSorter);\n    };\n\n    c._addAlgorithm((cursor, advance, resolve) => {\n      var key = cursor.key;\n      while (checkKey(key)) {\n        // The cursor has passed beyond this key. Check next.\n        ++rangePos;\n        if (rangePos === set.length) {\n          // There is no next. Stop searching.\n          advance(resolve);\n          return false;\n        }\n      }\n      if (keyWithinCurrentRange(key)) {\n        // The current cursor value should be included and we should continue a single step in case next item has the same key or possibly our next key in set.\n        return true;\n      } else if (this._cmp(key, set[rangePos][1]) === 0 || this._cmp(key, set[rangePos][0]) === 0) {\n        // includeUpper or includeLower is false so keyWithinCurrentRange() returns false even though we are at range border.\n        // Continue to next key but don't include this one.\n        return false;\n      } else {\n        // cursor.key not yet at set[i]. Forward cursor to the next key to hunt for.\n        advance(() => {\n          if (sortDirection === ascending) cursor.continue(set[rangePos][0]);\n          else cursor.continue(set[rangePos][1]);\n        });\n        return false;\n      }\n    });\n    return c;\n  }\n\n  /** WhereClause.startsWithAnyOf()\n   * \n   * http://dexie.org/docs/WhereClause/WhereClause.startsWithAnyOf()\n   * \n   **/\n  startsWithAnyOf(...prefixes: string[]): Collection;\n  startsWithAnyOf(prefixes: string[]): Collection;\n  startsWithAnyOf() {\n    const set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n\n    if (!set.every(s => typeof s === 'string')) {\n        return fail(this, \"startsWithAnyOf() only works with strings\");\n    }\n    if (set.length === 0) return emptyCollection(this);\n\n    return this.inAnyRange(set.map((str: string) => [str, str + maxString]));\n  }\n\n}\n","import { Dexie } from '../dexie';\nimport { makeClassConstructor } from '../../functions/make-class-constructor';\nimport { WhereClause } from './where-clause';\nimport { Table } from '../table';\nimport { Collection } from '../collection';\nimport { exceptions } from '../../errors';\n\nexport interface WhereClauseConstructor {\n  new(table: Table, index?: string, orCollection?: Collection): WhereClause;\n  prototype: WhereClause;\n}\n\n/** Generates a WhereClause constructor.\n * \n * The purpose of having dynamically created constructors, is to allow\n * addons to extend classes for a certain Dexie instance without affecting\n * other db instances.\n */\nexport function createWhereClauseConstructor(db: Dexie) {\n  return makeClassConstructor<WhereClauseConstructor>(\n    WhereClause.prototype,\n\n    function WhereClause(this: WhereClause, table: Table, index?: string, orCollection?: Collection) {\n      this.db = db;\n      this._ctx = {\n        table: table,\n        index: index === \":id\" ? null : index,\n        or: orCollection\n      };\n      const indexedDB = db._deps.indexedDB;\n      if (!indexedDB) throw new exceptions.MissingAPI(\"indexedDB API missing\");\n      this._cmp = this._ascending = indexedDB.cmp.bind(indexedDB);\n      this._descending = (a, b) => indexedDB.cmp(b, a);\n      this._max = (a, b) => indexedDB.cmp(a,b) > 0 ? a : b;\n      this._min = (a, b) => indexedDB.cmp(a,b) < 0 ? a : b;\n      this._IDBKeyRange = db._deps.IDBKeyRange;\n    }\n  );\n}\n","import { maxString } from '../globals/constants';\n\nexport function safariMultiStoreFix(storeNames: string[]) {\n  return storeNames.length === 1 ? storeNames[0] : storeNames;\n}\n\nexport function getNativeGetDatabaseNamesFn(indexedDB) {\n  var fn = indexedDB && (indexedDB.getDatabaseNames || indexedDB.webkitGetDatabaseNames);\n  return fn && fn.bind(indexedDB);\n}\n\nexport function getMaxKey (IdbKeyRange: typeof IDBKeyRange) {\n  try {\n    IdbKeyRange.only([[]]);\n    return [[]];\n  } catch (e) {\n    return maxString;\n  }\n}\n","import { wrap } from \"../helpers/promise\";\n\nexport function eventRejectHandler(reject) {\n  return wrap(function (event) {\n      preventDefault(event);\n      reject (event.target.error);\n      return false;\n  });\n}\n\nexport function eventSuccessHandler (resolve) {\n  return wrap(function (event){\n      resolve(event.target.result);\n  });\n}\n\nexport function hookedEventRejectHandler (reject) {\n  return wrap(function (event) {\n      // See comment on hookedEventSuccessHandler() why wrap() is needed only when supporting hooks.\n      \n      var req = event.target,\n          err = req.error,\n          ctx = req._hookCtx,// Contains the hook error handler. Put here instead of closure to boost performance.\n          hookErrorHandler = ctx && ctx.onerror;\n      hookErrorHandler && hookErrorHandler(err);\n      preventDefault(event);\n      reject (err);\n      return false;\n  });\n}\n\nexport function hookedEventSuccessHandler(resolve) {\n  // wrap() is needed when calling hooks because the rare scenario of:\n  //  * hook does a db operation that fails immediately (IDB throws exception)\n  //    For calling db operations on correct transaction, wrap makes sure to set PSD correctly.\n  //    wrap() will also execute in a virtual tick.\n  //  * If not wrapped in a virtual tick, direct exception will launch a new physical tick.\n  //  * If this was the last event in the bulk, the promise will resolve after a physical tick\n  //    and the transaction will have committed already.\n  // If no hook, the virtual tick will be executed in the reject()/resolve of the final promise,\n  // because it is always marked with _lib = true when created using Transaction._promise().\n  return wrap(function(event) {\n      var req = event.target,\n          ctx = req._hookCtx,// Contains the hook error handler. Put here instead of closure to boost performance.\n          result = ctx.value || req.result, // Pass the object value on updates. The result from IDB is the primary key.\n          hookSuccessHandler = ctx && ctx.onsuccess;\n      hookSuccessHandler && hookSuccessHandler(result);\n      resolve && resolve(result);\n  }, resolve);\n}\n\n\nexport function preventDefault(event) {\n  if (event.stopPropagation) // IndexedDBShim doesnt support this on Safari 8 and below.\n      event.stopPropagation();\n  if (event.preventDefault) // IndexedDBShim doesnt support this on Safari 8 and below.\n      event.preventDefault();\n}\n\nexport function BulkErrorHandlerCatchAll(errorList, done?, supportHooks?) {\n  return (supportHooks ? hookedEventRejectHandler : eventRejectHandler)(e => {\n      errorList.push(e);\n      done && done();\n  });\n}\n\n","import { Transaction as ITransaction } from '../../public/types/transaction';\nimport { DexiePromise, wrap, rejection } from \"../../helpers/promise\";\nimport { DbSchema } from '../../public/types/db-schema';\nimport { assert, hasOwn } from '../../functions/utils';\nimport { PSD, usePSD } from '../../helpers/promise';\nimport { Dexie } from '../dexie';\nimport { exceptions } from '../../errors';\nimport { safariMultiStoreFix } from '../../functions/quirks';\nimport { preventDefault } from '../../functions/event-wrappers';\nimport { newScope } from '../../helpers/promise';\nimport * as Debug from '../../helpers/debug';\nimport { Table } from '../table';\n\n/** Transaction\n * \n * http://dexie.org/docs/Transaction/Transaction\n * \n **/\nexport class Transaction implements ITransaction {\n  db: Dexie;\n  active: boolean;\n  mode: IDBTransactionMode;\n  idbtrans: IDBTransaction;\n  storeNames: string[];\n  on: any;\n  parent?: Transaction;\n  schema: DbSchema;\n  _memoizedTables: {[tableName: string]: Table};\n\n  _reculock: number;\n  _blockedFuncs: { 0: () => any, 1: any }[];\n  _resolve: () => void;\n  _reject: (Error) => void;\n  _waitingFor: DexiePromise; // for waitFor()\n  _waitingQueue: Function[]; // for waitFor()\n  _spinCount: number; // Just for debugging waitFor()\n  _completion: DexiePromise;\n\n  //\n  // Transaction internal methods (not required by API users, but needed internally and eventually by dexie extensions)\n  //\n\n  /** Transaction._lock()\n   * \n   * Internal method.\n   */\n  _lock() {\n    assert(!PSD.global); // Locking and unlocking reuires to be within a PSD scope.\n    // Temporary set all requests into a pending queue if they are called before database is ready.\n    ++this._reculock; // Recursive read/write lock pattern using PSD (Promise Specific Data) instead of TLS (Thread Local Storage)\n    if (this._reculock === 1 && !PSD.global) PSD.lockOwnerFor = this;\n    return this;\n  }\n\n  /** Transaction._unlock()\n   * \n   * Internal method.\n   */\n  _unlock() {\n    assert(!PSD.global); // Locking and unlocking reuires to be within a PSD scope.\n    if (--this._reculock === 0) {\n      if (!PSD.global) PSD.lockOwnerFor = null;\n      while (this._blockedFuncs.length > 0 && !this._locked()) {\n        var fnAndPSD = this._blockedFuncs.shift();\n        try { usePSD(fnAndPSD[1], fnAndPSD[0]); } catch (e) { }\n      }\n    }\n    return this;\n  }\n\n  /** Transaction._lock()\n   * \n   * Internal method.\n   */\n  _locked() {\n    // Checks if any write-lock is applied on this transaction.\n    // To simplify the Dexie API for extension implementations, we support recursive locks.\n    // This is accomplished by using \"Promise Specific Data\" (PSD).\n    // PSD data is bound to a Promise and any child Promise emitted through then() or resolve( new Promise() ).\n    // PSD is local to code executing on top of the call stacks of any of any code executed by Promise():\n    //         * callback given to the Promise() constructor  (function (resolve, reject){...})\n    //         * callbacks given to then()/catch()/finally() methods (function (value){...})\n    // If creating a new independant Promise instance from within a Promise call stack, the new Promise will derive the PSD from the call stack of the parent Promise.\n    // Derivation is done so that the inner PSD __proto__ points to the outer PSD.\n    // PSD.lockOwnerFor will point to current transaction object if the currently executing PSD scope owns the lock.\n    return this._reculock && PSD.lockOwnerFor !== this;\n  }\n\n  /** Transaction.create()\n   * \n   * Internal method.\n   * \n   */\n  create(idbtrans?: IDBTransaction) {\n    if (!this.mode) return this;\n    const idbdb = this.db.idbdb;\n    const dbOpenError = this.db._state.dbOpenError;\n    assert(!this.idbtrans);\n    if (!idbtrans && !idbdb) {\n      switch (dbOpenError && dbOpenError.name) {\n        case \"DatabaseClosedError\":\n          // Errors where it is no difference whether it was caused by the user operation or an earlier call to db.open()\n          throw new exceptions.DatabaseClosed(dbOpenError);\n        case \"MissingAPIError\":\n          // Errors where it is no difference whether it was caused by the user operation or an earlier call to db.open()\n          throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n        default:\n          // Make it clear that the user operation was not what caused the error - the error had occurred earlier on db.open()!\n          throw new exceptions.OpenFailed(dbOpenError);\n      }\n    }\n    if (!this.active) throw new exceptions.TransactionInactive();\n    assert(this._completion._state === null); // Completion Promise must still be pending.\n\n    idbtrans = this.idbtrans = idbtrans || idbdb.transaction(safariMultiStoreFix(this.storeNames), this.mode) as IDBTransaction;\n    idbtrans.onerror = wrap(ev => {\n      preventDefault(ev);// Prohibit default bubbling to window.error\n      this._reject(idbtrans.error);\n    });\n    idbtrans.onabort = wrap(ev => {\n      preventDefault(ev);\n      this.active && this._reject(new exceptions.Abort(idbtrans.error));\n      this.active = false;\n      this.on(\"abort\").fire(ev);\n    });\n    idbtrans.oncomplete = wrap(() => {\n      this.active = false;\n      this._resolve();\n    });\n    return this;\n  }\n\n  /** Transaction._promise()\n   * \n   * Internal method.\n   */\n  _promise(\n    mode: IDBTransactionMode,\n    fn: (resolve, reject, trans: Transaction) => PromiseLike<any> | void,\n    bWriteLock?: string | boolean): DexiePromise\n  {\n    if (mode === 'readwrite' && this.mode !== 'readwrite')\n      return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n\n    if (!this.active)\n      return rejection(new exceptions.TransactionInactive());\n\n    if (this._locked()) {\n      return new DexiePromise((resolve, reject) => {\n        this._blockedFuncs.push([() => {\n          this._promise(mode, fn, bWriteLock).then(resolve, reject);\n        }, PSD]);\n      });\n\n    } else if (bWriteLock) {\n      return newScope(() => {\n        var p = new DexiePromise((resolve, reject) => {\n          this._lock();\n          const rv = fn(resolve, reject, this);\n          if (rv && rv.then) rv.then(resolve, reject);\n        });\n        p.finally(() => this._unlock());\n        p._lib = true;\n        return p;\n      });\n\n    } else {\n      var p = new DexiePromise((resolve, reject) => {\n        var rv = fn(resolve, reject, this);\n        if (rv && rv.then) rv.then(resolve, reject);\n      });\n      p._lib = true;\n      return p;\n    }\n  }\n\n  /** Transaction._root()\n   * \n   * Internal method. Retrieves the root transaction in the tree of sub transactions.\n   */\n  _root() {\n    return this.parent ? this.parent._root() : this;\n  }\n\n  /** Transaction.waitFor()\n   * \n   * Internal method. Can be accessed from the public API through\n   * Dexie.waitFor(): http://dexie.org/docs/Dexie/Dexie.waitFor()\n   * \n   **/\n  waitFor(promiseLike: PromiseLike<any>) {\n    // Always operate on the root transaction (in case this is a sub stransaction)\n    var root = this._root();\n    // For stability reasons, convert parameter to promise no matter what type is passed to waitFor().\n    // (We must be able to call .then() on it.)\n    const promise = DexiePromise.resolve(promiseLike);\n    if (root._waitingFor) {\n      // Already called waitFor(). Wait for both to complete.\n      root._waitingFor = root._waitingFor.then(() => promise);\n    } else {\n      // We're not in waiting state. Start waiting state.\n      root._waitingFor = promise;\n      root._waitingQueue = [];\n      // Start interacting with indexedDB until promise completes:\n      var store = root.idbtrans.objectStore(root.storeNames[0]);\n      (function spin() {\n        ++root._spinCount; // For debugging only\n        while (root._waitingQueue.length) (root._waitingQueue.shift())();\n        if (root._waitingFor) store.get(-Infinity).onsuccess = spin;\n      }());\n    }\n    var currentWaitPromise = root._waitingFor;\n    return new DexiePromise((resolve, reject) => {\n      promise.then(\n        res => root._waitingQueue.push(wrap(resolve.bind(null, res))),\n        err => root._waitingQueue.push(wrap(reject.bind(null, err)))\n      ).finally(() => {\n        if (root._waitingFor === currentWaitPromise) {\n          // No one added a wait after us. Safe to stop the spinning.\n          root._waitingFor = null;\n        }\n      });\n    });\n  }  \n\n  /** Transaction.abort()\n   * \n   * http://dexie.org/docs/Transaction/Transaction.abort()\n   */\n  abort() {\n    this.active && this._reject(new exceptions.Abort());\n    this.active = false;\n  }\n\n  /** Transaction.table()\n   * \n   * http://dexie.org/docs/Transaction/Transaction.table()\n   */\n  table(tableName: string) {\n    const memoizedTables = (this._memoizedTables || (this._memoizedTables = {}));\n    if (hasOwn(memoizedTables, tableName))\n      return memoizedTables[tableName];\n    const tableSchema = this.schema[tableName];\n    if (!tableSchema) {\n      throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");        \n    }\n\n    const transactionBoundTable = new this.db.Table(tableName, tableSchema, this);\n    transactionBoundTable.core = this.db.core.table(tableName);\n    memoizedTables[tableName] = transactionBoundTable;\n    return transactionBoundTable;\n  }\n}\n","import { Dexie } from '../dexie';\nimport { makeClassConstructor } from '../../functions/make-class-constructor';\nimport { Transaction } from './transaction';\nimport { DbSchema } from '../../public/types/db-schema';\nimport Events from '../../helpers/Events';\nimport Promise, { rejection } from '../../helpers/promise';\n\nexport interface TransactionConstructor<T extends Transaction=Transaction> {\n  new (\n    mode: IDBTransactionMode,\n    storeNames: string[],\n    dbschema: DbSchema,\n    parent?: Transaction) : T;\n  prototype: T;\n}\n\n/** Generates a Transaction constructor bound to given Dexie instance.\n * \n * The purpose of having dynamically created constructors, is to allow\n * addons to extend classes for a certain Dexie instance without affecting\n * other db instances.\n */\nexport function createTransactionConstructor(db: Dexie) {\n  return makeClassConstructor<TransactionConstructor<Transaction>>(\n    Transaction.prototype,\n    function Transaction (\n      this: Transaction,\n      mode: IDBTransactionMode,\n      storeNames: string[],\n      dbschema: DbSchema,\n      parent?: Transaction)\n    {\n      this.db = db;\n      this.mode = mode;\n      this.storeNames = storeNames;\n      this.schema = dbschema;\n      this.idbtrans = null;\n      this.on = Events(this, \"complete\", \"error\", \"abort\");\n      this.parent = parent || null;\n      this.active = true;\n      this._reculock = 0;\n      this._blockedFuncs = [];\n      this._resolve = null;\n      this._reject = null;\n      this._waitingFor = null;\n      this._waitingQueue = null;\n      this._spinCount = 0; // Just for debugging waitFor()\n      this._completion = new Promise ((resolve, reject) => {\n          this._resolve = resolve;\n          this._reject = reject;\n      });\n      \n      this._completion.then(\n          ()=> {\n              this.active = false;\n              this.on.complete.fire();\n          },\n          e => {\n              var wasActive = this.active;\n              this.active = false;\n              this.on.error.fire(e);\n              this.parent ?\n                  this.parent._reject(e) :\n                  wasActive && this.idbtrans && this.idbtrans.abort();\n              return rejection(e); // Indicate we actually DO NOT catch this error.\n          });\n    \n    });\n}\n","import { IndexSpec } from '../public/types/index-spec';\n\nexport function createIndexSpec(\n  name: string,\n  keyPath?: string | string[],\n  unique?: boolean,\n  multi?: boolean,\n  auto?: boolean,\n  compound?: boolean,\n): IndexSpec {\n  return {\n    name,\n    keyPath,\n    unique,\n    multi,\n    auto,\n    compound,\n    src: (unique ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + nameFromKeyPath(keyPath)\n  }\n}\n\nexport function nameFromKeyPath (keyPath?: string | string[]): string {\n  return typeof keyPath === 'string' ?\n    keyPath :\n    keyPath ? ('[' + [].join.call(keyPath, '+') + ']') : \"\";\n}\n","import { IndexSpec } from '../public/types/index-spec';\nimport { TableSchema } from '../public/types/table-schema';\nimport { createIndexSpec } from './index-spec';\nimport { arrayToObject } from '../functions/utils';\n\nexport function createTableSchema (\n  name: string,\n  primKey: IndexSpec,\n  indexes: IndexSpec[]\n): TableSchema {\n  return {\n    name,\n    primKey,\n    indexes,\n    mappedClass: null,\n    idxByName: arrayToObject(indexes, index => [index.name, index])\n  };\n}\n","import { exceptions } from '../errors';\nimport { isArray, getByKeyPath } from '../functions/utils';\nimport { Key } from '../public/types/dbcore';\n\nexport function getKeyExtractor (keyPath: null | string | string[]) : (a: any) => Key {\n  if (keyPath == null) {\n    return () => undefined;\n  } else if (typeof keyPath === 'string') {\n    return getSinglePathKeyExtractor(keyPath);\n  } else {\n    return obj => getByKeyPath(obj, keyPath);\n  }\n}\n\nexport function getSinglePathKeyExtractor(keyPath: string) {\n  const split = keyPath.split('.');\n  if (split.length === 1) {\n    return obj => obj[keyPath];\n  } else {\n    return obj => getByKeyPath(obj, keyPath);\n  }\n}\n","import { AddRequest, PutRequest, DeleteRequest, Key, DBCoreIndex, DBCoreTable } from '../public/types/dbcore';\n\nexport function getEffectiveKeys (\n  primaryKey: DBCoreIndex,\n  req: (Pick<AddRequest | PutRequest, \"type\" | \"values\"> & {keys?: Key[]}) | Pick<DeleteRequest, \"keys\" | \"type\">)\n{\n  //const {outbound} = primaryKey;\n  if (req.type === 'delete') return req.keys;\n  return req.keys || req.values.map(primaryKey.extractKey)\n}\n\nexport function getExistingValues (table: DBCoreTable, req: AddRequest | PutRequest | DeleteRequest, effectiveKeys: Key[]) {\n  return req.type === 'add' ? Promise.resolve(new Array<any>(req.values.length)) :\n    table.getMany({trans: req.trans, keys: effectiveKeys});\n}\n","import { DBCore, DBCoreCursor, DBCoreOpenCursorRequest, DBCoreQueryRequest, DBCoreCountRequest,\n  DBCoreIndex, KeyRange, DBCoreQueryResponse, RangeType, DBCoreSchema, DBCoreTableSchema, DBCoreTable,\n  MutateRequest, AddRequest, PutRequest, DeleteRequest, DeleteRangeRequest, MutateResponse, DBCoreTransaction }\n  from '../public/types/dbcore';\nimport { isArray, trycatcher } from '../functions/utils';\nimport { eventRejectHandler, preventDefault } from '../functions/event-wrappers';\nimport { wrap } from '../helpers/promise';\nimport { getMaxKey } from '../functions/quirks';\nimport { getKeyExtractor } from './get-key-extractor';\nimport { getEffectiveKeys } from './get-effective-keys';\n\nexport function arrayify<T>(arrayLike: {length: number, [index: number]: T}): T[] {\n  return [].slice.call(arrayLike);\n}\nexport function pick<T,Prop extends keyof T>(obj: T, props: Prop[]): Pick<T, Prop> {\n  const result = {} as Pick<T, Prop>;\n  props.forEach(prop => result[prop] = obj[prop]);\n  return result;\n}\n\nlet _id_counter = 0;\n\nexport function getKeyPathAlias(keyPath: null | string | string[]) {\n  return keyPath == null ?\n    \":id\" :\n    typeof keyPath === 'string' ?\n      keyPath :\n      `[${keyPath.join('+')}]`;\n}\n\nexport function createDBCore (\n  db: IDBDatabase,\n  indexedDB: IDBFactory,\n  IdbKeyRange: typeof IDBKeyRange,\n  tmpTrans: IDBTransaction) : DBCore\n{\n  const cmp = indexedDB.cmp.bind(indexedDB);\n  \n  function extractSchema(db: IDBDatabase, trans: IDBTransaction) : {schema: DBCoreSchema, hasGetAll: boolean} {\n    const tables = arrayify(db.objectStoreNames);\n    return {\n      schema: {\n        name: db.name,\n        tables: tables.map(table => trans.objectStore(table)).map(store => {\n          const {keyPath, autoIncrement} = store;\n          const compound = isArray(keyPath);\n          const outbound = keyPath == null;\n          const indexByKeyPath: {[keyPathAlias: string]: DBCoreIndex} = {};\n          const result = {\n            name: store.name,\n            primaryKey: {\n              name: null,\n              isPrimaryKey: true,\n              outbound,\n              compound,\n              keyPath,\n              autoIncrement,\n              unique: true,\n              extractKey: getKeyExtractor(keyPath)\n            } as DBCoreIndex,\n            indexes: arrayify(store.indexNames).map(indexName => store.index(indexName))\n              .map(index => {\n                const {name, unique, multiEntry, keyPath} = index;\n                const compound = isArray(keyPath);\n                const result: DBCoreIndex = {\n                  name,\n                  compound,\n                  keyPath,\n                  unique,\n                  multiEntry,\n                  extractKey: getKeyExtractor(keyPath)\n                };\n                indexByKeyPath[getKeyPathAlias(keyPath)] = result;\n                return result;\n              }),\n            getIndexByKeyPath: (keyPath: null | string | string[]) => indexByKeyPath[getKeyPathAlias(keyPath)]\n          };\n          indexByKeyPath[\":id\"] = result.primaryKey;\n          if (keyPath != null) {\n            indexByKeyPath[getKeyPathAlias(keyPath)] = result.primaryKey;\n          }\n          return result;\n        })\n      },\n      hasGetAll: tables.length > 0 && ('getAll' in trans.objectStore(tables[0])) &&\n        !(typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n        !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n        [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) // Bug with getAll() on Safari ver<604. See discussion following PR #579\n    };\n  }\n\n  function makeIDBKeyRange (range: KeyRange) : IDBKeyRange | null {\n    if (range.type === RangeType.Any) return null;\n    if (range.type === RangeType.Never) throw new Error(\"Cannot convert never type to IDBKeyRange\");\n    const {lower, upper, lowerOpen, upperOpen} = range;\n    const idbRange = lower === undefined ?\n      upper === undefined ?\n        null : //IDBKeyRange.lowerBound(-Infinity, false) : // Any range (TODO: Should we return null instead?)\n        IdbKeyRange.upperBound(upper, !!upperOpen) : // below\n      upper === undefined ?\n        IdbKeyRange.lowerBound(lower, !!lowerOpen) : // above\n        IdbKeyRange.bound(lower, upper, !!lowerOpen, !!upperOpen);\n    return idbRange;\n  }\n\n  function createDbCoreTable(tableSchema: DBCoreTableSchema): DBCoreTable {\n    const tableName = tableSchema.name;\n\n    function mutate ({trans, type, keys, values, range, wantResults}) {\n      return new Promise<MutateResponse>((resolve, reject) => {\n        resolve = wrap(resolve);\n        const store = (trans as IDBTransaction).objectStore(tableName);\n        const outbound = store.keyPath == null;\n        const isAddOrPut = type === \"put\" || type === \"add\";\n        if (!isAddOrPut && type !== 'delete' && type !== 'deleteRange')\n          throw new Error (\"Invalid operation type: \" + type);\n\n        const {length} = keys || values || {length: 1}; // keys.length if keys. values.length if values. 1 if range.\n        if (keys && values && keys.length !== values.length) {\n          throw new Error(\"Given keys array must have same length as given values array.\");\n        }\n        if (length === 0)\n          // No items to write. Don't even bother!\n          return resolve({numFailures: 0, failures: {}, results: [], lastResult: undefined});\n\n        const results = wantResults && [...(keys ?\n          keys : // keys already resolved in an earlier middleware. Don't re-resolve them.\n          getEffectiveKeys(tableSchema.primaryKey, {type, keys, values}))];\n          \n        let req: IDBRequest & { _reqno?};\n        const failures: {[operationNumber: number]: Error} = [];\n        let numFailures = 0;\n        const errorHandler = \n          event => {\n            ++numFailures;\n            preventDefault(event);\n            if (results) results[(event.target as any)._reqno] = undefined;\n            failures[(event.target as any)._reqno] = event.target.error;\n          };\n        const setResult = ({target}) => {\n          results[target._reqno] = target.result;\n        }\n  \n        if (type === 'deleteRange') {\n          // Here the argument is the range\n          if (range.type === RangeType.Never)\n            return resolve({numFailures, failures, results, lastResult: undefined}); // Deleting the Never range shoulnt do anything.\n          if (range.type === RangeType.Any)\n            req = store.clear(); // Deleting the Any range is equivalent to store.clear()\n          else\n            req = store.delete(makeIDBKeyRange(range));\n        } else {\n          // No matter add, put or delete - find out arrays of first and second arguments to it.\n          const [args1, args2] = isAddOrPut ?\n            outbound ?\n              [values, keys] :\n              [values, null] :\n            [keys, null];\n\n          if (isAddOrPut) {\n            for (let i=0; i<length; ++i) {\n              req = (args2 && args2[i] !== undefined ?\n                store[type](args1[i], args2[i]) :\n                store[type](args1[i])) as IDBRequest;\n              req._reqno = i;\n              if (results && results[i] === undefined) {\n                // Key is not set explicitely and is autoIncremented.\n                // Have to listen for onsuccess and set the resulting key.\n                req.onsuccess = setResult;\n              }\n              req.onerror = errorHandler;\n            }\n          } else {\n            for (let i=0; i<length; ++i) {\n              req = store[type](args1[i]) as IDBRequest;\n              req._reqno = i;\n              req.onerror = errorHandler;\n            }\n          }\n        }\n        const done = event => {\n          const lastResult = event.target.result;\n          if (results) results[length-1] = lastResult;\n          resolve({\n            numFailures,\n            failures,\n            results,\n            lastResult\n          });\n        };\n  \n        req.onerror = event => { // wrap() not needed. All paths calling outside will wrap!\n          errorHandler(event);\n          done(event);\n        };\n  \n        req.onsuccess = done;\n      });\n    }\n    \n    function openCursor ({trans, values, query, reverse, unique}: DBCoreOpenCursorRequest): Promise<DBCoreCursor>\n    {\n      return new Promise((resolve, reject) => {\n        resolve = wrap(resolve);\n        const {index, range} = query;\n        const store = (trans as IDBTransaction).objectStore(tableName);\n        // source\n        const source = index.isPrimaryKey ?\n          store :\n          store.index(index.name);\n        // direction\n        const direction = reverse ?\n          unique ?\n            \"prevunique\" :\n            \"prev\" :\n          unique ?\n            \"nextunique\" :\n            \"next\";\n        // request\n        const req = values || !('openKeyCursor' in source) ?\n          source.openCursor(makeIDBKeyRange(range), direction) :\n          source.openKeyCursor(makeIDBKeyRange(range), direction);\n          \n        // iteration\n        req.onerror = eventRejectHandler(reject);\n        req.onsuccess = wrap(ev => {\n\n          const cursor = req.result as DBCoreCursor;\n          if (!cursor) {\n            resolve(null);\n            return;\n          }\n          (cursor as any).___id = ++_id_counter;\n          (cursor as any).done = false;\n          const _cursorContinue = cursor.continue.bind(cursor);\n          let _cursorContinuePrimaryKey = cursor.continuePrimaryKey;\n          if (_cursorContinuePrimaryKey) _cursorContinuePrimaryKey = _cursorContinuePrimaryKey.bind(cursor);\n          const _cursorAdvance = cursor.advance.bind(cursor);\n          const doThrowCursorIsNotStarted = ()=>{throw new Error(\"Cursor not started\");}\n          const doThrowCursorIsStopped = ()=>{throw new Error(\"Cursor not stopped\");}\n          (cursor as any).trans = trans;\n          cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsNotStarted;\n          cursor.fail = wrap(reject);\n          cursor.next = function (this: DBCoreCursor) {\n            // next() must work with \"this\" pointer in order to function correctly for ProxyCursors (derived objects)\n            // without having to re-define next() on each child.\n            let gotOne = 1;\n            return this.start(() => gotOne-- ? this.continue() : this.stop()).then(() => this);\n          };\n          cursor.start = (callback) => {\n            //console.log(\"Starting cursor\", (cursor as any).___id);\n            const iterationPromise = new Promise<void>((resolveIteration, rejectIteration) =>{\n              resolveIteration = wrap(resolveIteration);\n              req.onerror = eventRejectHandler(rejectIteration);\n              cursor.fail = rejectIteration;\n              cursor.stop = value => {\n                //console.log(\"Cursor stop\", cursor);\n                cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsStopped;\n                resolveIteration(value);\n              };\n            });\n            // Now change req.onsuccess to a callback that doesn't call initCursor but just observer.next()\n            const guardedCallback = () => {\n              if (req.result) {\n                //console.log(\"Next result\", cursor);\n                try {\n                  callback();\n                } catch (err) {\n                  cursor.fail(err);\n                }\n              } else {\n                (cursor as any).done = true;\n                cursor.start = ()=>{throw new Error(\"Cursor behind last entry\");}\n                cursor.stop();\n              }\n            }\n            req.onsuccess = wrap(ev => {\n              //cursor.continue = _cursorContinue;\n              //cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n              //cursor.advance = _cursorAdvance;\n              req.onsuccess = guardedCallback;\n              guardedCallback();\n            });\n            cursor.continue = _cursorContinue;\n            cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n            cursor.advance = _cursorAdvance;\n            guardedCallback();\n            return iterationPromise;\n          };\n          resolve(cursor);\n        }, reject); \n      });\n    }\n  \n    function query (hasGetAll: boolean) {\n      return (request: DBCoreQueryRequest) => {\n        return new Promise<DBCoreQueryResponse>((resolve, reject) => {\n          resolve = wrap(resolve);\n          const {trans, values, limit, query} = request;\n          const nonInfinitLimit = limit === Infinity ? undefined : limit;\n          const {index, range} = query;\n          const store = (trans as IDBTransaction).objectStore(tableName);\n          const source = index.isPrimaryKey ? store : store.index(index.name);\n          const idbKeyRange = makeIDBKeyRange(range);\n          if (limit === 0) return resolve({result: []});\n          if (hasGetAll) {\n            const req = values ?\n                (source as any).getAll(idbKeyRange, nonInfinitLimit) :\n                (source as any).getAllKeys(idbKeyRange, nonInfinitLimit);\n            req.onsuccess = event => resolve({result: event.target.result});\n            req.onerror = eventRejectHandler(reject);\n          } else {\n            let count = 0;\n            const req = values || !('openKeyCursor' in source) ?\n              source.openCursor(idbKeyRange) :\n              source.openKeyCursor(idbKeyRange)\n            const result = [];\n            req.onsuccess = event => {\n              const cursor = req.result as IDBCursorWithValue;\n              if (!cursor) return resolve({result});\n              result.push(values ? cursor.value : cursor.primaryKey);\n              if (++count === limit) return resolve({result});\n              cursor.continue();\n            };\n            req.onerror = eventRejectHandler(reject);\n          }\n        });\n      };\n    }\n  \n    return {\n      name: tableName,\n      schema: tableSchema,\n      \n      mutate,\n\n      getMany ({trans, keys}) {\n        return new Promise<any[]>((resolve, reject) => {\n          resolve = wrap(resolve);\n          const store = (trans as IDBTransaction).objectStore(tableName);\n          const length = keys.length;\n          const result = new Array(length);\n          let keyCount = 0;\n          let callbackCount = 0;\n          let valueCount = 0;\n          let req: IDBRequest & {_pos?: number};\n    \n          const successHandler = event => {\n            const req = event.target;\n            if ((result[req._pos] = req.result) != null) ++valueCount;\n            if (++callbackCount === keyCount) resolve(result);\n          };\n          const errorHandler = eventRejectHandler(reject);\n    \n          for (let i=0; i<length; ++i) {\n            const key = keys[i];\n            if (key != null) {\n              req = store.get(keys[i]);\n              req._pos = i;\n              req.onsuccess = successHandler;\n              req.onerror = errorHandler;\n              ++keyCount;\n            }\n          }\n          if (keyCount === 0) resolve(result);\n        });\n      },\n\n      get ({trans, key}) {\n        return new Promise<any>((resolve, reject) => {\n          resolve = wrap (resolve);\n          const store = (trans as IDBTransaction).objectStore(tableName);\n          const req = store.get(key);\n          req.onsuccess = event => resolve((event.target as any).result);\n          req.onerror = eventRejectHandler(reject);\n        });\n      },\n\n      query: query(hasGetAll),\n      \n      openCursor,\n\n      count ({query, trans}) {\n        const {index, range} = query;\n        return new Promise<number>((resolve, reject) => {\n          const store = (trans as IDBTransaction).objectStore(tableName);\n          const source = index.isPrimaryKey ? store : store.index(index.name);\n          const idbKeyRange = makeIDBKeyRange(range);\n          const req = idbKeyRange ? source.count(idbKeyRange) : source.count();\n          req.onsuccess = wrap(ev => resolve(ev.target.result));\n          req.onerror = eventRejectHandler(reject);\n        });\n      }\n    };\n  }\n\n  const {schema, hasGetAll} = extractSchema(db, tmpTrans);\n  const tables = schema.tables.map(tableSchema => createDbCoreTable(tableSchema));\n  const tableMap: {[name: string]: DBCoreTable} = {};\n  tables.forEach(table => tableMap[table.name] = table);\n  return {\n    stack: \"dbcore\",\n    \n    transaction: db.transaction.bind(db),\n\n    table(name: string) {\n      const result = tableMap[name];\n      if (!result) throw new Error(`Table '${name}' not found`);\n      return tableMap[name];\n    },\n\n    cmp,\n\n    MIN_KEY: -Infinity,\n\n    MAX_KEY: getMaxKey(IdbKeyRange),\n\n    schema\n\n  };\n}\n","import { Dexie } from './';\nimport { createDBCore } from '../../dbcore/dbcore-indexeddb';\nimport { DBCore } from '../../public/types/dbcore';\nimport { DexieDOMDependencies } from '../../public/types/dexie-dom-dependencies';\nimport { DexieStacks, Middleware } from '../../public/types/middleware';\nimport { exceptions } from '../../errors';\n\nfunction createMiddlewareStack<TStack extends {stack: string}>(\n  stackImpl: {stack: string},\n  middlewares: Middleware<{stack: string}>[]): TStack {\n  return middlewares.reduce((down, {create}) => ({...down, ...create(down)}), stackImpl) as TStack;\n} \n\nfunction createMiddlewareStacks(\n  middlewares: {[StackName in keyof DexieStacks]?: Middleware<DexieStacks[StackName]>[]},\n  idbdb: IDBDatabase,\n  {IDBKeyRange, indexedDB}: DexieDOMDependencies,\n  tmpTrans: IDBTransaction): {[StackName in keyof DexieStacks]?: DexieStacks[StackName]}\n{\n  const dbcore = createMiddlewareStack<DBCore>(\n    createDBCore(idbdb, indexedDB, IDBKeyRange, tmpTrans),\n    middlewares.dbcore);\n  \n  // TODO: Create other stacks the same way as above. They might be dependant on the result\n  // of creating dbcore stack.\n\n  return {\n    dbcore\n  };\n}\n\nexport function generateMiddlewareStacks(db: Dexie, tmpTrans: IDBTransaction) {\n  const idbdb = tmpTrans.db;\n  const stacks = createMiddlewareStacks(db._middlewares, idbdb, db._deps, tmpTrans);\n  db.core = stacks.dbcore!;\n  db.tables.forEach(table => {\n    const tableName = table.name;\n    if (db.core.schema.tables.some(tbl => tbl.name === tableName)) {\n      table.core = db.core.table(tableName);\n      if (db[tableName] instanceof db.Table) {\n          db[tableName].core = table.core;\n      }\n    }\n  });\n}\n","import { Dexie } from '../dexie';\nimport { DbSchema } from '../../public/types/db-schema';\nimport { setProp, keys, slice, _global, isArray, shallowClone } from '../../functions/utils';\nimport { Transaction } from '../transaction';\nimport { Version } from './version';\nimport Promise, { PSD, newScope, NativePromise, decrementExpectedAwaits, incrementExpectedAwaits } from '../../helpers/promise';\nimport { exceptions } from '../../errors';\nimport { TableSchema } from '../../public/types/table-schema';\nimport { IndexSpec } from '../../public/types/index-spec';\nimport { hasIEDeleteObjectStoreBug } from '../../globals/constants';\nimport { safariMultiStoreFix } from '../../functions/quirks';\nimport { createIndexSpec, nameFromKeyPath } from '../../helpers/index-spec';\nimport { createTableSchema } from '../../helpers/table-schema';\nimport { generateMiddlewareStacks } from '../dexie/generate-middleware-stacks';\n\nexport function setApiOnPlace(db: Dexie, objs: Object[], tableNames: string[], dbschema: DbSchema) {\n  tableNames.forEach(tableName => {\n    const schema = dbschema[tableName];\n    objs.forEach(obj => {\n      if (!(tableName in obj)) {\n        if (obj === db.Transaction.prototype || obj instanceof db.Transaction) {\n          // obj is a Transaction prototype (or prototype of a subclass to Transaction)\n          // Make the API a getter that returns this.table(tableName)\n          setProp(obj, tableName, { get(this: Transaction) { return this.table(tableName); } });\n        } else {\n          // Table will not be bound to a transaction (will use Dexie.currentTransaction)\n          obj[tableName] = new db.Table(tableName, schema);\n        }\n      }\n    });\n  });\n}\n\nexport function removeTablesApi(db: Dexie, objs: Object[]) {\n  objs.forEach(obj => {\n    for (let key in obj) {\n      if (obj[key] instanceof db.Table) delete obj[key];\n    }\n  });\n}\n\nexport function lowerVersionFirst(a: Version, b: Version) {\n  return a._cfg.version - b._cfg.version;\n}\n\nexport function runUpgraders(db: Dexie, oldVersion: number, idbUpgradeTrans: IDBTransaction, reject) {\n  const globalSchema = db._dbSchema;\n  const trans = db._createTransaction('readwrite', db._storeNames, globalSchema);\n  trans.create(idbUpgradeTrans);\n  trans._completion.catch(reject);\n  const rejectTransaction = trans._reject.bind(trans);\n  const transless = PSD.transless || PSD;\n  newScope(() => {\n    PSD.trans = trans;\n    PSD.transless = transless;\n    if (oldVersion === 0) {\n      // Create tables:\n      keys(globalSchema).forEach(tableName => {\n        createTable(idbUpgradeTrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n      });\n      generateMiddlewareStacks(db, idbUpgradeTrans);\n      Promise.follow(() => db.on.populate.fire(trans)).catch(rejectTransaction);\n    } else\n      updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans).catch(rejectTransaction);\n  });\n}\n\nexport type UpgradeQueueItem = (idbtrans: IDBTransaction) => PromiseLike<any> | void;\n\nexport function updateTablesAndIndexes(\n  db: Dexie,\n  oldVersion: number,\n  trans: Transaction,\n  idbUpgradeTrans: IDBTransaction)\n{\n  // Upgrade version to version, step-by-step from oldest to newest version.\n  // Each transaction object will contain the table set that was current in that version (but also not-yet-deleted tables from its previous version)\n  const queue: UpgradeQueueItem[] = [];\n  const versions = db._versions;\n  const oldVersionStruct = versions.filter(version => version._cfg.version === oldVersion)[0];\n  if (!oldVersionStruct) throw new exceptions.Upgrade(\n    \"Dexie specification of currently installed DB version is missing\");\n  let globalSchema = db._dbSchema = oldVersionStruct._cfg.dbschema;\n  let anyContentUpgraderHasRun = false;\n\n  const versToRun = versions.filter(v => v._cfg.version > oldVersion);\n  versToRun.forEach(version => {\n    queue.push(() => {\n      const oldSchema = globalSchema;\n      const newSchema = version._cfg.dbschema;\n      adjustToExistingIndexNames(db, oldSchema, idbUpgradeTrans);\n      adjustToExistingIndexNames(db, newSchema, idbUpgradeTrans);\n\n      globalSchema = db._dbSchema = newSchema;\n\n      const diff = getSchemaDiff(oldSchema, newSchema);\n      // Add tables           \n      diff.add.forEach(tuple => {\n        createTable(idbUpgradeTrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n      });\n      // Change tables\n      diff.change.forEach(change => {\n        if (change.recreate) {\n          throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n        } else {\n          const store = idbUpgradeTrans.objectStore(change.name);\n          // Add indexes\n          change.add.forEach(idx => addIndex(store, idx));\n          // Update indexes\n          change.change.forEach(idx => {\n            store.deleteIndex(idx.name);\n            addIndex(store, idx);\n          });\n          // Delete indexes\n          change.del.forEach(idxName => store.deleteIndex(idxName));\n        }\n      });\n\n      const contentUpgrade = version._cfg.contentUpgrade;\n\n      if (contentUpgrade) {\n        // Update db.core with new tables and indexes:\n        generateMiddlewareStacks(db, idbUpgradeTrans);\n\n        anyContentUpgraderHasRun = true;\n\n        // Add to-be-deleted tables to contentUpgrade transaction\n        let upgradeSchema = shallowClone(newSchema);\n        diff.del.forEach(table => {\n          upgradeSchema[table] = oldSchema[table];\n        });\n\n        // Safe to affect Transaction.prototype globally in this moment,\n        // because when this code runs, there may not be any other code\n        // that can access any transaction instance, else than this particular\n        // upgrader function.\n        removeTablesApi(db, [db.Transaction.prototype]);\n        setApiOnPlace(db, [db.Transaction.prototype], keys(upgradeSchema), upgradeSchema);\n        trans.schema = upgradeSchema;\n\n        // Support for native async await.\n        incrementExpectedAwaits();\n        \n        let returnValue: any;\n        const promiseFollowed = Promise.follow(() => {\n          // Finally, call the scope function with our table and transaction arguments.\n          returnValue = contentUpgrade(trans);\n          if (returnValue) {\n            if (returnValue.constructor === NativePromise) {\n              var decrementor = decrementExpectedAwaits.bind(null, null);\n              returnValue.then(decrementor, decrementor);\n            } else {\n              decrementExpectedAwaits();\n            }\n          } else {\n            decrementExpectedAwaits();\n          }\n        });\n        return (returnValue && typeof returnValue.then === 'function' ?\n          Promise.resolve(returnValue) : promiseFollowed.then(()=>returnValue));\n      }\n    });\n    queue.push(idbtrans => {\n      if (!anyContentUpgraderHasRun || !hasIEDeleteObjectStoreBug) { // Dont delete old tables if ieBug is present and a content upgrader has run. Let tables be left in DB so far. This needs to be taken care of.\n        const newSchema = version._cfg.dbschema;\n        // Delete old tables\n        deleteRemovedTables(newSchema, idbtrans);\n      }\n      // Restore the final API\n      removeTablesApi(db, [db.Transaction.prototype]);\n      setApiOnPlace(db, [db.Transaction.prototype], db._storeNames, db._dbSchema);\n      trans.schema = db._dbSchema;\n    });\n  });\n\n  // Now, create a queue execution engine\n  function runQueue() {\n    return queue.length ? Promise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) :\n      Promise.resolve();\n  }\n\n  return runQueue().then(() => {\n    createMissingTables(globalSchema, idbUpgradeTrans); // At last, make sure to create any missing tables. (Needed by addons that add stores to DB without specifying version)\n  });\n}\n\nexport interface SchemaDiff {\n  del: string[],\n  add: [string, TableSchema][];\n  change: TableSchemaDiff[];\n}\n\nexport interface TableSchemaDiff {\n  name: string,\n  recreate: boolean,\n  del: string[],\n  add: IndexSpec[],\n  change: IndexSpec[]\n}\n\nexport function getSchemaDiff(oldSchema: DbSchema, newSchema: DbSchema): SchemaDiff {\n  const diff: SchemaDiff = {\n    del: [], // Array of table names\n    add: [], // Array of [tableName, newDefinition]\n    change: [] // Array of {name: tableName, recreate: newDefinition, del: delIndexNames, add: newIndexDefs, change: changedIndexDefs}\n  };\n  let table: string;\n  for (table in oldSchema) {\n    if (!newSchema[table]) diff.del.push(table);\n  }\n  for (table in newSchema) {\n    const oldDef = oldSchema[table],\n      newDef = newSchema[table];\n    if (!oldDef) {\n      diff.add.push([table, newDef]);\n    } else {\n      const change = {\n        name: table,\n        def: newDef,\n        recreate: false,\n        del: [],\n        add: [],\n        change: []\n      };\n      if (oldDef.primKey.src !== newDef.primKey.src) {\n        // Primary key has changed. Remove and re-add table.\n        change.recreate = true;\n        diff.change.push(change);\n      } else {\n        // Same primary key. Just find out what differs:\n        const oldIndexes = oldDef.idxByName;\n        const newIndexes = newDef.idxByName;\n        let idxName: string;\n        for (idxName in oldIndexes) {\n          if (!newIndexes[idxName]) change.del.push(idxName);\n        }\n        for (idxName in newIndexes) {\n          const oldIdx = oldIndexes[idxName],\n            newIdx = newIndexes[idxName];\n          if (!oldIdx) change.add.push(newIdx);\n          else if (oldIdx.src !== newIdx.src) change.change.push(newIdx);\n        }\n        if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n          diff.change.push(change);\n        }\n      }\n    }\n  }\n  return diff;\n}\n\nexport function createTable(\n  idbtrans: IDBTransaction,\n  tableName: string,\n  primKey: IndexSpec,\n  indexes: IndexSpec[]\n) {\n  const store = idbtrans.db.createObjectStore(\n    tableName,\n    primKey.keyPath ?\n      { keyPath: primKey.keyPath, autoIncrement: primKey.auto } :\n      { autoIncrement: primKey.auto }\n  );\n  indexes.forEach(idx => addIndex(store, idx));\n  return store;\n}\n\nexport function createMissingTables(newSchema: DbSchema, idbtrans: IDBTransaction) {\n  keys(newSchema).forEach(tableName => {\n    if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n      createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n    }\n  });\n}\n\nexport function deleteRemovedTables(newSchema: DbSchema, idbtrans: IDBTransaction) {\n  for (var i = 0; i < idbtrans.db.objectStoreNames.length; ++i) {\n    var storeName = idbtrans.db.objectStoreNames[i];\n    if (newSchema[storeName] == null) {\n      idbtrans.db.deleteObjectStore(storeName);\n    }\n  }\n}\n\nexport function addIndex(store: IDBObjectStore, idx: IndexSpec) {\n  store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n}\n\nexport function readGlobalSchema(db: Dexie, idbdb: IDBDatabase, tmpTrans: IDBTransaction) {\n  db.verno = idbdb.version / 10;\n  const globalSchema = db._dbSchema = {};\n  const dbStoreNames = db._storeNames = slice(idbdb.objectStoreNames, 0);\n  if (dbStoreNames.length === 0) return; // Database contains no stores.\n  dbStoreNames.forEach(storeName => {\n    const store = tmpTrans.objectStore(storeName);\n    let keyPath = store.keyPath;\n    const primKey = createIndexSpec(nameFromKeyPath(keyPath), keyPath || \"\", false, false, !!store.autoIncrement, keyPath && typeof keyPath !== 'string');\n    const indexes: IndexSpec[] = [];\n    for (let j = 0; j < store.indexNames.length; ++j) {\n      const idbindex = store.index(store.indexNames[j]);\n      keyPath = idbindex.keyPath;\n      var index = createIndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== 'string');\n      indexes.push(index);\n    }\n    globalSchema[storeName] = createTableSchema(storeName, primKey, indexes);\n  });\n  setApiOnPlace(db, [db._allTables], keys(globalSchema), globalSchema);\n}\n\nexport function adjustToExistingIndexNames(db: Dexie, schema: DbSchema, idbtrans: IDBTransaction) {\n  // Issue #30 Problem with existing db - adjust to existing index names when migrating from non-dexie db\n  const storeNames = idbtrans.db.objectStoreNames;\n\n  for (let i = 0; i < storeNames.length; ++i) {\n    const storeName = storeNames[i];\n    const store = idbtrans.objectStore(storeName);\n    db._hasGetAll = 'getAll' in store;\n\n    for (let j = 0; j < store.indexNames.length; ++j) {\n      const indexName = store.indexNames[j];\n      const keyPath = store.index(indexName).keyPath;\n      const dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n      if (schema[storeName]) {\n        const indexSpec = schema[storeName].idxByName[dexieName];\n        if (indexSpec) indexSpec.name = indexName;\n      }\n    }\n  }\n\n  // Bug with getAll() on Safari ver<604 on Workers only, see discussion following PR #579\n  if (typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n    !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n    _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope &&\n    [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604)\n  {\n    db._hasGetAll = false;\n  }\n}\n\nexport function parseIndexSyntax(indexes: string): IndexSpec[] {\n  const rv = [];\n  indexes.split(',').forEach(index => {\n    index = index.trim();\n    const name = index.replace(/([&*]|\\+\\+)/g, \"\"); // Remove \"&\", \"++\" and \"*\"\n    // Let keyPath of \"[a+b]\" be [\"a\",\"b\"]:\n    const keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n\n    rv.push(createIndexSpec(\n      name,\n      keyPath || null,\n      /\\&/.test(index),\n      /\\*/.test(index),\n      /\\+\\+/.test(index),\n      isArray(keyPath)\n    ));\n  });\n  return rv;\n}\n","import { Version as IVersion } from '../../public/types/version';\nimport { DbSchema } from '../../public/types/db-schema';\nimport { extend, keys } from '../../functions/utils';\nimport { Dexie } from '../dexie';\nimport { Transaction } from '../transaction';\nimport { removeTablesApi, setApiOnPlace, parseIndexSyntax } from './schema-helpers';\nimport { exceptions } from '../../errors';\nimport { createTableSchema } from '../../helpers/table-schema';\n\n/** class Version\n * \n * http://dexie.org/docs/Version/Version\n */\nexport class Version implements IVersion {\n  db: Dexie;\n  _cfg: {\n    version: number,\n    storesSource: { [tableName: string]: string | null },\n    dbschema: DbSchema,\n    tables: {},\n    contentUpgrade: Function | null\n  }\n\n  _parseStoresSpec(stores: { [tableName: string]: string | null }, outSchema: DbSchema): any {\n    keys(stores).forEach(tableName => {\n      if (stores[tableName] !== null) {\n          var indexes = parseIndexSyntax(stores[tableName]);\n          var primKey = indexes.shift();\n          if (primKey.multi) throw new exceptions.Schema(\"Primary key cannot be multi-valued\");\n          indexes.forEach(idx => {\n              if (idx.auto) throw new exceptions.Schema(\"Only primary key can be marked as autoIncrement (++)\");\n              if (!idx.keyPath) throw new exceptions.Schema(\"Index must have a name and cannot be an empty string\");\n          });\n          outSchema[tableName] = createTableSchema(tableName, primKey, indexes);\n      }\n    });\n  }\n\n  stores(stores: { [key: string]: string; }): IVersion {\n    const db = this.db;\n    this._cfg.storesSource = this._cfg.storesSource ?\n      extend(this._cfg.storesSource, stores) :\n      stores;\n    const versions = db._versions;\n\n    // Derive stores from earlier versions if they are not explicitely specified as null or a new syntax.\n    const storesSpec: { [key: string]: string; } = {};\n    let dbschema = {};\n    versions.forEach(version => { // 'versions' is always sorted by lowest version first.\n      extend(storesSpec, version._cfg.storesSource);\n      dbschema = (version._cfg.dbschema = {});\n      version._parseStoresSpec(storesSpec, dbschema);\n    });\n    // Update the latest schema to this version\n    db._dbSchema = dbschema;\n    // Update APIs\n    removeTablesApi(db, [db._allTables, db, db.Transaction.prototype]);\n    setApiOnPlace(db, [db._allTables, db, db.Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n    db._storeNames = keys(dbschema);\n    return this;\n  }\n\n  upgrade(upgradeFunction: (trans: Transaction) => PromiseLike<any> | void): Version {\n    this._cfg.contentUpgrade = upgradeFunction;\n    return this;\n  }\n}\n","import Promise from './promise';\nimport { slice } from '../functions/utils';\nimport { eventRejectHandler } from '../functions/event-wrappers';\nimport { Dexie } from '../classes/dexie/dexie';\nimport { Table } from '../public/types/table';\nimport { nop } from '../functions/chaining-functions';\nimport { PromiseExtended } from '../public/types/promise-extended';\nimport { DBNAMES_DB } from '../globals/constants';\n\nexport let databaseEnumerator: DatabaseEnumerator;\n\nexport interface DatabaseEnumerator {\n  getDatabaseNames (): PromiseExtended<string[]>;\n  add (name: string): undefined | PromiseExtended;\n  remove (name: string): undefined | PromiseExtended;\n}\n\nexport function DatabaseEnumerator (indexedDB: IDBFactory & {getDatabaseNames?, webkitGetDatabaseNames?}) : DatabaseEnumerator {\n  const getDatabaseNamesNative = indexedDB && (indexedDB.getDatabaseNames || indexedDB.webkitGetDatabaseNames);\n  let dbNamesTable: Table<{name: string}, string>;\n\n  if (!getDatabaseNamesNative) {\n    const db = new Dexie (DBNAMES_DB, {addons: []});\n    db.version(1).stores({dbnames: 'name'});\n    dbNamesTable = db.table<{name: string}, string>('dbnames');\n  }\n\n  return {\n    getDatabaseNames () {\n      return getDatabaseNamesNative ? new Promise((resolve, reject) => {\n          const req = getDatabaseNamesNative.call(indexedDB);\n          req.onsuccess = event => resolve(slice(event.target.result, 0))\n          req.onerror = eventRejectHandler(reject);\n      }) : dbNamesTable.toCollection().primaryKeys();\n    },\n\n    add (name: string) : PromiseExtended<any> | undefined {\n      return !getDatabaseNamesNative && name !== DBNAMES_DB && dbNamesTable.put({name}).catch(nop);\n    },\n\n    remove (name: string) : PromiseExtended<any> | undefined {\n      return !getDatabaseNamesNative && name !== DBNAMES_DB && dbNamesTable.delete(name).catch(nop);\n    }\n  };\n}\n\nexport function initDatabaseEnumerator(indexedDB: IDBFactory) {\n  try {\n    databaseEnumerator = DatabaseEnumerator(indexedDB);\n  } catch (e) {}\n}\n\n","import { Dexie } from '../dexie';\nimport { makeClassConstructor } from '../../functions/make-class-constructor';\nimport { Version } from './version';\n\nexport interface VersionConstructor {\n  new(versionNumber: number): Version;\n  prototype: Version;\n}\n\n/** Generates a Version constructor bound to given Dexie instance.\n * \n * The purpose of having dynamically created constructors, is to allow\n * addons to extend classes for a certain Dexie instance without affecting\n * other db instances.\n */\nexport function createVersionConstructor(db: Dexie) {\n  return makeClassConstructor<VersionConstructor>(\n    Version.prototype,\n\n    function Version(this: Version, versionNumber: number) {\n      this.db = db;\n      this._cfg = {\n        version: versionNumber,\n        storesSource: null,\n        dbschema: {},\n        tables: {},\n        contentUpgrade: null\n      };\n    });\n\n}\n","import { newScope } from '../../helpers/promise';\nimport { PSD } from '../../helpers/promise';\n\nexport function vip (fn) {\n  // To be used by subscribers to the on('ready') event.\n  // This will let caller through to access DB even when it is blocked while the db.ready() subscribers are firing.\n  // This would have worked automatically if we were certain that the Provider was using Dexie.Promise for all asyncronic operations. The promise PSD\n  // from the provider.connect() call would then be derived all the way to when provider would call localDatabase.applyChanges(). But since\n  // the provider more likely is using non-promise async APIs or other thenable implementations, we cannot assume that.\n  // Note that this method is only useful for on('ready') subscribers that is returning a Promise from the event. If not using vip()\n  // the database could deadlock since it wont open until the returned Promise is resolved, and any non-VIPed operation started by\n  // the caller will not resolve until database is opened.\n  return newScope(function () {\n    PSD.letThrough = true; // Make sure we are let through if still blocking db due to onready is firing.\n    return fn();\n  });\n}\n\n","import { Dexie } from './dexie';\nimport * as Debug from '../../helpers/debug';\nimport { rejection } from '../../helpers/promise';\nimport { exceptions } from '../../errors';\nimport { eventRejectHandler, preventDefault } from '../../functions/event-wrappers';\nimport Promise, { wrap } from '../../helpers/promise';\nimport { connections } from '../../globals/constants';\nimport { runUpgraders, readGlobalSchema, adjustToExistingIndexNames } from '../version/schema-helpers';\nimport { safariMultiStoreFix } from '../../functions/quirks';\nimport { databaseEnumerator } from '../../helpers/database-enumerator';\nimport { vip } from './vip';\nimport { promisableChain, nop } from '../../functions/chaining-functions';\nimport { generateMiddlewareStacks } from './generate-middleware-stacks';\nimport { slice } from '../../functions/utils';\n\nexport function dexieOpen (db: Dexie) {\n  const state = db._state;\n  const {indexedDB} = db._deps;\n  if (state.isBeingOpened || db.idbdb)\n      return state.dbReadyPromise.then<Dexie>(() => state.dbOpenError ?\n        rejection (state.dbOpenError) :\n        db);\n  Debug.debug && (state.openCanceller._stackHolder = Debug.getErrorWithStack()); // Let stacks point to when open() was called rather than where new Dexie() was called.\n  state.isBeingOpened = true;\n  state.dbOpenError = null;\n  state.openComplete = false;\n  \n  // Function pointers to call when the core opening process completes.\n  let resolveDbReady = state.dbReadyResolve,\n      // upgradeTransaction to abort on failure.\n      upgradeTransaction: (IDBTransaction | null) = null;\n  \n  return Promise.race([state.openCanceller, new Promise((resolve, reject) => {\n      // Multiply db.verno with 10 will be needed to workaround upgrading bug in IE:\n      // IE fails when deleting objectStore after reading from it.\n      // A future version of Dexie.js will stopover an intermediate version to workaround this.\n      // At that point, we want to be backward compatible. Could have been multiplied with 2, but by using 10, it is easier to map the number to the real version number.\n      \n      // If no API, throw!\n      if (!indexedDB) throw new exceptions.MissingAPI(\n          \"indexedDB API not found. If using IE10+, make sure to run your code on a server URL \"+\n          \"(not locally). If using old Safari versions, make sure to include indexedDB polyfill.\");\n      const dbName = db.name;\n      \n      const req = state.autoSchema ?\n        indexedDB.open(dbName) :\n        indexedDB.open(dbName, Math.round(db.verno * 10));\n      if (!req) throw new exceptions.MissingAPI(\"IndexedDB API not available\"); // May happen in Safari private mode, see https://github.com/dfahlander/Dexie.js/issues/134\n      req.onerror = eventRejectHandler(reject);\n      req.onblocked = wrap(db._fireOnBlocked);\n      req.onupgradeneeded = wrap (e => {\n          upgradeTransaction = req.transaction;\n          if (state.autoSchema && !db._options.allowEmptyDB) { // Unless an addon has specified db._allowEmptyDB, lets make the call fail.\n              // Caller did not specify a version or schema. Doing that is only acceptable for opening alread existing databases.\n              // If onupgradeneeded is called it means database did not exist. Reject the open() promise and make sure that we\n              // do not create a new database by accident here.\n              req.onerror = preventDefault; // Prohibit onabort error from firing before we're done!\n              upgradeTransaction.abort(); // Abort transaction (would hope that this would make DB disappear but it doesnt.)\n              // Close database and delete it.\n              req.result.close();\n              const delreq = indexedDB.deleteDatabase(dbName); // The upgrade transaction is atomic, and javascript is single threaded - meaning that there is no risk that we delete someone elses database here!\n              delreq.onsuccess = delreq.onerror = wrap(() => {\n                  reject (new exceptions.NoSuchDatabase(`Database ${dbName} doesnt exist`));\n              });\n          } else {\n              upgradeTransaction.onerror = eventRejectHandler(reject);\n              var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion; // Safari 8 fix.\n              runUpgraders(db, oldVer / 10, upgradeTransaction, reject);\n          }\n      }, reject);\n      \n      req.onsuccess = wrap (() => {\n          // Core opening procedure complete. Now let's just record some stuff.\n          upgradeTransaction = null;\n          const idbdb = db.idbdb = req.result;\n\n          const objectStoreNames = slice(idbdb.objectStoreNames);\n          if (objectStoreNames.length > 0) try {\n            const tmpTrans = idbdb.transaction(safariMultiStoreFix(objectStoreNames), 'readonly');\n            if (state.autoSchema) readGlobalSchema(db, idbdb, tmpTrans);\n            else adjustToExistingIndexNames(db, db._dbSchema, tmpTrans);\n            generateMiddlewareStacks(db, tmpTrans);\n          } catch (e) {\n            // Safari 8 may bail out if > 1 store names. However, this shouldnt be a showstopper. Issue #120.\n            // BUGBUG: It will bail out anyway as of Dexie 3.\n            // Should we support Safari 8 anymore? Believe all\n            // Dexie users use the shim for that platform anyway?!\n            // If removing Safari 8 support, go ahead and remove the safariMultiStoreFix() function\n            // as well as absurd upgrade version quirk for Safari.\n          }\n          \n          connections.push(db); // Used for emulating versionchange event on IE/Edge/Safari.\n          \n          idbdb.onversionchange = wrap(ev => {\n              state.vcFired = true; // detect implementations that not support versionchange (IE/Edge/Safari)\n              db.on(\"versionchange\").fire(ev);\n          });\n          \n          databaseEnumerator.add(dbName);\n\n          resolve();\n\n      }, reject);\n  })]).then(() => {\n      // Before finally resolving the dbReadyPromise and this promise,\n      // call and await all on('ready') subscribers:\n      // Dexie.vip() makes subscribers able to use the database while being opened.\n      // This is a must since these subscribers take part of the opening procedure.\n      state.onReadyBeingFired = [];\n      return Promise.resolve(vip(db.on.ready.fire)).then(function fireRemainders() {\n          if (state.onReadyBeingFired.length > 0) {\n              // In case additional subscribers to db.on('ready') were added during the time db.on.ready.fire was executed.\n              let remainders = state.onReadyBeingFired.reduce(promisableChain, nop);\n              state.onReadyBeingFired = [];\n              return Promise.resolve(vip(remainders)).then(fireRemainders)\n          }\n      });\n  }).finally(()=>{\n      state.onReadyBeingFired = null;\n  }).then(()=>{\n      // Resolve the db.open() with the db instance.\n      state.isBeingOpened = false;\n      return db;\n  }).catch(err => {\n      try {\n          // Did we fail within onupgradeneeded? Make sure to abort the upgrade transaction so it doesnt commit.\n          upgradeTransaction && upgradeTransaction.abort();\n      } catch (e) { }\n      state.isBeingOpened = false; // Set before calling db.close() so that it doesnt reject openCanceller again (leads to unhandled rejection event).\n      db.close(); // Closes and resets idbdb, removes connections, resets dbReadyPromise and openCanceller so that a later db.open() is fresh.\n      // A call to db.close() may have made on-ready subscribers fail. Use dbOpenError if set, since err could be a follow-up error on that.\n      state.dbOpenError = err; // Record the error. It will be used to reject further promises of db operations.\n      return rejection (state.dbOpenError);\n  }).finally(()=>{\n      state.openComplete = true;\n      resolveDbReady(); // dbReadyPromise is resolved no matter if open() rejects or resolved. It's just to wake up waiters.\n  });\n}\n","import { isArray } from '../functions/utils';\n\nexport function awaitIterator (iterator: Iterator<any>) {\n  var callNext = result => iterator.next(result),\n      doThrow = error => iterator.throw(error),\n      onSuccess = step(callNext),\n      onError = step(doThrow);\n\n  function step(getNext: (any)=>any) {\n      return (val?) => {\n          var next = getNext(val),\n              value = next.value;\n\n          return next.done ? value :\n              (!value || typeof value.then !== 'function' ?\n                  isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) :\n                  value.then(onSuccess, onError));\n      };\n  }\n\n  return step(callNext)();\n}\n","import { TransactionMode } from '../../public/types/transaction-mode';\nimport { exceptions } from '../../errors';\nimport { flatten } from '../../functions/utils';\nimport { Dexie } from './dexie';\nimport { Transaction } from '../transaction';\nimport { awaitIterator } from '../../helpers/yield-support';\nimport Promise, {\n  PSD,\n  NativePromise,\n  decrementExpectedAwaits,\n  rejection,\n  incrementExpectedAwaits\n} from '../../helpers/promise';\n\nexport function extractTransactionArgs(mode: TransactionMode, _tableArgs_, scopeFunc) {\n  // Let table arguments be all arguments between mode and last argument.\n  var i = arguments.length;\n  if (i < 2) throw new exceptions.InvalidArgument(\"Too few arguments\");\n  // Prevent optimzation killer (https://github.com/petkaantonov/bluebird/wiki/Optimization-killers#32-leaking-arguments)\n  // and clone arguments except the first one into local var 'args'.\n  var args = new Array(i - 1);\n  while (--i) args[i - 1] = arguments[i];\n  // Let scopeFunc be the last argument and pop it so that args now only contain the table arguments.\n  scopeFunc = args.pop();\n  var tables = flatten(args); // Support using array as middle argument, or a mix of arrays and non-arrays.\n  return [mode, tables, scopeFunc];\n}\n\nexport function enterTransactionScope(\n  db: Dexie,\n  mode: IDBTransactionMode,\n  storeNames: string[],\n  parentTransaction: Transaction | undefined,\n  scopeFunc: ()=>PromiseLike<any> | any\n) {\n  return Promise.resolve().then(() => {\n    // Keep a pointer to last non-transactional PSD to use if someone calls Dexie.ignoreTransaction().\n    const transless = PSD.transless || PSD;\n    // Our transaction.\n    //return new Promise((resolve, reject) => {\n    const trans = db._createTransaction(mode, storeNames, db._dbSchema, parentTransaction);\n    // Let the transaction instance be part of a Promise-specific data (PSD) value.\n    const zoneProps = {\n      trans: trans,\n      transless: transless\n    };\n\n    if (parentTransaction) {\n      // Emulate transaction commit awareness for inner transaction (must 'commit' when the inner transaction has no more operations ongoing)\n      trans.idbtrans = parentTransaction.idbtrans;\n    } else {\n      trans.create(); // Create the backend transaction so that complete() or error() will trigger even if no operation is made upon it.\n    }\n\n    // Support for native async await.\n    incrementExpectedAwaits();\n\n    let returnValue;\n    const promiseFollowed = Promise.follow(() => {\n      // Finally, call the scope function with our table and transaction arguments.\n      returnValue = scopeFunc.call(trans, trans);\n      if (returnValue) {\n        if (returnValue.constructor === NativePromise) {\n          var decrementor = decrementExpectedAwaits.bind(null, null);\n          returnValue.then(decrementor, decrementor);\n        } else {\n          decrementExpectedAwaits();\n          if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n            // scopeFunc returned an iterator with throw-support. Handle yield as await.\n            returnValue = awaitIterator(returnValue);\n          }\n        }\n      } else {\n        decrementExpectedAwaits();\n      }\n    }, zoneProps);\n    return (returnValue && typeof returnValue.then === 'function' ?\n      // Promise returned. User uses promise-style transactions.\n      Promise.resolve(returnValue).then(x => trans.active ?\n        x // Transaction still active. Continue.\n        : rejection(new exceptions.PrematureCommit(\n          \"Transaction committed too early. See http://bit.ly/2kdckMn\")))\n      // No promise returned. Wait for all outstanding promises before continuing. \n      : promiseFollowed.then(() => returnValue)\n    ).then(x => {\n      // sub transactions don't react to idbtrans.oncomplete. We must trigger a completion:\n      if (parentTransaction) trans._resolve();\n      // wait for trans._completion\n      // (if root transaction, this means 'complete' event. If sub-transaction, we've just fired it ourselves)\n      return trans._completion.then(() => x);\n    }).catch(e => {\n      trans._reject(e); // Yes, above then-handler were maybe not called because of an unhandled rejection in scopeFunc!\n      return rejection(e);\n    });\n  });\n}\n","import { DBCore, DBCoreIndex, KeyRange, DBCoreQueryRequest, RangeType, DBCoreOpenCursorRequest, DBCoreCountRequest, DBCoreQuery, Key, DBCoreCursor, DBCoreTable } from '../public/types/dbcore';\n//import { DBCoreUp1, VirtualIndex, KeyPathQuery, DBCoreUp1Table } from '../public/types/dbcore-up-1';\nimport { isArray, flatten } from '../functions/utils';\nimport { getKeyExtractor } from './get-key-extractor';\nimport { exceptions } from '../errors';\nimport { getKeyPathAlias } from './dbcore-indexeddb';\nimport { Middleware } from '../public/types/middleware';\n\ninterface VirtualIndex extends DBCoreIndex {\n  /** True if this index is virtual, i.e. represents a compound index internally,\n   * but makes it act as as having a subset of its keyPaths.\n   */\n  isVirtual: boolean;\n\n  /** Number of keypaths that this index comprises. Can be 0..N.\n   * Note: This is the length of the *virtual index*, not the real index.\n   */\n  keyLength: number;\n\n  /** Number of popped keypaths from the real index.\n   */\n  keyTail: number;\n}\n\n// Move into some util:\nexport function pad (a: any | any[], value: any, count: number) {\n  const result = isArray(a) ? a.slice() : [a];\n  for (let i=0; i<count; ++i) result.push(value);\n  return result;\n}\n\n\nexport function createVirtualIndexMiddleware (down: DBCore) : DBCore {\n  return {\n    ...down,\n    table(tableName: string) {\n      const table = down.table(tableName);\n      const {schema} = table;\n      const indexLookup: {[indexAlias: string]: VirtualIndex[]} = {};\n      const allVirtualIndexes: VirtualIndex[] = [];\n\n      function addVirtualIndexes (keyPath: null | string | string[], keyTail: number, lowLevelIndex: DBCoreIndex): VirtualIndex {\n        const keyPathAlias = getKeyPathAlias(keyPath);\n        const indexList = (indexLookup[keyPathAlias] = indexLookup[keyPathAlias] || []);\n        const keyLength = keyPath == null ? 0: typeof keyPath === 'string' ? 1 : keyPath.length;\n        const isVirtual = keyTail > 0;\n        const virtualIndex = {\n          ...lowLevelIndex,\n          isVirtual,\n          isPrimaryKey: !isVirtual && lowLevelIndex.isPrimaryKey,\n          keyTail,\n          keyLength,\n          extractKey: getKeyExtractor(keyPath),\n          unique: !isVirtual && lowLevelIndex.unique\n        };\n        indexList.push(virtualIndex);\n        if (!virtualIndex.isPrimaryKey) {\n          allVirtualIndexes.push(virtualIndex);\n        }\n        if (keyLength > 1) {\n          const virtualKeyPath = keyLength === 2 ?\n            keyPath[0] : // This is a compound [a, b]. Add a virtual normal index a.\n            keyPath.slice(0, keyLength - 1); // This is compound [a,b,c]. Add virtual compound [a,b].\n          addVirtualIndexes(virtualKeyPath, keyTail + 1, lowLevelIndex);\n        }\n        indexList.sort((a,b) => a.keyTail - b.keyTail); // Shortest keyTail is the best one (represents real index)\n        return virtualIndex;\n      }\n    \n      const primaryKey = addVirtualIndexes(schema.primaryKey.keyPath, 0, schema.primaryKey);\n      indexLookup[\":id\"] = [primaryKey];\n      for (const index of schema.indexes) {\n        addVirtualIndexes(index.keyPath, 0, index);\n      }\n    \n      function findBestIndex(keyPath: null | string | string[]): VirtualIndex {\n        const result = indexLookup[getKeyPathAlias(keyPath)];\n        return result && result[0];\n      }\n    \n      function translateRange (range: KeyRange, keyTail: number): KeyRange {\n        return {\n          type: range.type === RangeType.Equal ?\n            RangeType.Range :\n            range.type,\n          lower: pad(range.lower, range.lowerOpen ? down.MAX_KEY : down.MIN_KEY, keyTail),\n          lowerOpen: true, // doesn't matter true or false\n          upper: pad(range.upper, range.upperOpen ? down.MIN_KEY : down.MAX_KEY, keyTail),\n          upperOpen: true // doesn't matter true or false\n        };\n      }\n    \n      function translateRequest (req: DBCoreQueryRequest): DBCoreQueryRequest;\n      function translateRequest (req: DBCoreOpenCursorRequest): DBCoreOpenCursorRequest;\n      function translateRequest (req: DBCoreCountRequest): DBCoreCountRequest {\n        const index = req.query.index as VirtualIndex;\n        return index.isVirtual ? {\n          ...req,\n          query: {\n            index,\n            range: translateRange(req.query.range, index.keyTail)\n          }\n        } : req;\n      }\n    \n      const result: DBCoreTable = {\n        ...table,\n        schema: {\n          ...schema,\n          primaryKey,\n          indexes: allVirtualIndexes,\n          getIndexByKeyPath: findBestIndex\n        },\n\n        count(req) {\n          return table.count(translateRequest(req));\n        },    \n    \n        query(req) {\n          return table.query(translateRequest(req));\n        },\n    \n        openCursor(req) {\n          const {keyTail, isVirtual, keyLength} = (req.query.index as VirtualIndex);\n          if (!isVirtual) return table.openCursor(req);\n    \n          function createVirtualCursor(cursor: DBCoreCursor) : DBCoreCursor {\n            function _continue (key?: Key) {\n              key != null ?\n                cursor.continue(pad(key, req.reverse ? down.MAX_KEY : down.MIN_KEY, keyTail)) :\n                req.unique ?\n                  cursor.continue(pad(cursor.key, req.reverse ? down.MIN_KEY : down.MAX_KEY, keyTail)) :\n                  cursor.continue()\n            }\n            const virtualCursor = Object.create(cursor, {\n              continue: {value: _continue},\n              continuePrimaryKey: {\n                value(key: Key, primaryKey: Key) {\n                  cursor.continuePrimaryKey(pad(key, down.MAX_KEY, keyTail), primaryKey);\n                }\n              },\n              key: {\n                get() {\n                  const key = cursor.key as Key[]; // A virtual cursor always operates on compound key\n                  return keyLength === 1 ?\n                    key[0] : // Cursor.key should not be an array.\n                    key.slice(0, keyLength); // Cursor.key should be first part of array.\n                }\n              },\n              value: {\n                get() {\n                  return cursor.value;\n                }\n              }\n            });\n            return virtualCursor;\n          }\n    \n          return table.openCursor(translateRequest(req))\n            .then(cursor => cursor && createVirtualCursor(cursor));\n        }\n      };\n      return result;\n    }\n  }\n}\n\nexport const virtualIndexMiddleware : Middleware<DBCore> = {\n  stack: \"dbcore\",\n  name: \"VirtualIndexMiddleware\",\n  level: 1,\n  create: createVirtualIndexMiddleware\n};\n\n","import { DBCore, DBCoreTable, MutateResponse, DeleteRangeRequest, AddRequest, PutRequest, DeleteRequest, DBCoreTransaction, KeyRange } from '../public/types/dbcore';\nimport { nop } from '../functions/chaining-functions';\nimport { tryCatch, getObjectDiff, setByKeyPath } from '../functions/utils';\nimport { PSD } from '../helpers/promise';\n//import { LockableTableMiddleware } from '../dbcore/lockable-table-middleware';\nimport { getEffectiveKeys, getExistingValues } from '../dbcore/get-effective-keys';\nimport { Middleware } from '../public/types/middleware';\nimport { Transaction } from '../classes/transaction';\n\nexport const hooksMiddleware: Middleware<DBCore>  = {\n  stack: \"dbcore\",\n  name: \"HooksMiddleware\",\n  level: 2,\n  create: (downCore: DBCore) => ({\n    ...downCore,\n    table(tableName: string) {\n      const downTable = downCore.table(tableName);\n      const {primaryKey} = downTable.schema;\n  \n      const tableMiddleware: DBCoreTable = {\n        ...downTable,\n        mutate(req):Promise<MutateResponse> {\n          const dxTrans = PSD.trans as Transaction;\n          // Hooks can be transaction-bound. Need to grab them from transaction.table and not\n          // db.table!\n          const {deleting, creating, updating} = dxTrans.table(tableName).hook;\n          switch (req.type) {\n            case 'add':\n              if (creating.fire === nop) break;\n              return dxTrans._promise('readwrite', ()=>addPutOrDelete(req), true);\n            case 'put':\n              if (creating.fire === nop && updating.fire === nop) break;\n              return dxTrans._promise('readwrite', ()=>addPutOrDelete(req), true);\n            case 'delete':\n              if (deleting.fire === nop) break;\n              return dxTrans._promise('readwrite', ()=>addPutOrDelete(req), true);\n            case 'deleteRange':\n              if (deleting.fire === nop) break;\n              return dxTrans._promise('readwrite', ()=>deleteRange(req), true);\n          }\n          // Any of the breaks above happened (no hooks) - do the default:\n          return downTable.mutate(req);\n\n\n          function addPutOrDelete(req: AddRequest | PutRequest | DeleteRequest): Promise<MutateResponse> {\n            const dxTrans = PSD.trans;\n            const keys = req.keys || getEffectiveKeys(primaryKey, req);\n            if (!keys) throw new Error(\"Keys missing\");\n            // Clone Request and set keys arg\n            req = req.type === 'add' || req.type === 'put' ?\n              {...req, keys, wantResults: true} : // Tell lower layer to deliver results. Hooks onsuccess needs it.\n              {...req};\n            if (req.type !== 'delete') req.values = [...req.values];\n            if (req.keys) req.keys = [...req.keys];\n  \n            return getExistingValues(downTable, req, keys).then (existingValues => {\n              const contexts = keys.map((key, i) => {\n                const existingValue = existingValues[i];\n                const ctx = { onerror: null, onsuccess: null };\n                if (req.type === 'delete') {\n                  // delete operation\n                  deleting.fire.call(ctx, key, existingValue, dxTrans);\n                } else if (req.type === 'add' || existingValue === undefined) {\n                  // The add() or put() resulted in a create\n                  const generatedPrimaryKey = creating.fire.call(ctx, key, req.values[i], dxTrans);\n                  if (key == null && generatedPrimaryKey != null) {\n                    key = generatedPrimaryKey;\n                    req.keys[i] = key;\n                    if (!primaryKey.outbound) {\n                      setByKeyPath(req.values[i], primaryKey.keyPath, key);\n                    }\n                  }\n                } else {\n                  // The put() operation resulted in an update\n                  const objectDiff = getObjectDiff(existingValue, req.values[i]);\n                  const additionalChanges = updating.fire.call(ctx, objectDiff, key, existingValue, dxTrans);\n                  if (additionalChanges) {\n                    const requestedValue = req.values[i];\n                    Object.keys(additionalChanges).forEach(keyPath => {\n                      setByKeyPath(requestedValue, keyPath, additionalChanges[keyPath]);\n                    });\n                  }\n                }\n                return ctx;\n              });\n              return downTable.mutate(req).then(({failures, results, numFailures, lastResult}) => {\n                for (let i=0; i<keys.length; ++i) {\n                  const primKey = results ? results[i] : keys[i];\n                  const ctx = contexts[i];\n                  if (primKey == null) {\n                    ctx.onerror && ctx.onerror(failures[i]);\n                  } else {\n                    ctx.onsuccess && ctx.onsuccess(\n                      req.type === 'put' && existingValues[i] ? // the put resulted in an update\n                        req.values[i] : // update hooks expects existing value\n                        primKey // create hooks expects primary key\n                    );\n                  }\n                }\n                return {failures, results, numFailures, lastResult};\n              }).catch(error => {\n                contexts.forEach(ctx => ctx.onerror && ctx.onerror(error));\n                return Promise.reject(error);\n              });\n            });\n          }\n  \n          function deleteRange(req: DeleteRangeRequest): Promise<MutateResponse> {\n            return deleteNextChunk(req.trans, req.range, 10000);\n          }\n  \n          function deleteNextChunk(trans: DBCoreTransaction, range: KeyRange, limit: number) {\n            // Query what keys in the DB within the given range\n            return downTable.query({trans, values: false, query: {index: primaryKey, range}, limit})\n            .then(({result}) => {\n              // Given a set of keys, bulk delete those using the same procedure as in addPutOrDelete().\n              // This will make sure that deleting hook is called.\n              return addPutOrDelete({type: 'delete', keys: result, trans}).then(res => {\n                if (res.numFailures > 0) return Promise.reject(res.failures[0]);\n                if (result.length < limit) {\n                  return {failures: [], numFailures: 0, lastResult: undefined} as MutateResponse;\n                } else {\n                  return deleteNextChunk(trans, {...range, lower: result[result.length - 1], lowerOpen: true}, limit);\n                }\n              });\n            })\n          }\n        }\n      };\n      //const {lock, lockableMiddleware} = LockableTableMiddleware(tableMiddleware);\n\n      return tableMiddleware;\n    },\n  }) as DBCore\n};\n","// Import types from the public API\nimport { Dexie as IDexie } from \"../../public/types/dexie\";\nimport { DexieOptions, DexieConstructor } from \"../../public/types/dexie-constructor\";\nimport { DbEvents } from \"../../public/types/db-events\";\n//import { PromiseExtended, PromiseExtendedConstructor } from '../../public/types/promise-extended';\nimport { Table as ITable } from '../../public/types/table';\nimport { TableSchema } from \"../../public/types/table-schema\";\nimport { DbSchema } from '../../public/types/db-schema';\n\n// Internal imports\nimport { Table, TableConstructor, createTableConstructor } from \"../table\";\nimport { Collection, CollectionConstructor, createCollectionConstructor } from '../collection';\nimport { WhereClause } from '../where-clause/where-clause';\nimport { WhereClauseConstructor, createWhereClauseConstructor } from '../where-clause/where-clause-constructor';\nimport { Transaction } from '../transaction';\nimport { TransactionConstructor, createTransactionConstructor } from '../transaction/transaction-constructor';\nimport { Version } from \"../version/version\";\nimport { VersionConstructor, createVersionConstructor } from '../version/version-constructor';\n\n// Other imports...\nimport { DexieEventSet } from '../../public/types/dexie-event-set';\nimport { DexieExceptionClasses } from '../../public/types/errors';\nimport { DexieDOMDependencies } from '../../public/types/dexie-dom-dependencies';\nimport { nop, promisableChain } from '../../functions/chaining-functions';\nimport Promise, { PSD } from '../../helpers/promise';\nimport { extend, override, keys, hasOwn } from '../../functions/utils';\nimport Events from '../../helpers/Events';\nimport { maxString, connections, READONLY, READWRITE } from '../../globals/constants';\nimport { getMaxKey } from '../../functions/quirks';\nimport { exceptions } from '../../errors';\nimport { lowerVersionFirst } from '../version/schema-helpers';\nimport { dexieOpen } from './dexie-open';\nimport { wrap } from '../../helpers/promise';\nimport { databaseEnumerator } from '../../helpers/database-enumerator';\nimport { eventRejectHandler } from '../../functions/event-wrappers';\nimport { extractTransactionArgs, enterTransactionScope } from './transaction-helpers';\nimport { TransactionMode } from '../../public/types/transaction-mode';\nimport { rejection } from '../../helpers/promise';\nimport { usePSD } from '../../helpers/promise';\nimport { DBCore } from '../../public/types/dbcore';\nimport { Middleware, DexieStacks } from '../../public/types/middleware';\nimport { virtualIndexMiddleware } from '../../dbcore/virtual-index-middleware';\nimport { hooksMiddleware } from '../../hooks/hooks-middleware';\nimport { IndexableType } from '../../public';\n\nexport interface DbReadyState {\n  dbOpenError: any;\n  isBeingOpened: boolean;\n  onReadyBeingFired: undefined | Function[];\n  openComplete: boolean;\n  dbReadyResolve: () => void;\n  dbReadyPromise: Promise<any>;\n  cancelOpen: (reason?: Error) => void;\n  openCanceller: Promise<any> & { _stackHolder?: Error };\n  autoSchema: boolean;\n  vcFired?: boolean;\n}\n\nexport class Dexie implements IDexie {\n  _options: DexieOptions;\n  _state: DbReadyState;\n  _versions: Version[];\n  _storeNames: string[];\n  _deps: DexieDOMDependencies;\n  _allTables: { [name: string]: Table; };\n  _createTransaction: (this: Dexie, mode: IDBTransactionMode, storeNames: ArrayLike<string>, dbschema: { [tableName: string]: TableSchema; }, parentTransaction?: Transaction) => Transaction;\n  _dbSchema: { [tableName: string]: TableSchema; };\n  _hasGetAll?: boolean;\n  _maxKey: IndexableType;\n  _fireOnBlocked: (ev: Event) => void;\n  _middlewares: {[StackName in keyof DexieStacks]?: Middleware<DexieStacks[StackName]>[]} = {};\n  core: DBCore;\n\n  name: string;\n  verno: number = 0;\n  idbdb: IDBDatabase | null;\n  on: DbEvents;\n\n  Table: TableConstructor;\n  WhereClause: WhereClauseConstructor;\n  Collection: CollectionConstructor;\n  Version: VersionConstructor;\n  Transaction: TransactionConstructor;\n\n  constructor(name: string, options?: DexieOptions) {\n    const deps = (Dexie as any as DexieConstructor).dependencies;\n    this._options = options = {\n      // Default Options\n      addons: (Dexie as any as DexieConstructor).addons, // Pick statically registered addons by default\n      autoOpen: true,                 // Don't require db.open() explicitely.\n      // Default DOM dependency implementations from static prop.\n      indexedDB: deps.indexedDB,      // Backend IndexedDB api. Default to browser env.\n      IDBKeyRange: deps.IDBKeyRange,  // Backend IDBKeyRange api. Default to browser env.\n      ...options\n    };\n    this._deps = {\n      indexedDB: options.indexedDB as IDBFactory,\n      IDBKeyRange: options.IDBKeyRange as typeof IDBKeyRange\n    };\n    const {\n      addons,\n    } = options;\n    this._dbSchema = {};\n    this._versions = [];\n    this._storeNames = [];\n    this._allTables = {};\n    this.idbdb = null;\n    const state: DbReadyState = {\n      dbOpenError: null,\n      isBeingOpened: false,\n      onReadyBeingFired: null,\n      openComplete: false,\n      dbReadyResolve: nop,\n      dbReadyPromise: null as Promise,\n      cancelOpen: nop,\n      openCanceller: null as Promise,\n      autoSchema: true\n    };\n    state.dbReadyPromise = new Promise(resolve => {\n      state.dbReadyResolve = resolve;\n    });\n    state.openCanceller = new Promise((_, reject) => {\n      state.cancelOpen = reject;\n    });\n    this._state = state;\n    this.name = name;\n    this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", { ready: [promisableChain, nop] }) as DbEvents;\n    this.on.ready.subscribe = override(this.on.ready.subscribe, subscribe => {\n      return (subscriber, bSticky) => {\n        (Dexie as any as DexieConstructor).vip(() => {\n          const state = this._state;\n          if (state.openComplete) {\n            // Database already open. Call subscriber asap.\n            if (!state.dbOpenError) Promise.resolve().then(subscriber);\n            // bSticky: Also subscribe to future open sucesses (after close / reopen) \n            if (bSticky) subscribe(subscriber);\n          } else if (state.onReadyBeingFired) {\n            // db.on('ready') subscribers are currently being executed and have not yet resolved or rejected\n            state.onReadyBeingFired.push(subscriber);\n            if (bSticky) subscribe(subscriber);\n          } else {\n            // Database not yet open. Subscribe to it.\n            subscribe(subscriber);\n            // If bSticky is falsy, make sure to unsubscribe subscriber when fired once.\n            const db = this;\n            if (!bSticky) subscribe(function unsubscribe() {\n              db.on.ready.unsubscribe(subscriber);\n              db.on.ready.unsubscribe(unsubscribe);\n            });\n          }\n        });\n      }\n    });\n\n    // Create derived classes bound to this instance of Dexie:\n    this.Collection = createCollectionConstructor(this);\n    this.Table = createTableConstructor(this);\n    this.Transaction = createTransactionConstructor(this);\n    this.Version = createVersionConstructor(this);\n    this.WhereClause = createWhereClauseConstructor(this);\n\n    // Default subscribers to \"versionchange\" and \"blocked\".\n    // Can be overridden by custom handlers. If custom handlers return false, these default\n    // behaviours will be prevented.\n    this.on(\"versionchange\", ev => {\n      // Default behavior for versionchange event is to close database connection.\n      // Caller can override this behavior by doing db.on(\"versionchange\", function(){ return false; });\n      // Let's not block the other window from making it's delete() or open() call.\n      // NOTE! This event is never fired in IE,Edge or Safari.\n      if (ev.newVersion > 0)\n        console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`);\n      else\n        console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`);\n      this.close();\n      // In many web applications, it would be recommended to force window.reload()\n      // when this event occurs. To do that, subscribe to the versionchange event\n      // and call window.location.reload(true) if ev.newVersion > 0 (not a deletion)\n      // The reason for this is that your current web app obviously has old schema code that needs\n      // to be updated. Another window got a newer version of the app and needs to upgrade DB but\n      // your window is blocking it unless we close it here.\n    });\n    this.on(\"blocked\", ev => {\n      if (!ev.newVersion || ev.newVersion < ev.oldVersion)\n        console.warn(`Dexie.delete('${this.name}') was blocked`);\n      else\n        console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${ev.oldVersion / 10}`);\n    });\n\n    this._maxKey = getMaxKey(options.IDBKeyRange as typeof IDBKeyRange);\n\n    this._createTransaction = (\n      mode: IDBTransactionMode,\n      storeNames: string[],\n      dbschema: DbSchema,\n      parentTransaction?: Transaction) => new this.Transaction(mode, storeNames, dbschema, parentTransaction);\n\n    this._fireOnBlocked = ev => {\n      this.on(\"blocked\").fire(ev);\n      // Workaround (not fully*) for missing \"versionchange\" event in IE,Edge and Safari:\n      connections\n        .filter(c => c.name === this.name && c !== this && !c._state.vcFired)\n        .map(c => c.on(\"versionchange\").fire(ev));\n    }\n\n    // Default middlewares:\n    this.use(virtualIndexMiddleware);\n    this.use(hooksMiddleware);\n\n    // Call each addon:\n    addons.forEach(addon => addon(this));\n  }\n\n  version(versionNumber: number): Version {\n    versionNumber = Math.round(versionNumber * 10) / 10;\n    if (this.idbdb || this._state.isBeingOpened)\n      throw new exceptions.Schema(\"Cannot add version when database is open\");\n    this.verno = Math.max(this.verno, versionNumber);\n    const versions = this._versions;\n    var versionInstance = versions.filter(\n      v => v._cfg.version === versionNumber)[0];\n    if (versionInstance) return versionInstance;\n    versionInstance = new this.Version(versionNumber);\n    versions.push(versionInstance);\n    versions.sort(lowerVersionFirst);\n    versionInstance.stores({}); // Derive earlier schemas by default.\n    // Disable autoschema mode, as at least one version is specified.\n    this._state.autoSchema = false;\n    return versionInstance;\n  }\n\n  _whenReady<T>(fn: () => Promise<T>): Promise<T> {\n    return this._state.openComplete || PSD.letThrough ? fn() : new Promise<T>((resolve, reject) => {\n      if (!this._state.isBeingOpened) {\n        if (!this._options.autoOpen) {\n          reject(new exceptions.DatabaseClosed());\n          return;\n        }\n        this.open().catch(nop); // Open in background. If if fails, it will be catched by the final promise anyway.\n      }\n      this._state.dbReadyPromise.then(resolve, reject);\n    }).then(fn);\n  }\n\n  use({stack, create, level, name}: Middleware<DBCore>): this {\n    if (name) this.unuse({stack, name}); // Be able to replace existing middleware.\n    const middlewares = this._middlewares[stack] || (this._middlewares[stack] = []);\n    middlewares.push({stack, create, level: level == null ? 10 : level, name});\n    middlewares.sort((a, b) => a.level - b.level);\n    // Todo update db.core and db.tables...core ? Or should be expect this to have effect\n    // only after next open()?\n    return this;\n  }\n\n  unuse({stack, create}: Middleware<{stack: keyof DexieStacks}>): this;\n  unuse({stack, name}: {stack: keyof DexieStacks, name: string}): this;\n  unuse({stack, name, create}: {stack: keyof DexieStacks, name?: string, create?: Function}) {\n    if (stack && this._middlewares[stack]) {\n      this._middlewares[stack] = this._middlewares[stack].filter(mw =>\n        create ? mw.create !== create : // Given middleware has a create method. Match that exactly.\n        name ? mw.name !== name : // Given middleware spec \n        false);\n    }\n    return this;\n  }\n\n  open() {\n    return dexieOpen(this);\n  }\n\n  close(): void {\n    const idx = connections.indexOf(this),\n      state = this._state;\n    if (idx >= 0) connections.splice(idx, 1);\n    if (this.idbdb) {\n      try { this.idbdb.close(); } catch (e) { }\n      this.idbdb = null;\n    }\n    this._options.autoOpen = false;\n    state.dbOpenError = new exceptions.DatabaseClosed();\n    if (state.isBeingOpened)\n      state.cancelOpen(state.dbOpenError);\n\n    // Reset dbReadyPromise promise:\n    state.dbReadyPromise = new Promise(resolve => {\n      state.dbReadyResolve = resolve;\n    });\n    state.openCanceller = new Promise((_, reject) => {\n      state.cancelOpen = reject;\n    });\n  }\n\n  delete(): Promise<void> {\n    const hasArguments = arguments.length > 0;\n    const state = this._state;\n    return new Promise((resolve, reject) => {\n      const doDelete = () => {\n        this.close();\n        var req = this._deps.indexedDB.deleteDatabase(this.name);\n        req.onsuccess = wrap(() => {\n          databaseEnumerator.remove(this.name);\n          resolve();\n        });\n        req.onerror = eventRejectHandler(reject);\n        req.onblocked = this._fireOnBlocked;\n      }\n\n      if (hasArguments) throw new exceptions.InvalidArgument(\"Arguments not allowed in db.delete()\");\n      if (state.isBeingOpened) {\n        state.dbReadyPromise.then(doDelete);\n      } else {\n        doDelete();\n      }\n    });\n  }\n\n  backendDB() {\n    return this.idbdb;\n  }\n\n  isOpen() {\n    return this.idbdb !== null;\n  }\n\n  hasBeenClosed() {\n    const dbOpenError = this._state.dbOpenError;\n    return dbOpenError && (dbOpenError.name === 'DatabaseClosed');\n  }\n\n  hasFailed() {\n    return this._state.dbOpenError !== null;\n  }\n\n  dynamicallyOpened() {\n    return this._state.autoSchema;\n  }\n\n  get tables () {\n    return keys(this._allTables).map(name => this._allTables[name]);\n  }\n\n  transaction(): Promise {\n    const args = extractTransactionArgs.apply(this, arguments);\n    return this._transaction.apply(this, args);\n  }\n\n  _transaction(mode: TransactionMode, tables: Array<ITable | string>, scopeFunc: Function) {\n    let parentTransaction = PSD.trans as Transaction | undefined;\n    // Check if parent transactions is bound to this db instance, and if caller wants to reuse it\n    if (!parentTransaction || parentTransaction.db !== this || mode.indexOf('!') !== -1) parentTransaction = null;\n    const onlyIfCompatible = mode.indexOf('?') !== -1;\n    mode = mode.replace('!', '').replace('?', '') as TransactionMode; // Ok. Will change arguments[0] as well but we wont touch arguments henceforth.\n    let idbMode: IDBTransactionMode,\n        storeNames;\n\n    try {\n        //\n        // Get storeNames from arguments. Either through given table instances, or through given table names.\n        //\n        storeNames = tables.map(table => {\n            var storeName = table instanceof this.Table ? table.name : table;\n            if (typeof storeName !== 'string') throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n            return storeName;\n        });\n\n        //\n        // Resolve mode. Allow shortcuts \"r\" and \"rw\".\n        //\n        if (mode == \"r\" || mode === READONLY)\n          idbMode = READONLY;\n        else if (mode == \"rw\" || mode == READWRITE)\n          idbMode = READWRITE;\n        else\n            throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n\n        if (parentTransaction) {\n            // Basic checks\n            if (parentTransaction.mode === READONLY && idbMode === READWRITE) {\n                if (onlyIfCompatible) {\n                    // Spawn new transaction instead.\n                    parentTransaction = null; \n                }\n                else throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n            }\n            if (parentTransaction) {\n                storeNames.forEach(storeName => {\n                    if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                        if (onlyIfCompatible) {\n                            // Spawn new transaction instead.\n                            parentTransaction = null; \n                        }\n                        else throw new exceptions.SubTransaction(\"Table \" + storeName +\n                            \" not included in parent transaction.\");\n                    }\n                });\n            }\n            if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n                // '?' mode should not keep using an inactive transaction.\n                parentTransaction = null;\n            }\n        }\n    } catch (e) {\n        return parentTransaction ?\n            parentTransaction._promise(null, (_, reject) => {reject(e);}) :\n            rejection (e);\n    }\n    // If this is a sub-transaction, lock the parent and then launch the sub-transaction.\n    const enterTransaction = enterTransactionScope.bind(null, this, idbMode, storeNames, parentTransaction, scopeFunc);\n    return (parentTransaction ?\n        parentTransaction._promise(idbMode, enterTransaction, \"lock\") :\n        PSD.trans ?\n            // no parent transaction despite PSD.trans exists. Make sure also\n            // that the zone we create is not a sub-zone of current, because\n            // Promise.follow() should not wait for it if so.\n            usePSD(PSD.transless, ()=>this._whenReady(enterTransaction)) :\n            this._whenReady (enterTransaction));\n  }\n\n  table(tableName: string): Table;\n  table<T, TKey extends IndexableType=IndexableType>(tableName: string): ITable<T, TKey>;\n  table(tableName: string): Table {\n    if (!hasOwn(this._allTables, tableName)) {\n      throw new exceptions.InvalidTable(`Table ${tableName} does not exist`); }\n    return this._allTables[tableName];\n  }\n}\n","import { Dexie as _Dexie } from './dexie';\nimport { props, derive, extend, override, getByKeyPath, setByKeyPath, delByKeyPath, shallowClone, deepClone, getObjectDiff, asap, _global } from '../../functions/utils';\nimport { fullNameExceptions } from '../../errors';\nimport { DexieConstructor } from '../../public/types/dexie-constructor';\nimport { DatabaseEnumerator, databaseEnumerator } from '../../helpers/database-enumerator';\nimport { PSD } from '../../helpers/promise';\nimport { usePSD } from '../../helpers/promise';\nimport { newScope } from '../../helpers/promise';\nimport { rejection } from '../../helpers/promise';\nimport { awaitIterator } from '../../helpers/yield-support';\nimport Promise from '../../helpers/promise';\nimport * as Debug from '../../helpers/debug';\nimport { dexieStackFrameFilter, minKey, connections, DEXIE_VERSION } from '../../globals/constants';\nimport Events from '../../helpers/Events';\nimport { exceptions } from '../../errors';\nimport { errnames } from '../../errors';\nimport { getMaxKey } from '../../functions/quirks';\nimport { vip } from './vip';\n\n/* (Dexie) is an instance of DexieConstructor, as defined in public/types/dexie-constructor.d.ts\n*  (new Dexie()) is an instance of Dexie, as defined in public/types/dexie.d.ts\n* \n* Why we're doing this?\n\n* Because we've choosen to define the public Dexie API using a DexieConstructor interface\n* rather than declaring a class. On that interface, all static props are defined.\n* In practice, class Dexie's constructor implements DexieConstructor and all member props\n* are defined in interface Dexie. We could say, it's a typescript limitation of not being\n* able to define a static interface that forces us to do the cast below.\n*/\nconst Dexie = _Dexie as any as DexieConstructor;\n\n//\n// Set all static methods and properties onto Dexie:\n// \nprops(Dexie, {\n\n  // Dexie.BulkError = class BulkError {...};\n  // Dexie.XXXError = class XXXError {...};\n  ...fullNameExceptions,\n\n  //\n  // Static delete() method.\n  //\n  delete(databaseName: string) {\n    const db = new Dexie(databaseName);\n    return db.delete();\n  },\n\n  //\n  // Static exists() method.\n  //\n  exists(name: string) {\n    return new Dexie(name, { addons: [] }).open().then(db => {\n      db.close();\n      return true;\n    }).catch('NoSuchDatabaseError', () => false);\n  },\n\n  //\n  // Static method for retrieving a list of all existing databases at current host.\n  //\n  getDatabaseNames(cb) {\n    return databaseEnumerator ?\n      databaseEnumerator.getDatabaseNames().then(cb) :\n      Promise.resolve([]);\n  },\n\n  /** @deprecated */\n  defineClass() {\n    function Class(content) {\n      extend(this, content);\n    }\n    return Class;\n  },\n\n  ignoreTransaction(scopeFunc) {\n    // In case caller is within a transaction but needs to create a separate transaction.\n    // Example of usage:\n    //\n    // Let's say we have a logger function in our app. Other application-logic should be unaware of the\n    // logger function and not need to include the 'logentries' table in all transaction it performs.\n    // The logging should always be done in a separate transaction and not be dependant on the current\n    // running transaction context. Then you could use Dexie.ignoreTransaction() to run code that starts a new transaction.\n    //\n    //     Dexie.ignoreTransaction(function() {\n    //         db.logentries.add(newLogEntry);\n    //     });\n    //\n    // Unless using Dexie.ignoreTransaction(), the above example would try to reuse the current transaction\n    // in current Promise-scope.\n    //\n    // An alternative to Dexie.ignoreTransaction() would be setImmediate() or setTimeout(). The reason we still provide an\n    // API for this because\n    //  1) The intention of writing the statement could be unclear if using setImmediate() or setTimeout().\n    //  2) setTimeout() would wait unnescessary until firing. This is however not the case with setImmediate().\n    //  3) setImmediate() is not supported in the ES standard.\n    //  4) You might want to keep other PSD state that was set in a parent PSD, such as PSD.letThrough.\n    return PSD.trans ?\n      usePSD(PSD.transless, scopeFunc) : // Use the closest parent that was non-transactional.\n      scopeFunc(); // No need to change scope because there is no ongoing transaction.\n  },\n\n  vip,\n\n  async: function (generatorFn: Function) {\n    return function () {\n      try {\n        var rv = awaitIterator(generatorFn.apply(this, arguments));\n        if (!rv || typeof rv.then !== 'function')\n          return Promise.resolve(rv);\n        return rv;\n      } catch (e) {\n        return rejection(e);\n      }\n    };\n  },\n\n  spawn: function (generatorFn, args, thiz) {\n    try {\n      var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n      if (!rv || typeof rv.then !== 'function')\n        return Promise.resolve(rv);\n      return rv;\n    } catch (e) {\n      return rejection(e);\n    }\n  },\n\n  // Dexie.currentTransaction property\n  currentTransaction: {\n    get: () => PSD.trans || null\n  },\n\n  waitFor: function (promiseOrFunction, optionalTimeout) {\n    // If a function is provided, invoke it and pass the returning value to Transaction.waitFor()\n    const promise = Promise.resolve(\n      typeof promiseOrFunction === 'function' ?\n        Dexie.ignoreTransaction(promiseOrFunction) :\n        promiseOrFunction)\n      .timeout(optionalTimeout || 60000); // Default the timeout to one minute. Caller may specify Infinity if required.       \n\n    // Run given promise on current transaction. If no current transaction, just return a Dexie promise based\n    // on given value.\n    return PSD.trans ?\n      PSD.trans.waitFor(promise) :\n      promise;\n  },\n\n  // Export our Promise implementation since it can be handy as a standalone Promise implementation\n  Promise: Promise,\n\n  // Dexie.debug proptery:\n  // Dexie.debug = false\n  // Dexie.debug = true\n  // Dexie.debug = \"dexie\" - don't hide dexie's stack frames.\n  debug: {\n    get: () => Debug.debug,\n    set: value => {\n      Debug.setDebug(value, value === 'dexie' ? () => true : dexieStackFrameFilter);\n    }\n  },\n\n  // Export our derive/extend/override methodology\n  derive: derive, // Deprecate?\n  extend: extend, // Deprecate?\n  props: props,\n  override: override, // Deprecate?\n  // Export our Events() function - can be handy as a toolkit\n  Events: Events,\n  // Utilities\n  getByKeyPath: getByKeyPath,\n  setByKeyPath: setByKeyPath,\n  delByKeyPath: delByKeyPath,\n  shallowClone: shallowClone,\n  deepClone: deepClone,\n  getObjectDiff: getObjectDiff,\n  asap: asap,\n  //maxKey: new Dexie('',{addons:[]})._maxKey,\n  minKey: minKey,\n  // Addon registry\n  addons: [],\n  // Global DB connection list\n  connections: connections,\n\n  //MultiModifyError: exceptions.Modify, // Obsolete!\n  errnames: errnames,\n\n  // Export other static classes\n  //IndexSpec: IndexSpec, Obsolete!\n  //TableSchema: TableSchema, Obsolete!\n\n  //\n  // Dependencies\n  //\n  // These will automatically work in browsers with indexedDB support, or where an indexedDB polyfill has been included.\n  //\n  // In node.js, however, these properties must be set \"manually\" before instansiating a new Dexie().\n  // For node.js, you need to require indexeddb-js or similar and then set these deps.\n  //\n  dependencies: (()=>{\n    try {\n      return {\n        // Required:\n        indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n        IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n      };\n    } catch (e) {\n      return {indexedDB: null, IDBKeyRange: null};\n    }\n  })(),\n\n  // API Version Number: Type Number, make sure to always set a version number that can be comparable correctly. Example: 0.9, 0.91, 0.92, 1.0, 1.01, 1.1, 1.2, 1.21, etc.\n  semVer: DEXIE_VERSION,\n  version: DEXIE_VERSION.split('.')\n    .map(n => parseInt(n))\n    .reduce((p, c, i) => p + (c / Math.pow(10, i * 2))),\n\n  // https://github.com/dfahlander/Dexie.js/issues/186\n  // typescript compiler tsc in mode ts-->es5 & commonJS, will expect require() to return\n  // x.default. Workaround: Set Dexie.default = Dexie.\n  default: Dexie,\n  // Make it possible to import {Dexie} (non-default import)\n  // Reason 1: May switch to that in future.\n  // Reason 2: We declare it both default and named exported in d.ts to make it possible\n  // to let addons extend the Dexie interface with Typescript 2.1 (works only when explicitely\n  // exporting the symbol, not just default exporting)\n  Dexie: Dexie\n});\n\nDexie.maxKey = getMaxKey(Dexie.dependencies.IDBKeyRange);\n","export enum IndexType {\r\n  String = \"string\",\r\n  Number = \"number\",\r\n  Date = \"Date\",\r\n}\r\n\r\nexport interface RefinerDBConfig {\r\n  indexDelay?: number;\r\n  itemsIndexSchema?: string;\r\n  onTransition?: (state: IndexState) => void;\r\n  useWebWorkers?: boolean;\r\n}\r\n\r\nexport enum IndexState {\r\n  IDLE = \"idle\",\r\n  STALE = \"stale\",\r\n  PENDING = \"pending\",\r\n  QUERYING = \"querying\",\r\n  FAILED = \"error\",\r\n}\r\n\r\nexport enum IndexEvent {\r\n  INDEX_START = \"index:start\",\r\n  INVALIDATE = \"index:invalidate\",\r\n  RETRY = \"index:retry\",\r\n  QUERY_START = \"query:start\",\r\n}\r\n\r\nexport interface IndexFilter {\r\n  indexKey: string;\r\n  indexDefinition?: IndexConfig;\r\n  values?: string[] | number[];\r\n  min?: string | number | Date;\r\n  max?: string | number | Date;\r\n}\r\n\r\nexport type MinMaxFilterValue = { min?: number | Date | string; max?: number | Date | string };\r\nexport type StringFilterValue = string | string[];\r\nexport type NumberFilterValue = number | number[];\r\n\r\nexport interface Filter {\r\n  [key: string]: MinMaxFilterValue | StringFilterValue | NumberFilterValue;\r\n}\r\n\r\nexport interface RefinerOption {\r\n  key: string;\r\n  count: number;\r\n}\r\n\r\nexport interface IndexConfig {\r\n  key: string;\r\n  type: IndexType;\r\n  hashFn: (item: any) => any;\r\n  skipRefinerOptions?: boolean;\r\n}\r\n\r\nexport interface SearchIndex extends IndexConfig {\r\n  value?: {\r\n    [key: string]: number[];\r\n  };\r\n  sortedKeys?: any[];\r\n}\r\n\r\nexport interface IndexConfig {\r\n  key: string;\r\n  type: IndexType;\r\n  hashFn: (item: any) => any;\r\n  skipRefinerOptions?: boolean;\r\n}\r\n\r\nexport interface QueryCriteria {\r\n  filter: Filter;\r\n  sort?: string;\r\n  sortDir?: \"asc\" | \"desc\";\r\n  limit?: number;\r\n  skip?: number;\r\n  includeRefiners?: boolean;\r\n}\r\n\r\nexport interface FilterResult {\r\n  indexKey: string;\r\n  key: string;\r\n  matches: number[];\r\n}\r\nexport interface QueryResult {\r\n  key: string;\r\n  items: any[];\r\n  refiners: {\r\n    [key: string]: RefinerOption[];\r\n  };\r\n  totalCount: number;\r\n}\r\n","import { IndexType, SearchIndex, IndexConfig } from \"../interfaces\";\r\n\r\nexport function indexValues(hashValues: string[] | number[], primaryKey, index: SearchIndex) {\r\n  if (!index.value) index.value = {};\r\n  hashValues.forEach((hash) => {\r\n    if (hash === undefined) return;\r\n    if (!index.value[hash]) {\r\n      index.value[hash] = [];\r\n      if (!index.sortedKeys) index.sortedKeys = [];\r\n      index.sortedKeys.push(hash);\r\n    }\r\n    index.value[hash].push(primaryKey);\r\n  });\r\n  return index;\r\n}\r\n\r\nfunction indexString(item, primaryKey: number, index: SearchIndex) {\r\n  let hashValues = index.hashFn(item);\r\n  if (typeof hashValues === \"string\") {\r\n    hashValues = [hashValues];\r\n  }\r\n  return indexValues(hashValues.filter(Boolean), primaryKey, index);\r\n}\r\n\r\nfunction indexNumber(item, primaryKey: number, index: SearchIndex) {\r\n  let hashValues = index.hashFn(item);\r\n  if (!Array.isArray(hashValues)) {\r\n    hashValues = [hashValues];\r\n  }\r\n  hashValues = hashValues\r\n    .map((hash) => {\r\n      if (typeof hash === \"string\") {\r\n        hash = parseFloat(hash);\r\n      }\r\n      return hash;\r\n    })\r\n    .filter((hash) => !isNaN(hash));\r\n  return indexValues(hashValues, primaryKey, index);\r\n}\r\n\r\nfunction indexDate(item, primaryKey: number, index: SearchIndex) {\r\n  try {\r\n    let date = index.hashFn(item);\r\n    if (typeof date === \"string\") {\r\n      date = new Date(date);\r\n    }\r\n    let hash = date.toISOString();\r\n    return indexValues([hash], primaryKey, index);\r\n  } catch (err) {\r\n    return indexValues([], primaryKey, index);\r\n  }\r\n}\r\n\r\nexport const indexers = {\r\n  [IndexType.String]: indexString,\r\n  [IndexType.Number]: indexNumber,\r\n  [IndexType.Date]: indexDate,\r\n};\r\n\r\nexport function checkIfModifiedIndexes(current: IndexConfig[], next: IndexConfig[]): boolean {\r\n  return JSON.stringify(current) !== JSON.stringify(next);\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n\n  return ar;\n}\n\nexport { __assign, __read, __rest, __spread, __values };","var STATE_DELIMITER = '.';\nvar EMPTY_ACTIVITY_MAP = {};\nvar DEFAULT_GUARD_TYPE = 'xstate.guard';\nvar TARGETLESS_KEY = '';\nexport { DEFAULT_GUARD_TYPE, EMPTY_ACTIVITY_MAP, STATE_DELIMITER, TARGETLESS_KEY };","var IS_PRODUCTION = process.env.NODE_ENV === 'production';\nexport { IS_PRODUCTION };","import { __spread, __values, __read, __assign } from './_virtual/_tslib.js';\nimport { DEFAULT_GUARD_TYPE, TARGETLESS_KEY, STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\n\nfunction keys(value) {\n  return Object.keys(value);\n}\n\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\n\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\" + event : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\n\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n  }\n}\n\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\n\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\n\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\n\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\n\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = __values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\n\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\n\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, __spread(array));\n}\n\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\n\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\n\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\n\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\n\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = __read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\n\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\n\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\n\nfunction updateContext(context, _event, assignActions, state) {\n  if (!IS_PRODUCTION) {\n    warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = __values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\n\nvar warn = function () {};\n\nif (!IS_PRODUCTION) {\n  warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \" + message];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\n\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nfunction isString(value) {\n  return typeof value === 'string';\n} // export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\n\n\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\n\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\n\nvar symbolObservable =\n/*#__PURE__*/\nfunction () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n\nfunction isMachine(value) {\n  try {\n    return '__xstatenode' in value;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar uniqueId =\n/*#__PURE__*/\nfunction () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\n\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return __assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\n\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return __assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\n\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      // @ts-ignore until Type instantiation is excessively deep and possibly infinite bug is fixed\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return __assign(__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\n\nfunction normalizeTarget(target) {\n  if (target === undefined || target === TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\n\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\" + originalError.stack + \"'\" : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\" + currentError.stack + \"'\" : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" + (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n    }\n  }\n}\n\nexport { flatten, getEventType, isArray, isBuiltInEvent, isFunction, isMachine, isObservable, isPromiseLike, isStateLike, isString, keys, mapContext, mapFilterValues, mapValues, matchesState, nestedPath, normalizeTarget, partition, path, pathToStateValue, reportUnhandledExceptionOnInvocation, symbolObservable, toArray, toArrayStrict, toEventObject, toGuard, toSCXMLEvent, toStatePath, toStatePaths, toStateValue, toTransitionConfigArray, uniqueId, updateContext, updateHistoryStates, updateHistoryValue, warn };","import { __values } from './_virtual/_tslib.js';\nimport { keys, matchesState } from './utils.js';\n\nfunction mapState(stateMap, stateId) {\n  var e_1, _a;\n\n  var foundStateId;\n\n  try {\n    for (var _b = __values(keys(stateMap)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var mappedStateId = _c.value;\n\n      if (matchesState(mappedStateId, stateId) && (!foundStateId || stateId.length > foundStateId.length)) {\n        foundStateId = mappedStateId;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return stateMap[foundStateId];\n}\n\nexport { mapState };","var ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[\"Start\"] = \"xstate.start\";\n  ActionTypes[\"Stop\"] = \"xstate.stop\";\n  ActionTypes[\"Raise\"] = \"xstate.raise\";\n  ActionTypes[\"Send\"] = \"xstate.send\";\n  ActionTypes[\"Cancel\"] = \"xstate.cancel\";\n  ActionTypes[\"NullEvent\"] = \"\";\n  ActionTypes[\"Assign\"] = \"xstate.assign\";\n  ActionTypes[\"After\"] = \"xstate.after\";\n  ActionTypes[\"DoneState\"] = \"done.state\";\n  ActionTypes[\"DoneInvoke\"] = \"done.invoke\";\n  ActionTypes[\"Log\"] = \"xstate.log\";\n  ActionTypes[\"Init\"] = \"xstate.init\";\n  ActionTypes[\"Invoke\"] = \"xstate.invoke\";\n  ActionTypes[\"ErrorExecution\"] = \"error.execution\";\n  ActionTypes[\"ErrorCommunication\"] = \"error.communication\";\n  ActionTypes[\"ErrorPlatform\"] = \"error.platform\";\n  ActionTypes[\"ErrorCustom\"] = \"xstate.error\";\n  ActionTypes[\"Update\"] = \"xstate.update\";\n  ActionTypes[\"Pure\"] = \"xstate.pure\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar SpecialTargets;\n\n(function (SpecialTargets) {\n  SpecialTargets[\"Parent\"] = \"#_parent\";\n  SpecialTargets[\"Internal\"] = \"#_internal\";\n})(SpecialTargets || (SpecialTargets = {}));\n\nexport { ActionTypes, SpecialTargets };","import { ActionTypes } from './types.js'; // xstate-specific action types\n\nvar start = ActionTypes.Start;\nvar stop = ActionTypes.Stop;\nvar raise = ActionTypes.Raise;\nvar send = ActionTypes.Send;\nvar cancel = ActionTypes.Cancel;\nvar nullEvent = ActionTypes.NullEvent;\nvar assign = ActionTypes.Assign;\nvar after = ActionTypes.After;\nvar doneState = ActionTypes.DoneState;\nvar log = ActionTypes.Log;\nvar init = ActionTypes.Init;\nvar invoke = ActionTypes.Invoke;\nvar errorExecution = ActionTypes.ErrorExecution;\nvar errorPlatform = ActionTypes.ErrorPlatform;\nvar error = ActionTypes.ErrorCustom;\nvar update = ActionTypes.Update;\nvar pure = ActionTypes.Pure;\nexport { after, assign, cancel, doneState, error, errorExecution, errorPlatform, init, invoke, log, nullEvent, pure, raise, send, start, stop, update };","import { __assign, __rest } from './_virtual/_tslib.js';\nimport { toSCXMLEvent, isFunction, toEventObject, getEventType, isString, isArray } from './utils.js';\nimport { SpecialTargets, ActionTypes } from './types.js';\nimport { send as send$1, update, assign as assign$1, raise as raise$1, init, log as log$1, cancel as cancel$1, error as error$1 } from './actionTypes.js';\nvar initEvent =\n/*#__PURE__*/\ntoSCXMLEvent({\n  type: init\n});\n\nfunction getActionFunction(actionType, actionFunctionMap) {\n  return actionFunctionMap ? actionFunctionMap[actionType] || undefined : undefined;\n}\n\nfunction toActionObject(action, actionFunctionMap) {\n  var actionObject;\n\n  if (isString(action) || typeof action === 'number') {\n    var exec = getActionFunction(action, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = {\n        type: action,\n        exec: exec\n      };\n    } else if (exec) {\n      actionObject = exec;\n    } else {\n      actionObject = {\n        type: action,\n        exec: undefined\n      };\n    }\n  } else if (isFunction(action)) {\n    actionObject = {\n      // Convert action to string if unnamed\n      type: action.name || action.toString(),\n      exec: action\n    };\n  } else {\n    var exec = getActionFunction(action.type, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = __assign(__assign({}, action), {\n        exec: exec\n      });\n    } else if (exec) {\n      var type = action.type,\n          other = __rest(action, [\"type\"]);\n\n      actionObject = __assign(__assign({\n        type: type\n      }, exec), other);\n    } else {\n      actionObject = action;\n    }\n  }\n\n  Object.defineProperty(actionObject, 'toString', {\n    value: function () {\n      return actionObject.type;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return actionObject;\n}\n\nvar toActionObjects = function (action, actionFunctionMap) {\n  if (!action) {\n    return [];\n  }\n\n  var actions = isArray(action) ? action : [action];\n  return actions.map(function (subAction) {\n    return toActionObject(subAction, actionFunctionMap);\n  });\n};\n\nfunction toActivityDefinition(action) {\n  var actionObject = toActionObject(action);\n  return __assign(__assign({\n    id: isString(action) ? action : actionObject.id\n  }, actionObject), {\n    type: actionObject.type\n  });\n}\n/**\r\n * Raises an event. This places the event in the internal event queue, so that\r\n * the event is immediately consumed by the machine in the current step.\r\n *\r\n * @param eventType The event to raise.\r\n */\n\n\nfunction raise(event) {\n  if (!isString(event)) {\n    return send(event, {\n      to: SpecialTargets.Internal\n    });\n  }\n\n  return {\n    type: raise$1,\n    event: event\n  };\n}\n\nfunction resolveRaise(action) {\n  return {\n    type: raise$1,\n    _event: toSCXMLEvent(action.event)\n  };\n}\n/**\r\n * Sends an event. This returns an action that will be read by an interpreter to\r\n * send the event in the next step, after the current step is finished executing.\r\n *\r\n * @param event The event to send.\r\n * @param options Options to pass into the send event:\r\n *  - `id` - The unique send event identifier (used with `cancel()`).\r\n *  - `delay` - The number of milliseconds to delay the sending of the event.\r\n *  - `to` - The target of this event (by default, the machine the event was sent from).\r\n */\n\n\nfunction send(event, options) {\n  return {\n    to: options ? options.to : undefined,\n    type: send$1,\n    event: isFunction(event) ? event : toEventObject(event),\n    delay: options ? options.delay : undefined,\n    id: options && options.id !== undefined ? options.id : isFunction(event) ? event.name : getEventType(event)\n  };\n}\n\nfunction resolveSend(action, ctx, _event, delaysMap) {\n  var meta = {\n    _event: _event\n  }; // TODO: helper function for resolving Expr\n\n  var resolvedEvent = toSCXMLEvent(isFunction(action.event) ? action.event(ctx, _event.data, meta) : action.event);\n  var resolvedDelay;\n\n  if (isString(action.delay)) {\n    var configDelay = delaysMap && delaysMap[action.delay];\n    resolvedDelay = isFunction(configDelay) ? configDelay(ctx, _event.data, meta) : configDelay;\n  } else {\n    resolvedDelay = isFunction(action.delay) ? action.delay(ctx, _event.data, meta) : action.delay;\n  }\n\n  var resolvedTarget = isFunction(action.to) ? action.to(ctx, _event.data, meta) : action.to;\n  return __assign(__assign({}, action), {\n    to: resolvedTarget,\n    _event: resolvedEvent,\n    event: resolvedEvent.data,\n    delay: resolvedDelay\n  });\n}\n/**\r\n * Sends an event to this machine's parent.\r\n *\r\n * @param event The event to send to the parent machine.\r\n * @param options Options to pass into the send event.\r\n */\n\n\nfunction sendParent(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n/**\r\n * Sends an update event to this machine's parent.\r\n */\n\n\nfunction sendUpdate() {\n  return sendParent(update);\n}\n/**\r\n * Sends an event back to the sender of the original event.\r\n *\r\n * @param event The event to send back to the sender\r\n * @param options Options to pass into the send event\r\n */\n\n\nfunction respond(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: function (_, __, _a) {\n      var _event = _a._event;\n      return _event.origin; // TODO: handle when _event.origin is undefined\n    }\n  }));\n}\n\nvar defaultLogExpr = function (context, event) {\n  return {\n    context: context,\n    event: event\n  };\n};\n/**\r\n *\r\n * @param expr The expression function to evaluate which will be logged.\r\n *  Takes in 2 arguments:\r\n *  - `ctx` - the current state context\r\n *  - `event` - the event that caused this action to be executed.\r\n * @param label The label to give to the logged expression.\r\n */\n\n\nfunction log(expr, label) {\n  if (expr === void 0) {\n    expr = defaultLogExpr;\n  }\n\n  return {\n    type: log$1,\n    label: label,\n    expr: expr\n  };\n}\n\nvar resolveLog = function (action, ctx, _event) {\n  return __assign(__assign({}, action), {\n    value: isString(action.expr) ? action.expr : action.expr(ctx, _event.data, {\n      _event: _event\n    })\n  });\n};\n/**\r\n * Cancels an in-flight `send(...)` action. A canceled sent action will not\r\n * be executed, nor will its event be sent, unless it has already been sent\r\n * (e.g., if `cancel(...)` is called after the `send(...)` action's `delay`).\r\n *\r\n * @param sendId The `id` of the `send(...)` action to cancel.\r\n */\n\n\nvar cancel = function (sendId) {\n  return {\n    type: cancel$1,\n    sendId: sendId\n  };\n};\n/**\r\n * Starts an activity.\r\n *\r\n * @param activity The activity to start.\r\n */\n\n\nfunction start(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Start,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Stops an activity.\r\n *\r\n * @param activity The activity to stop.\r\n */\n\n\nfunction stop(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Stop,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Updates the current context of the machine.\r\n *\r\n * @param assignment An object that represents the partial context to update.\r\n */\n\n\nvar assign = function (assignment) {\n  return {\n    type: assign$1,\n    assignment: assignment\n  };\n};\n/**\r\n * Returns an event type that represents an implicit event that\r\n * is sent after the specified `delay`.\r\n *\r\n * @param delayRef The delay in milliseconds\r\n * @param id The state node ID where this event is handled\r\n */\n\n\nfunction after(delayRef, id) {\n  var idSuffix = id ? \"#\" + id : '';\n  return ActionTypes.After + \"(\" + delayRef + \")\" + idSuffix;\n}\n/**\r\n * Returns an event that represents that a final state node\r\n * has been reached in the parent state node.\r\n *\r\n * @param id The final state node's parent state node `id`\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction done(id, data) {\n  var type = ActionTypes.DoneState + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n/**\r\n * Returns an event that represents that an invoked service has terminated.\r\n *\r\n * An invoked service is terminated when it has reached a top-level final state node,\r\n * but not when it is canceled.\r\n *\r\n * @param id The final state node ID\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction doneInvoke(id, data) {\n  var type = ActionTypes.DoneInvoke + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n\nfunction error(id, data) {\n  var type = ActionTypes.ErrorPlatform + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n/**\r\n * Forwards (sends) an event to a specified service.\r\n *\r\n * @param target The target service to forward the event to.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction forwardTo(target, options) {\n  return send(function (_, event) {\n    return event;\n  }, __assign(__assign({}, options), {\n    to: target\n  }));\n}\n/**\r\n * Escalates an error by sending it as an event to this machine's parent.\r\n *\r\n * @param errorData The error data to send.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction escalate(errorData, options) {\n  return sendParent({\n    type: error$1,\n    data: errorData\n  }, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n\nexport { after, assign, cancel, done, doneInvoke, error, escalate, forwardTo, getActionFunction, initEvent, log, raise, resolveLog, resolveRaise, resolveSend, respond, send, sendParent, sendUpdate, start, stop, toActionObject, toActionObjects, toActivityDefinition };","import { __values, __spread } from './_virtual/_tslib.js';\nimport { keys, flatten } from './utils.js';\n\nvar isLeafNode = function (stateNode) {\n  return stateNode.type === 'atomic' || stateNode.type === 'final';\n};\n\nfunction getChildren(stateNode) {\n  return keys(stateNode.states).map(function (key) {\n    return stateNode.states[key];\n  });\n}\n\nfunction getAllStateNodes(stateNode) {\n  var stateNodes = [stateNode];\n\n  if (isLeafNode(stateNode)) {\n    return stateNodes;\n  }\n\n  return stateNodes.concat(flatten(getChildren(stateNode).map(getAllStateNodes)));\n}\n\nfunction getConfiguration(prevStateNodes, stateNodes) {\n  var e_1, _a, e_2, _b, e_3, _c, e_4, _d;\n\n  var prevConfiguration = new Set(prevStateNodes);\n  var prevAdjList = getAdjList(prevConfiguration);\n  var configuration = new Set(stateNodes);\n\n  try {\n    // add all ancestors\n    for (var configuration_1 = __values(configuration), configuration_1_1 = configuration_1.next(); !configuration_1_1.done; configuration_1_1 = configuration_1.next()) {\n      var s = configuration_1_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (configuration_1_1 && !configuration_1_1.done && (_a = configuration_1.return)) _a.call(configuration_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  var adjList = getAdjList(configuration);\n\n  try {\n    // add descendants\n    for (var configuration_2 = __values(configuration), configuration_2_1 = configuration_2.next(); !configuration_2_1.done; configuration_2_1 = configuration_2.next()) {\n      var s = configuration_2_1.value; // if previously active, add existing child nodes\n\n      if (s.type === 'compound' && (!adjList.get(s) || !adjList.get(s).length)) {\n        if (prevAdjList.get(s)) {\n          prevAdjList.get(s).forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        } else {\n          s.initialStateNodes.forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        }\n      } else {\n        if (s.type === 'parallel') {\n          try {\n            for (var _e = (e_3 = void 0, __values(getChildren(s))), _f = _e.next(); !_f.done; _f = _e.next()) {\n              var child = _f.value;\n\n              if (child.type === 'history') {\n                continue;\n              }\n\n              if (!configuration.has(child)) {\n                configuration.add(child);\n\n                if (prevAdjList.get(child)) {\n                  prevAdjList.get(child).forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                } else {\n                  child.initialStateNodes.forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                }\n              }\n            }\n          } catch (e_3_1) {\n            e_3 = {\n              error: e_3_1\n            };\n          } finally {\n            try {\n              if (_f && !_f.done && (_c = _e.return)) _c.call(_e);\n            } finally {\n              if (e_3) throw e_3.error;\n            }\n          }\n        }\n      }\n    }\n  } catch (e_2_1) {\n    e_2 = {\n      error: e_2_1\n    };\n  } finally {\n    try {\n      if (configuration_2_1 && !configuration_2_1.done && (_b = configuration_2.return)) _b.call(configuration_2);\n    } finally {\n      if (e_2) throw e_2.error;\n    }\n  }\n\n  try {\n    // add all ancestors\n    for (var configuration_3 = __values(configuration), configuration_3_1 = configuration_3.next(); !configuration_3_1.done; configuration_3_1 = configuration_3.next()) {\n      var s = configuration_3_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_4_1) {\n    e_4 = {\n      error: e_4_1\n    };\n  } finally {\n    try {\n      if (configuration_3_1 && !configuration_3_1.done && (_d = configuration_3.return)) _d.call(configuration_3);\n    } finally {\n      if (e_4) throw e_4.error;\n    }\n  }\n\n  return configuration;\n}\n\nfunction getValueFromAdj(baseNode, adjList) {\n  var childStateNodes = adjList.get(baseNode);\n\n  if (!childStateNodes) {\n    return {}; // todo: fix?\n  }\n\n  if (baseNode.type === 'compound') {\n    var childStateNode = childStateNodes[0];\n\n    if (childStateNode) {\n      if (isLeafNode(childStateNode)) {\n        return childStateNode.key;\n      }\n    } else {\n      return {};\n    }\n  }\n\n  var stateValue = {};\n  childStateNodes.forEach(function (csn) {\n    stateValue[csn.key] = getValueFromAdj(csn, adjList);\n  });\n  return stateValue;\n}\n\nfunction getAdjList(configuration) {\n  var e_5, _a;\n\n  var adjList = new Map();\n\n  try {\n    for (var configuration_4 = __values(configuration), configuration_4_1 = configuration_4.next(); !configuration_4_1.done; configuration_4_1 = configuration_4.next()) {\n      var s = configuration_4_1.value;\n\n      if (!adjList.has(s)) {\n        adjList.set(s, []);\n      }\n\n      if (s.parent) {\n        if (!adjList.has(s.parent)) {\n          adjList.set(s.parent, []);\n        }\n\n        adjList.get(s.parent).push(s);\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (configuration_4_1 && !configuration_4_1.done && (_a = configuration_4.return)) _a.call(configuration_4);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return adjList;\n}\n\nfunction getValue(rootNode, configuration) {\n  var config = getConfiguration([rootNode], configuration);\n  return getValueFromAdj(rootNode, getAdjList(config));\n}\n\nfunction has(iterable, item) {\n  if (Array.isArray(iterable)) {\n    return iterable.some(function (member) {\n      return member === item;\n    });\n  }\n\n  if (iterable instanceof Set) {\n    return iterable.has(item);\n  }\n\n  return false; // TODO: fix\n}\n\nfunction nextEvents(configuration) {\n  return flatten(__spread(new Set(configuration.map(function (sn) {\n    return sn.ownEvents;\n  }))));\n}\n\nfunction isInFinalState(configuration, stateNode) {\n  if (stateNode.type === 'compound') {\n    return getChildren(stateNode).some(function (s) {\n      return s.type === 'final' && has(configuration, s);\n    });\n  }\n\n  if (stateNode.type === 'parallel') {\n    return getChildren(stateNode).every(function (sn) {\n      return isInFinalState(configuration, sn);\n    });\n  }\n\n  return false;\n}\n\nexport { getAdjList, getAllStateNodes, getChildren, getConfiguration, getValue, has, isInFinalState, isLeafNode, nextEvents };","import { __spread, __rest, __assign } from './_virtual/_tslib.js';\nimport { EMPTY_ACTIVITY_MAP } from './constants.js';\nimport { isString, matchesState, keys } from './utils.js';\nimport { nextEvents } from './stateUtils.js';\nimport { initEvent } from './actions.js';\n\nfunction stateValuesEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a === undefined || b === undefined) {\n    return false;\n  }\n\n  if (isString(a) || isString(b)) {\n    return a === b;\n  }\n\n  var aKeys = keys(a);\n  var bKeys = keys(b);\n  return aKeys.length === bKeys.length && aKeys.every(function (key) {\n    return stateValuesEqual(a[key], b[key]);\n  });\n}\n\nfunction isState(state) {\n  if (isString(state)) {\n    return false;\n  }\n\n  return 'value' in state && 'history' in state;\n}\n\nfunction bindActionToState(action, state) {\n  var exec = action.exec;\n\n  var boundAction = __assign(__assign({}, action), {\n    exec: exec !== undefined ? function () {\n      return exec(state.context, state.event, {\n        action: action,\n        state: state,\n        _event: state._event\n      });\n    } : undefined\n  });\n\n  return boundAction;\n}\n\nvar State =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new State instance.\r\n   * @param value The state value\r\n   * @param context The extended state\r\n   * @param historyValue The tree representing historical values of the state nodes\r\n   * @param history The previous state\r\n   * @param actions An array of action objects to execute as side-effects\r\n   * @param activities A mapping of activities and whether they are started (`true`) or stopped (`false`).\r\n   * @param meta\r\n   * @param events Internal event queue. Should be empty with run-to-completion semantics.\r\n   * @param configuration\r\n   */\n  function State(config) {\n    this.actions = [];\n    this.activities = EMPTY_ACTIVITY_MAP;\n    this.meta = {};\n    this.events = [];\n    this.value = config.value;\n    this.context = config.context;\n    this._event = config._event;\n    this._sessionid = config._sessionid;\n    this.event = this._event.data;\n    this.historyValue = config.historyValue;\n    this.history = config.history;\n    this.actions = config.actions || [];\n    this.activities = config.activities || EMPTY_ACTIVITY_MAP;\n    this.meta = config.meta || {};\n    this.events = config.events || [];\n    this.matches = this.matches.bind(this);\n    this.toStrings = this.toStrings.bind(this);\n    this.configuration = config.configuration;\n    this.transitions = config.transitions;\n    this.children = config.children;\n    this.done = !!config.done;\n    Object.defineProperty(this, 'nextEvents', {\n      get: function () {\n        return nextEvents(config.configuration);\n      }\n    });\n  }\n  /**\r\n   * Creates a new State instance for the given `stateValue` and `context`.\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.from = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (stateValue.context !== context) {\n        return new State({\n          value: stateValue.value,\n          context: context,\n          _event: stateValue._event,\n          _sessionid: null,\n          historyValue: stateValue.historyValue,\n          history: stateValue.history,\n          actions: [],\n          activities: stateValue.activities,\n          meta: {},\n          events: [],\n          configuration: [],\n          transitions: [],\n          children: {}\n        });\n      }\n\n      return stateValue;\n    }\n\n    var _event = initEvent;\n    return new State({\n      value: stateValue,\n      context: context,\n      _event: _event,\n      _sessionid: null,\n      historyValue: undefined,\n      history: undefined,\n      actions: [],\n      activities: undefined,\n      meta: undefined,\n      events: [],\n      configuration: [],\n      transitions: [],\n      children: {}\n    });\n  };\n  /**\r\n   * Creates a new State instance for the given `config`.\r\n   * @param config The state config\r\n   */\n\n\n  State.create = function (config) {\n    return new State(config);\n  };\n  /**\r\n   * Creates a new `State` instance for the given `stateValue` and `context` with no actions (side-effects).\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.inert = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (!stateValue.actions.length) {\n        return stateValue;\n      }\n\n      var _event = initEvent;\n      return new State({\n        value: stateValue.value,\n        context: context,\n        _event: _event,\n        _sessionid: null,\n        historyValue: stateValue.historyValue,\n        history: stateValue.history,\n        activities: stateValue.activities,\n        configuration: stateValue.configuration,\n        transitions: [],\n        children: {}\n      });\n    }\n\n    return State.from(stateValue, context);\n  };\n  /**\r\n   * Returns an array of all the string leaf state node paths.\r\n   * @param stateValue\r\n   * @param delimiter The character(s) that separate each subpath in the string state node path.\r\n   */\n\n\n  State.prototype.toStrings = function (stateValue, delimiter) {\n    var _this = this;\n\n    if (stateValue === void 0) {\n      stateValue = this.value;\n    }\n\n    if (delimiter === void 0) {\n      delimiter = '.';\n    }\n\n    if (isString(stateValue)) {\n      return [stateValue];\n    }\n\n    var valueKeys = keys(stateValue);\n    return valueKeys.concat.apply(valueKeys, __spread(valueKeys.map(function (key) {\n      return _this.toStrings(stateValue[key], delimiter).map(function (s) {\n        return key + delimiter + s;\n      });\n    })));\n  };\n\n  State.prototype.toJSON = function () {\n    var _a = this,\n        configuration = _a.configuration,\n        transitions = _a.transitions,\n        jsonValues = __rest(_a, [\"configuration\", \"transitions\"]);\n\n    return jsonValues;\n  };\n  /**\r\n   * Whether the current state value is a subset of the given parent state value.\r\n   * @param parentStateValue\r\n   */\n\n\n  State.prototype.matches = function (parentStateValue) {\n    return matchesState(parentStateValue, this.value);\n  };\n\n  return State;\n}();\n\nexport { State, bindActionToState, isState, stateValuesEqual };","function createNullActor(id) {\n  return {\n    id: id,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    },\n    toJSON: function () {\n      return {\n        id: id\n      };\n    }\n  };\n}\n/**\r\n * Creates a null actor that is able to be invoked given the provided\r\n * invocation information in its `.meta` value.\r\n *\r\n * @param invokeDefinition The meta information needed to invoke the actor.\r\n */\n\n\nfunction createInvocableActor(invokeDefinition) {\n  var tempActor = createNullActor(invokeDefinition.id);\n  tempActor.meta = invokeDefinition;\n  return tempActor;\n}\n\nfunction isActor(item) {\n  try {\n    return typeof item.send === 'function';\n  } catch (e) {\n    return false;\n  }\n}\n\nexport { createInvocableActor, createNullActor, isActor };","import { __assign, __values, __spread, __read, __rest } from './_virtual/_tslib.js';\nimport { DEFAULT_GUARD_TYPE, STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { mapValues, isArray, flatten, keys, toArray, toStateValue, isString, getEventType, matchesState, path, mapContext, toSCXMLEvent, pathToStateValue, isBuiltInEvent, partition, updateContext, warn, updateHistoryValue, toStatePath, mapFilterValues, toStatePaths, nestedPath, normalizeTarget, toGuard, toTransitionConfigArray, isMachine, isFunction } from './utils.js';\nimport { SpecialTargets } from './types.js';\nimport { getAllStateNodes, getConfiguration, has, getChildren, isInFinalState, getValue, isLeafNode } from './stateUtils.js';\nimport { start as start$1, stop as stop$1, pure, log, send, raise as raise$1, invoke, update, nullEvent, assign } from './actionTypes.js';\nimport { done, start, raise, stop, toActionObjects, toActionObject, resolveLog, resolveSend, resolveRaise, doneInvoke, error, toActivityDefinition, after, send as send$1, cancel, initEvent } from './actions.js';\nimport { State, stateValuesEqual } from './State.js';\nimport { createInvocableActor } from './Actor.js';\nvar NULL_EVENT = '';\nvar STATE_IDENTIFIER = '#';\nvar WILDCARD = '*';\nvar EMPTY_OBJECT = {};\n\nvar isStateId = function (str) {\n  return str[0] === STATE_IDENTIFIER;\n};\n\nvar createDefaultOptions = function () {\n  return {\n    actions: {},\n    guards: {},\n    services: {},\n    activities: {},\n    delays: {}\n  };\n};\n\nvar validateArrayifiedTransitions = function (stateNode, event, transitions) {\n  var hasNonLastUnguardedTarget = transitions.slice(0, -1).some(function (transition) {\n    return !('cond' in transition) && !('in' in transition) && (isString(transition.target) || isMachine(transition.target));\n  });\n  var eventText = event === NULL_EVENT ? 'the transient event' : \"event '\" + event + \"'\";\n  warn(!hasNonLastUnguardedTarget, \"One or more transitions for \" + eventText + \" on state '\" + stateNode.id + \"' are unreachable. \" + \"Make sure that the default transition is the last one defined.\");\n};\n\nvar StateNode =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function StateNode(\n  /**\r\n   * The raw config used to create the machine.\r\n   */\n  config, options,\n  /**\r\n   * The initial extended state\r\n   */\n  context) {\n    var _this = this;\n\n    this.config = config;\n    this.context = context;\n    /**\r\n     * The order this state node appears. Corresponds to the implicit SCXML document order.\r\n     */\n\n    this.order = -1;\n    this.__xstatenode = true;\n    this.__cache = {\n      events: undefined,\n      relativeValue: new Map(),\n      initialStateValue: undefined,\n      initialState: undefined,\n      on: undefined,\n      transitions: undefined,\n      candidates: {},\n      delayedTransitions: undefined\n    };\n    this.idMap = {};\n    this.options = Object.assign(createDefaultOptions(), options);\n    this.parent = this.options._parent;\n    this.key = this.config.key || this.options._key || this.config.id || '(machine)';\n    this.machine = this.parent ? this.parent.machine : this;\n    this.path = this.parent ? this.parent.path.concat(this.key) : [];\n    this.delimiter = this.config.delimiter || (this.parent ? this.parent.delimiter : STATE_DELIMITER);\n    this.id = this.config.id || __spread([this.machine.key], this.path).join(this.delimiter);\n    this.version = this.parent ? this.parent.version : this.config.version;\n    this.type = this.config.type || (this.config.parallel ? 'parallel' : this.config.states && keys(this.config.states).length ? 'compound' : this.config.history ? 'history' : 'atomic');\n\n    if (!IS_PRODUCTION) {\n      warn(!('parallel' in this.config), \"The \\\"parallel\\\" property is deprecated and will be removed in version 4.1. \" + (this.config.parallel ? \"Replace with `type: 'parallel'`\" : \"Use `type: '\" + this.type + \"'`\") + \" in the config for state node '\" + this.id + \"' instead.\");\n    }\n\n    this.initial = this.config.initial;\n    this.states = this.config.states ? mapValues(this.config.states, function (stateConfig, key) {\n      var _a;\n\n      var stateNode = new StateNode(stateConfig, {\n        _parent: _this,\n        _key: key\n      });\n      Object.assign(_this.idMap, __assign((_a = {}, _a[stateNode.id] = stateNode, _a), stateNode.idMap));\n      return stateNode;\n    }) : EMPTY_OBJECT; // Document order\n\n    var order = 0;\n\n    function dfs(stateNode) {\n      var e_1, _a;\n\n      stateNode.order = order++;\n\n      try {\n        for (var _b = __values(getChildren(stateNode)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n          dfs(child);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n\n    dfs(this); // History config\n\n    this.history = this.config.history === true ? 'shallow' : this.config.history || false;\n    this._transient = !this.config.on ? false : Array.isArray(this.config.on) ? this.config.on.some(function (_a) {\n      var event = _a.event;\n      return event === NULL_EVENT;\n    }) : NULL_EVENT in this.config.on;\n    this.strict = !!this.config.strict; // TODO: deprecate (entry)\n\n    this.onEntry = toArray(this.config.entry || this.config.onEntry).map(function (action) {\n      return toActionObject(action);\n    }); // TODO: deprecate (exit)\n\n    this.onExit = toArray(this.config.exit || this.config.onExit).map(function (action) {\n      return toActionObject(action);\n    });\n    this.meta = this.config.meta;\n    this.data = this.type === 'final' ? this.config.data : undefined;\n    this.invoke = toArray(this.config.invoke).map(function (invokeConfig, i) {\n      var _a, _b;\n\n      if (isMachine(invokeConfig)) {\n        _this.machine.options.services = __assign((_a = {}, _a[invokeConfig.id] = invokeConfig, _a), _this.machine.options.services);\n        return {\n          type: invoke,\n          src: invokeConfig.id,\n          id: invokeConfig.id\n        };\n      } else if (typeof invokeConfig.src !== 'string') {\n        var invokeSrc = _this.id + \":invocation[\" + i + \"]\"; // TODO: util function\n\n        _this.machine.options.services = __assign((_b = {}, _b[invokeSrc] = invokeConfig.src, _b), _this.machine.options.services);\n        return __assign(__assign({\n          type: invoke,\n          id: invokeSrc\n        }, invokeConfig), {\n          src: invokeSrc\n        });\n      } else {\n        return __assign(__assign({}, invokeConfig), {\n          type: invoke,\n          id: invokeConfig.id || invokeConfig.src,\n          src: invokeConfig.src\n        });\n      }\n    });\n    this.activities = toArray(this.config.activities).concat(this.invoke).map(function (activity) {\n      return toActivityDefinition(activity);\n    });\n    this.transition = this.transition.bind(this);\n  }\n\n  StateNode.prototype._init = function () {\n    if (this.__cache.transitions) {\n      return;\n    }\n\n    getAllStateNodes(this).forEach(function (stateNode) {\n      return stateNode.on;\n    });\n  };\n  /**\r\n   * Clones this state machine with custom options and context.\r\n   *\r\n   * @param options Options (actions, guards, activities, services) to recursively merge with the existing options.\r\n   * @param context Custom context (will override predefined context)\r\n   */\n\n\n  StateNode.prototype.withConfig = function (options, context) {\n    if (context === void 0) {\n      context = this.context;\n    }\n\n    var _a = this.options,\n        actions = _a.actions,\n        activities = _a.activities,\n        guards = _a.guards,\n        services = _a.services,\n        delays = _a.delays;\n    return new StateNode(this.config, {\n      actions: __assign(__assign({}, actions), options.actions),\n      activities: __assign(__assign({}, activities), options.activities),\n      guards: __assign(__assign({}, guards), options.guards),\n      services: __assign(__assign({}, services), options.services),\n      delays: __assign(__assign({}, delays), options.delays)\n    }, context);\n  };\n  /**\r\n   * Clones this state machine with custom context.\r\n   *\r\n   * @param context Custom context (will override predefined context, not recursive)\r\n   */\n\n\n  StateNode.prototype.withContext = function (context) {\n    return new StateNode(this.config, this.options, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"definition\", {\n    /**\r\n     * The well-structured state node definition.\r\n     */\n    get: function () {\n      return {\n        id: this.id,\n        key: this.key,\n        version: this.version,\n        type: this.type,\n        initial: this.initial,\n        history: this.history,\n        states: mapValues(this.states, function (state) {\n          return state.definition;\n        }),\n        on: this.on,\n        transitions: this.transitions,\n        onEntry: this.onEntry,\n        onExit: this.onExit,\n        activities: this.activities || [],\n        meta: this.meta,\n        order: this.order || -1,\n        data: this.data,\n        invoke: this.invoke\n      };\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.toJSON = function () {\n    return this.definition;\n  };\n\n  Object.defineProperty(StateNode.prototype, \"on\", {\n    /**\r\n     * The mapping of events to transitions.\r\n     */\n    get: function () {\n      if (this.__cache.on) {\n        return this.__cache.on;\n      }\n\n      var transitions = this.transitions;\n      return this.__cache.on = transitions.reduce(function (map, transition) {\n        map[transition.eventType] = map[transition.eventType] || [];\n        map[transition.eventType].push(transition);\n        return map;\n      }, {});\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"after\", {\n    get: function () {\n      return this.__cache.delayedTransitions || (this.__cache.delayedTransitions = this.getDelayedTransitions(), this.__cache.delayedTransitions);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"transitions\", {\n    /**\r\n     * All the transitions that can be taken from this state node.\r\n     */\n    get: function () {\n      return this.__cache.transitions || (this.__cache.transitions = this.formatTransitions(), this.__cache.transitions);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.getCandidates = function (eventName) {\n    if (this.__cache.candidates[eventName]) {\n      return this.__cache.candidates[eventName];\n    }\n\n    var transient = eventName === NULL_EVENT;\n    var candidates = this.transitions.filter(function (transition) {\n      var sameEventType = transition.eventType === eventName; // null events should only match against eventless transitions\n\n      return transient ? sameEventType : sameEventType || transition.eventType === WILDCARD;\n    });\n    this.__cache.candidates[eventName] = candidates;\n    return candidates;\n  };\n  /**\r\n   * All delayed transitions from the config.\r\n   */\n\n\n  StateNode.prototype.getDelayedTransitions = function () {\n    var _this = this;\n\n    var afterConfig = this.config.after;\n\n    if (!afterConfig) {\n      return [];\n    }\n\n    var mutateEntryExit = function (delay, i) {\n      var delayRef = isFunction(delay) ? _this.id + \":delay[\" + i + \"]\" : delay;\n      var eventType = after(delayRef, _this.id);\n\n      _this.onEntry.push(send$1(eventType, {\n        delay: delay\n      }));\n\n      _this.onExit.push(cancel(eventType));\n\n      return eventType;\n    };\n\n    var delayedTransitions = isArray(afterConfig) ? afterConfig.map(function (transition, i) {\n      var eventType = mutateEntryExit(transition.delay, i);\n      return __assign(__assign({}, transition), {\n        event: eventType\n      });\n    }) : flatten(keys(afterConfig).map(function (delay, i) {\n      var configTransition = afterConfig[delay];\n      var resolvedTransition = isString(configTransition) ? {\n        target: configTransition\n      } : configTransition;\n      var resolvedDelay = !isNaN(+delay) ? +delay : delay;\n      var eventType = mutateEntryExit(resolvedDelay, i);\n      return toArray(resolvedTransition).map(function (transition) {\n        return __assign(__assign({}, transition), {\n          event: eventType,\n          delay: resolvedDelay\n        });\n      });\n    }));\n    return delayedTransitions.map(function (delayedTransition) {\n      var delay = delayedTransition.delay;\n      return __assign(__assign({}, _this.formatTransition(delayedTransition)), {\n        delay: delay\n      });\n    });\n  };\n  /**\r\n   * Returns the state nodes represented by the current state value.\r\n   *\r\n   * @param state The state value or State instance\r\n   */\n\n\n  StateNode.prototype.getStateNodes = function (state) {\n    var _a;\n\n    var _this = this;\n\n    if (!state) {\n      return [];\n    }\n\n    var stateValue = state instanceof State ? state.value : toStateValue(state, this.delimiter);\n\n    if (isString(stateValue)) {\n      var initialStateValue = this.getStateNode(stateValue).initial;\n      return initialStateValue !== undefined ? this.getStateNodes((_a = {}, _a[stateValue] = initialStateValue, _a)) : [this.states[stateValue]];\n    }\n\n    var subStateKeys = keys(stateValue);\n    var subStateNodes = subStateKeys.map(function (subStateKey) {\n      return _this.getStateNode(subStateKey);\n    });\n    return subStateNodes.concat(subStateKeys.reduce(function (allSubStateNodes, subStateKey) {\n      var subStateNode = _this.getStateNode(subStateKey).getStateNodes(stateValue[subStateKey]);\n\n      return allSubStateNodes.concat(subStateNode);\n    }, []));\n  };\n  /**\r\n   * Returns `true` if this state node explicitly handles the given event.\r\n   *\r\n   * @param event The event in question\r\n   */\n\n\n  StateNode.prototype.handles = function (event) {\n    var eventType = getEventType(event);\n    return this.events.includes(eventType);\n  };\n  /**\r\n   * Resolves the given `state` to a new `State` instance relative to this machine.\r\n   *\r\n   * This ensures that `.events` and `.nextEvents` represent the correct values.\r\n   *\r\n   * @param state The state to resolve\r\n   */\n\n\n  StateNode.prototype.resolveState = function (state) {\n    var configuration = Array.from(getConfiguration([], this.getStateNodes(state.value)));\n    return new State(__assign(__assign({}, state), {\n      value: this.resolve(state.value),\n      configuration: configuration\n    }));\n  };\n\n  StateNode.prototype.transitionLeafNode = function (stateValue, state, _event) {\n    var stateNode = this.getStateNode(stateValue);\n    var next = stateNode.next(state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionCompoundNode = function (stateValue, state, _event) {\n    var subStateKeys = keys(stateValue);\n    var stateNode = this.getStateNode(subStateKeys[0]);\n\n    var next = stateNode._transition(stateValue[subStateKeys[0]], state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionParallelNode = function (stateValue, state, _event) {\n    var e_2, _a;\n\n    var transitionMap = {};\n\n    try {\n      for (var _b = __values(keys(stateValue)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var subStateKey = _c.value;\n        var subStateValue = stateValue[subStateKey];\n\n        if (!subStateValue) {\n          continue;\n        }\n\n        var subStateNode = this.getStateNode(subStateKey);\n\n        var next = subStateNode._transition(subStateValue, state, _event);\n\n        if (next) {\n          transitionMap[subStateKey] = next;\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    var stateTransitions = keys(transitionMap).map(function (key) {\n      return transitionMap[key];\n    });\n    var enabledTransitions = flatten(stateTransitions.map(function (st) {\n      return st.transitions;\n    }));\n    var willTransition = stateTransitions.some(function (st) {\n      return st.transitions.length > 0;\n    });\n\n    if (!willTransition) {\n      return this.next(state, _event);\n    }\n\n    var entryNodes = flatten(stateTransitions.map(function (t) {\n      return t.entrySet;\n    }));\n    var configuration = flatten(keys(transitionMap).map(function (key) {\n      return transitionMap[key].configuration;\n    }));\n    return {\n      transitions: enabledTransitions,\n      entrySet: entryNodes,\n      exitSet: flatten(stateTransitions.map(function (t) {\n        return t.exitSet;\n      })),\n      configuration: configuration,\n      source: state,\n      actions: flatten(keys(transitionMap).map(function (key) {\n        return transitionMap[key].actions;\n      }))\n    };\n  };\n\n  StateNode.prototype._transition = function (stateValue, state, _event) {\n    // leaf node\n    if (isString(stateValue)) {\n      return this.transitionLeafNode(stateValue, state, _event);\n    } // hierarchical node\n\n\n    if (keys(stateValue).length === 1) {\n      return this.transitionCompoundNode(stateValue, state, _event);\n    } // orthogonal node\n\n\n    return this.transitionParallelNode(stateValue, state, _event);\n  };\n\n  StateNode.prototype.next = function (state, _event) {\n    var e_3, _a;\n\n    var _this = this;\n\n    var eventName = _event.name;\n    var actions = [];\n    var nextStateNodes = [];\n    var selectedTransition;\n\n    try {\n      for (var _b = __values(this.getCandidates(eventName)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var candidate = _c.value;\n        var cond = candidate.cond,\n            stateIn = candidate.in;\n        var resolvedContext = state.context;\n        var isInState = stateIn ? isString(stateIn) && isStateId(stateIn) ? // Check if in state by ID\n        state.matches(toStateValue(this.getStateNodeById(stateIn).path, this.delimiter)) : // Check if in state by relative grandparent\n        matchesState(toStateValue(stateIn, this.delimiter), path(this.path.slice(0, -2))(state.value)) : true;\n        var guardPassed = false;\n\n        try {\n          guardPassed = !cond || this.evaluateGuard(cond, resolvedContext, _event, state);\n        } catch (err) {\n          throw new Error(\"Unable to evaluate guard '\" + (cond.name || cond.type) + \"' in transition for event '\" + eventName + \"' in state node '\" + this.id + \"':\\n\" + err.message);\n        }\n\n        if (guardPassed && isInState) {\n          if (candidate.target !== undefined) {\n            nextStateNodes = candidate.target;\n          }\n\n          actions.push.apply(actions, __spread(candidate.actions));\n          selectedTransition = candidate;\n          break;\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    if (!selectedTransition) {\n      return undefined;\n    }\n\n    if (!nextStateNodes.length) {\n      return {\n        transitions: [selectedTransition],\n        entrySet: [],\n        exitSet: [],\n        configuration: state.value ? [this] : [],\n        source: state,\n        actions: actions\n      };\n    }\n\n    var allNextStateNodes = flatten(nextStateNodes.map(function (stateNode) {\n      return _this.getRelativeStateNodes(stateNode, state.historyValue);\n    }));\n    var isInternal = !!selectedTransition.internal;\n    var reentryNodes = isInternal ? [] : flatten(allNextStateNodes.map(function (n) {\n      return _this.nodesFromChild(n);\n    }));\n    return {\n      transitions: [selectedTransition],\n      entrySet: reentryNodes,\n      exitSet: isInternal ? [] : [this],\n      configuration: allNextStateNodes,\n      source: state,\n      actions: actions\n    };\n  };\n\n  StateNode.prototype.nodesFromChild = function (childStateNode) {\n    if (childStateNode.escapes(this)) {\n      return [];\n    }\n\n    var nodes = [];\n    var marker = childStateNode;\n\n    while (marker && marker !== this) {\n      nodes.push(marker);\n      marker = marker.parent;\n    }\n\n    nodes.push(this); // inclusive\n\n    return nodes;\n  };\n  /**\r\n   * Whether the given state node \"escapes\" this state node. If the `stateNode` is equal to or the parent of\r\n   * this state node, it does not escape.\r\n   */\n\n\n  StateNode.prototype.escapes = function (stateNode) {\n    if (this === stateNode) {\n      return false;\n    }\n\n    var parent = this.parent;\n\n    while (parent) {\n      if (parent === stateNode) {\n        return false;\n      }\n\n      parent = parent.parent;\n    }\n\n    return true;\n  };\n\n  StateNode.prototype.evaluateGuard = function (guard, context, _event, state) {\n    var guards = this.machine.options.guards;\n    var guardMeta = {\n      state: state,\n      cond: guard,\n      _event: _event\n    }; // TODO: do not hardcode!\n\n    if (guard.type === DEFAULT_GUARD_TYPE) {\n      return guard.predicate(context, _event.data, guardMeta);\n    }\n\n    var condFn = guards[guard.type];\n\n    if (!condFn) {\n      throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + this.machine.id + \"'.\");\n    }\n\n    return condFn(context, _event.data, guardMeta);\n  };\n\n  StateNode.prototype.getActions = function (transition, currentContext, _event, prevState) {\n    var e_4, _a, e_5, _b;\n\n    var prevConfig = getConfiguration([], prevState ? this.getStateNodes(prevState.value) : [this]);\n    var resolvedConfig = transition.configuration.length ? getConfiguration(prevConfig, transition.configuration) : prevConfig;\n\n    try {\n      for (var resolvedConfig_1 = __values(resolvedConfig), resolvedConfig_1_1 = resolvedConfig_1.next(); !resolvedConfig_1_1.done; resolvedConfig_1_1 = resolvedConfig_1.next()) {\n        var sn = resolvedConfig_1_1.value;\n\n        if (!has(prevConfig, sn)) {\n          transition.entrySet.push(sn);\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (resolvedConfig_1_1 && !resolvedConfig_1_1.done && (_a = resolvedConfig_1.return)) _a.call(resolvedConfig_1);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    try {\n      for (var prevConfig_1 = __values(prevConfig), prevConfig_1_1 = prevConfig_1.next(); !prevConfig_1_1.done; prevConfig_1_1 = prevConfig_1.next()) {\n        var sn = prevConfig_1_1.value;\n\n        if (!has(resolvedConfig, sn) || has(transition.exitSet, sn.parent)) {\n          transition.exitSet.push(sn);\n        }\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (prevConfig_1_1 && !prevConfig_1_1.done && (_b = prevConfig_1.return)) _b.call(prevConfig_1);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    if (!transition.source) {\n      transition.exitSet = []; // Ensure that root StateNode (machine) is entered\n\n      transition.entrySet.push(this);\n    }\n\n    var doneEvents = flatten(transition.entrySet.map(function (sn) {\n      var events = [];\n\n      if (sn.type !== 'final') {\n        return events;\n      }\n\n      var parent = sn.parent;\n      events.push(done(sn.id, sn.data), // TODO: deprecate - final states should not emit done events for their own state.\n      done(parent.id, sn.data ? mapContext(sn.data, currentContext, _event) : undefined));\n\n      if (parent.parent) {\n        var grandparent = parent.parent;\n\n        if (grandparent.type === 'parallel') {\n          if (getChildren(grandparent).every(function (parentNode) {\n            return isInFinalState(transition.configuration, parentNode);\n          })) {\n            events.push(done(grandparent.id, grandparent.data));\n          }\n        }\n      }\n\n      return events;\n    }));\n    transition.exitSet.sort(function (a, b) {\n      return b.order - a.order;\n    });\n    transition.entrySet.sort(function (a, b) {\n      return a.order - b.order;\n    });\n    var entryStates = new Set(transition.entrySet);\n    var exitStates = new Set(transition.exitSet);\n\n    var _c = __read([flatten(Array.from(entryStates).map(function (stateNode) {\n      return __spread(stateNode.activities.map(function (activity) {\n        return start(activity);\n      }), stateNode.onEntry);\n    })).concat(doneEvents.map(raise)), flatten(Array.from(exitStates).map(function (stateNode) {\n      return __spread(stateNode.onExit, stateNode.activities.map(function (activity) {\n        return stop(activity);\n      }));\n    }))], 2),\n        entryActions = _c[0],\n        exitActions = _c[1];\n\n    var actions = toActionObjects(exitActions.concat(transition.actions).concat(entryActions), this.machine.options.actions);\n    return actions;\n  };\n  /**\r\n   * Determines the next state given the current `state` and sent `event`.\r\n   *\r\n   * @param state The current State instance or state value\r\n   * @param event The event that was sent at the current state\r\n   * @param context The current context (extended state) of the current state\r\n   */\n\n\n  StateNode.prototype.transition = function (state, event, context) {\n    if (state === void 0) {\n      state = this.initialState;\n    }\n\n    var _event = toSCXMLEvent(event);\n\n    var currentState;\n\n    if (state instanceof State) {\n      currentState = context === undefined ? state : this.resolveState(State.from(state, context));\n    } else {\n      var resolvedStateValue = isString(state) ? this.resolve(pathToStateValue(this.getResolvedPath(state))) : this.resolve(state);\n      var resolvedContext = context ? context : this.machine.context;\n      currentState = this.resolveState(State.from(resolvedStateValue, resolvedContext));\n    }\n\n    if (!IS_PRODUCTION && _event.name === WILDCARD) {\n      throw new Error(\"An event cannot have the wildcard type ('\" + WILDCARD + \"')\");\n    }\n\n    if (this.strict) {\n      if (!this.events.includes(_event.name) && !isBuiltInEvent(_event.name)) {\n        throw new Error(\"Machine '\" + this.id + \"' does not accept event '\" + _event.name + \"'\");\n      }\n    }\n\n    var stateTransition = this._transition(currentState.value, currentState, _event) || {\n      transitions: [],\n      configuration: [],\n      entrySet: [],\n      exitSet: [],\n      source: currentState,\n      actions: []\n    };\n    var prevConfig = getConfiguration([], this.getStateNodes(currentState.value));\n    var resolvedConfig = stateTransition.configuration.length ? getConfiguration(prevConfig, stateTransition.configuration) : prevConfig;\n    stateTransition.configuration = __spread(resolvedConfig);\n    return this.resolveTransition(stateTransition, currentState, _event);\n  };\n\n  StateNode.prototype.resolveRaisedTransition = function (state, _event, originalEvent) {\n    var _a;\n\n    var currentActions = state.actions;\n    state = this.transition(state, _event); // Save original event to state\n\n    state._event = originalEvent;\n    state.event = originalEvent.data;\n\n    (_a = state.actions).unshift.apply(_a, __spread(currentActions));\n\n    return state;\n  };\n\n  StateNode.prototype.resolveTransition = function (stateTransition, currentState, _event, context) {\n    var e_6, _a;\n\n    var _this = this;\n\n    if (_event === void 0) {\n      _event = initEvent;\n    }\n\n    if (context === void 0) {\n      context = this.machine.context;\n    }\n\n    var configuration = stateTransition.configuration; // Transition will \"apply\" if:\n    // - this is the initial state (there is no current state)\n    // - OR there are transitions\n\n    var willTransition = !currentState || stateTransition.transitions.length > 0;\n    var resolvedStateValue = willTransition ? getValue(this.machine, configuration) : undefined;\n    var historyValue = currentState ? currentState.historyValue ? currentState.historyValue : stateTransition.source ? this.machine.historyValue(currentState.value) : undefined : undefined;\n    var currentContext = currentState ? currentState.context : context;\n    var actions = this.getActions(stateTransition, currentContext, _event, currentState);\n    var activities = currentState ? __assign({}, currentState.activities) : {};\n\n    try {\n      for (var actions_1 = __values(actions), actions_1_1 = actions_1.next(); !actions_1_1.done; actions_1_1 = actions_1.next()) {\n        var action = actions_1_1.value;\n\n        if (action.type === start$1) {\n          activities[action.activity.type] = action;\n        } else if (action.type === stop$1) {\n          activities[action.activity.type] = false;\n        }\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (actions_1_1 && !actions_1_1.done && (_a = actions_1.return)) _a.call(actions_1);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    var _b = __read(partition(actions, function (action) {\n      return action.type === assign;\n    }), 2),\n        assignActions = _b[0],\n        otherActions = _b[1];\n\n    var updatedContext = assignActions.length ? updateContext(currentContext, _event, assignActions, currentState) : currentContext;\n    var resolvedActions = flatten(otherActions.map(function (actionObject) {\n      switch (actionObject.type) {\n        case raise$1:\n          return resolveRaise(actionObject);\n\n        case send:\n          var sendAction = resolveSend(actionObject, updatedContext, _event, _this.machine.options.delays); // TODO: fix ActionTypes.Init\n\n          if (!IS_PRODUCTION) {\n            // warn after resolving as we can create better contextual message here\n            warn(!isString(actionObject.delay) || typeof sendAction.delay === 'number', // tslint:disable-next-line:max-line-length\n            \"No delay reference for delay expression '\" + actionObject.delay + \"' was found on machine '\" + _this.machine.id + \"'\");\n          }\n\n          return sendAction;\n\n        case log:\n          return resolveLog(actionObject, updatedContext, _event);\n\n        case pure:\n          return actionObject.get(updatedContext, _event.data) || [];\n\n        default:\n          return toActionObject(actionObject, _this.options.actions);\n      }\n    }));\n\n    var _c = __read(partition(resolvedActions, function (action) {\n      return action.type === raise$1 || action.type === send && action.to === SpecialTargets.Internal;\n    }), 2),\n        raisedEvents = _c[0],\n        nonRaisedActions = _c[1];\n\n    var invokeActions = resolvedActions.filter(function (action) {\n      return action.type === start$1 && action.activity.type === invoke;\n    });\n    var children = invokeActions.reduce(function (acc, action) {\n      acc[action.activity.id] = createInvocableActor(action.activity);\n      return acc;\n    }, currentState ? __assign({}, currentState.children) : {});\n    var resolvedConfiguration = resolvedStateValue ? stateTransition.configuration : currentState ? currentState.configuration : [];\n    var meta = resolvedConfiguration.reduce(function (acc, stateNode) {\n      if (stateNode.meta !== undefined) {\n        acc[stateNode.id] = stateNode.meta;\n      }\n\n      return acc;\n    }, {});\n    var isDone = isInFinalState(resolvedConfiguration, this);\n    var nextState = new State({\n      value: resolvedStateValue || currentState.value,\n      context: updatedContext,\n      _event: _event,\n      // Persist _sessionid between states\n      _sessionid: currentState ? currentState._sessionid : null,\n      historyValue: resolvedStateValue ? historyValue ? updateHistoryValue(historyValue, resolvedStateValue) : undefined : currentState ? currentState.historyValue : undefined,\n      history: !resolvedStateValue || stateTransition.source ? currentState : undefined,\n      actions: resolvedStateValue ? nonRaisedActions : [],\n      activities: resolvedStateValue ? activities : currentState ? currentState.activities : {},\n      meta: resolvedStateValue ? meta : currentState ? currentState.meta : undefined,\n      events: [],\n      configuration: resolvedConfiguration,\n      transitions: stateTransition.transitions,\n      children: children,\n      done: isDone\n    });\n    nextState.changed = _event.name === update || !!assignActions.length; // Dispose of penultimate histories to prevent memory leaks\n\n    var history = nextState.history;\n\n    if (history) {\n      delete history.history;\n    }\n\n    if (!resolvedStateValue) {\n      return nextState;\n    }\n\n    var maybeNextState = nextState;\n\n    if (!isDone) {\n      var isTransient = this._transient || configuration.some(function (stateNode) {\n        return stateNode._transient;\n      });\n\n      if (isTransient) {\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, {\n          type: nullEvent\n        }, _event);\n      }\n\n      while (raisedEvents.length) {\n        var raisedEvent = raisedEvents.shift();\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, raisedEvent._event, _event);\n      }\n    } // Detect if state changed\n\n\n    var changed = maybeNextState.changed || (history ? !!maybeNextState.actions.length || !!assignActions.length || typeof history.value !== typeof maybeNextState.value || !stateValuesEqual(maybeNextState.value, history.value) : undefined);\n    maybeNextState.changed = changed; // Preserve original history after raised events\n\n    maybeNextState.historyValue = nextState.historyValue;\n    maybeNextState.history = history;\n    return maybeNextState;\n  };\n  /**\r\n   * Returns the child state node from its relative `stateKey`, or throws.\r\n   */\n\n\n  StateNode.prototype.getStateNode = function (stateKey) {\n    if (isStateId(stateKey)) {\n      return this.machine.getStateNodeById(stateKey);\n    }\n\n    if (!this.states) {\n      throw new Error(\"Unable to retrieve child state '\" + stateKey + \"' from '\" + this.id + \"'; no child states exist.\");\n    }\n\n    var result = this.states[stateKey];\n\n    if (!result) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return result;\n  };\n  /**\r\n   * Returns the state node with the given `stateId`, or throws.\r\n   *\r\n   * @param stateId The state ID. The prefix \"#\" is removed.\r\n   */\n\n\n  StateNode.prototype.getStateNodeById = function (stateId) {\n    var resolvedStateId = isStateId(stateId) ? stateId.slice(STATE_IDENTIFIER.length) : stateId;\n\n    if (resolvedStateId === this.id) {\n      return this;\n    }\n\n    var stateNode = this.machine.idMap[resolvedStateId];\n\n    if (!stateNode) {\n      throw new Error(\"Child state node '#\" + resolvedStateId + \"' does not exist on machine '\" + this.id + \"'\");\n    }\n\n    return stateNode;\n  };\n  /**\r\n   * Returns the relative state node from the given `statePath`, or throws.\r\n   *\r\n   * @param statePath The string or string array relative path to the state node.\r\n   */\n\n\n  StateNode.prototype.getStateNodeByPath = function (statePath) {\n    if (typeof statePath === 'string' && isStateId(statePath)) {\n      try {\n        return this.getStateNodeById(statePath.slice(1));\n      } catch (e) {// try individual paths\n        // throw e;\n      }\n    }\n\n    var arrayStatePath = toStatePath(statePath, this.delimiter).slice();\n    var currentStateNode = this;\n\n    while (arrayStatePath.length) {\n      var key = arrayStatePath.shift();\n\n      if (!key.length) {\n        break;\n      }\n\n      currentStateNode = currentStateNode.getStateNode(key);\n    }\n\n    return currentStateNode;\n  };\n  /**\r\n   * Resolves a partial state value with its full representation in this machine.\r\n   *\r\n   * @param stateValue The partial state value to resolve.\r\n   */\n\n\n  StateNode.prototype.resolve = function (stateValue) {\n    var _a;\n\n    var _this = this;\n\n    if (!stateValue) {\n      return this.initialStateValue || EMPTY_OBJECT; // TODO: type-specific properties\n    }\n\n    switch (this.type) {\n      case 'parallel':\n        return mapValues(this.initialStateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(stateValue[subStateKey] || subStateValue) : EMPTY_OBJECT;\n        });\n\n      case 'compound':\n        if (isString(stateValue)) {\n          var subStateNode = this.getStateNode(stateValue);\n\n          if (subStateNode.type === 'parallel' || subStateNode.type === 'compound') {\n            return _a = {}, _a[stateValue] = subStateNode.initialStateValue, _a;\n          }\n\n          return stateValue;\n        }\n\n        if (!keys(stateValue).length) {\n          return this.initialStateValue || {};\n        }\n\n        return mapValues(stateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(subStateValue) : EMPTY_OBJECT;\n        });\n\n      default:\n        return stateValue || EMPTY_OBJECT;\n    }\n  };\n\n  StateNode.prototype.getResolvedPath = function (stateIdentifier) {\n    if (isStateId(stateIdentifier)) {\n      var stateNode = this.machine.idMap[stateIdentifier.slice(STATE_IDENTIFIER.length)];\n\n      if (!stateNode) {\n        throw new Error(\"Unable to find state node '\" + stateIdentifier + \"'\");\n      }\n\n      return stateNode.path;\n    }\n\n    return toStatePath(stateIdentifier, this.delimiter);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateValue\", {\n    get: function () {\n      var _a;\n\n      if (this.__cache.initialStateValue) {\n        return this.__cache.initialStateValue;\n      }\n\n      var initialStateValue;\n\n      if (this.type === 'parallel') {\n        initialStateValue = mapFilterValues(this.states, function (state) {\n          return state.initialStateValue || EMPTY_OBJECT;\n        }, function (stateNode) {\n          return !(stateNode.type === 'history');\n        });\n      } else if (this.initial !== undefined) {\n        if (!this.states[this.initial]) {\n          throw new Error(\"Initial state '\" + this.initial + \"' not found on '\" + this.key + \"'\");\n        }\n\n        initialStateValue = isLeafNode(this.states[this.initial]) ? this.initial : (_a = {}, _a[this.initial] = this.states[this.initial].initialStateValue, _a);\n      }\n\n      this.__cache.initialStateValue = initialStateValue;\n      return this.__cache.initialStateValue;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.getInitialState = function (stateValue, context) {\n    var configuration = this.getStateNodes(stateValue);\n    return this.resolveTransition({\n      configuration: configuration,\n      entrySet: configuration,\n      exitSet: [],\n      transitions: [],\n      source: undefined,\n      actions: []\n    }, undefined, undefined, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialState\", {\n    /**\r\n     * The initial State instance, which includes all actions to be executed from\r\n     * entering the initial state.\r\n     */\n    get: function () {\n      this._init();\n\n      var initialStateValue = this.initialStateValue;\n\n      if (!initialStateValue) {\n        throw new Error(\"Cannot retrieve initial state from simple state '\" + this.id + \"'.\");\n      }\n\n      return this.getInitialState(initialStateValue);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"target\", {\n    /**\r\n     * The target state value of the history state node, if it exists. This represents the\r\n     * default state value to transition to if no history value exists yet.\r\n     */\n    get: function () {\n      var target;\n\n      if (this.type === 'history') {\n        var historyConfig = this.config;\n\n        if (isString(historyConfig.target)) {\n          target = isStateId(historyConfig.target) ? pathToStateValue(this.machine.getStateNodeById(historyConfig.target).path.slice(this.path.length - 1)) : historyConfig.target;\n        } else {\n          target = historyConfig.target;\n        }\n      }\n\n      return target;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Returns the leaf nodes from a state path relative to this state node.\r\n   *\r\n   * @param relativeStateId The relative state path to retrieve the state nodes\r\n   * @param history The previous state to retrieve history\r\n   * @param resolve Whether state nodes should resolve to initial child state nodes\r\n   */\n\n  StateNode.prototype.getRelativeStateNodes = function (relativeStateId, historyValue, resolve) {\n    if (resolve === void 0) {\n      resolve = true;\n    }\n\n    return resolve ? relativeStateId.type === 'history' ? relativeStateId.resolveHistory(historyValue) : relativeStateId.initialStateNodes : [relativeStateId];\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateNodes\", {\n    get: function () {\n      var _this = this;\n\n      if (isLeafNode(this)) {\n        return [this];\n      } // Case when state node is compound but no initial state is defined\n\n\n      if (this.type === 'compound' && !this.initial) {\n        if (!IS_PRODUCTION) {\n          warn(false, \"Compound state node '\" + this.id + \"' has no initial state.\");\n        }\n\n        return [this];\n      }\n\n      var initialStateNodePaths = toStatePaths(this.initialStateValue);\n      return flatten(initialStateNodePaths.map(function (initialPath) {\n        return _this.getFromRelativePath(initialPath);\n      }));\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Retrieves state nodes from a relative path to this state node.\r\n   *\r\n   * @param relativePath The relative path from this state node\r\n   * @param historyValue\r\n   */\n\n  StateNode.prototype.getFromRelativePath = function (relativePath) {\n    if (!relativePath.length) {\n      return [this];\n    }\n\n    var _a = __read(relativePath),\n        stateKey = _a[0],\n        childStatePath = _a.slice(1);\n\n    if (!this.states) {\n      throw new Error(\"Cannot retrieve subPath '\" + stateKey + \"' from node with no states\");\n    }\n\n    var childStateNode = this.getStateNode(stateKey);\n\n    if (childStateNode.type === 'history') {\n      return childStateNode.resolveHistory();\n    }\n\n    if (!this.states[stateKey]) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return this.states[stateKey].getFromRelativePath(childStatePath);\n  };\n\n  StateNode.prototype.historyValue = function (relativeStateValue) {\n    if (!keys(this.states).length) {\n      return undefined;\n    }\n\n    return {\n      current: relativeStateValue || this.initialStateValue,\n      states: mapFilterValues(this.states, function (stateNode, key) {\n        if (!relativeStateValue) {\n          return stateNode.historyValue();\n        }\n\n        var subStateValue = isString(relativeStateValue) ? undefined : relativeStateValue[key];\n        return stateNode.historyValue(subStateValue || stateNode.initialStateValue);\n      }, function (stateNode) {\n        return !stateNode.history;\n      })\n    };\n  };\n  /**\r\n   * Resolves to the historical value(s) of the parent state node,\r\n   * represented by state nodes.\r\n   *\r\n   * @param historyValue\r\n   */\n\n\n  StateNode.prototype.resolveHistory = function (historyValue) {\n    var _this = this;\n\n    if (this.type !== 'history') {\n      return [this];\n    }\n\n    var parent = this.parent;\n\n    if (!historyValue) {\n      var historyTarget = this.target;\n      return historyTarget ? flatten(toStatePaths(historyTarget).map(function (relativeChildPath) {\n        return parent.getFromRelativePath(relativeChildPath);\n      })) : parent.initialStateNodes;\n    }\n\n    var subHistoryValue = nestedPath(parent.path, 'states')(historyValue).current;\n\n    if (isString(subHistoryValue)) {\n      return [parent.getStateNode(subHistoryValue)];\n    }\n\n    return flatten(toStatePaths(subHistoryValue).map(function (subStatePath) {\n      return _this.history === 'deep' ? parent.getFromRelativePath(subStatePath) : [parent.states[subStatePath[0]]];\n    }));\n  };\n\n  Object.defineProperty(StateNode.prototype, \"stateIds\", {\n    /**\r\n     * All the state node IDs of this state node and its descendant state nodes.\r\n     */\n    get: function () {\n      var _this = this;\n\n      var childStateIds = flatten(keys(this.states).map(function (stateKey) {\n        return _this.states[stateKey].stateIds;\n      }));\n      return [this.id].concat(childStateIds);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"events\", {\n    /**\r\n     * All the event types accepted by this state node and its descendants.\r\n     */\n    get: function () {\n      var e_7, _a, e_8, _b;\n\n      if (this.__cache.events) {\n        return this.__cache.events;\n      }\n\n      var states = this.states;\n      var events = new Set(this.ownEvents);\n\n      if (states) {\n        try {\n          for (var _c = __values(keys(states)), _d = _c.next(); !_d.done; _d = _c.next()) {\n            var stateId = _d.value;\n            var state = states[stateId];\n\n            if (state.states) {\n              try {\n                for (var _e = (e_8 = void 0, __values(state.events)), _f = _e.next(); !_f.done; _f = _e.next()) {\n                  var event_1 = _f.value;\n                  events.add(\"\" + event_1);\n                }\n              } catch (e_8_1) {\n                e_8 = {\n                  error: e_8_1\n                };\n              } finally {\n                try {\n                  if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                } finally {\n                  if (e_8) throw e_8.error;\n                }\n              }\n            }\n          }\n        } catch (e_7_1) {\n          e_7 = {\n            error: e_7_1\n          };\n        } finally {\n          try {\n            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n          } finally {\n            if (e_7) throw e_7.error;\n          }\n        }\n      }\n\n      return this.__cache.events = Array.from(events);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"ownEvents\", {\n    /**\r\n     * All the events that have transitions directly from this state node.\r\n     *\r\n     * Excludes any inert events.\r\n     */\n    get: function () {\n      var events = new Set(this.transitions.filter(function (transition) {\n        return !(!transition.target && !transition.actions.length && transition.internal);\n      }).map(function (transition) {\n        return transition.eventType;\n      }));\n      return Array.from(events);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.resolveTarget = function (_target) {\n    var _this = this;\n\n    if (_target === undefined) {\n      // an undefined target signals that the state node should not transition from that state when receiving that event\n      return undefined;\n    }\n\n    return _target.map(function (target) {\n      if (!isString(target)) {\n        return target;\n      }\n\n      var isInternalTarget = target[0] === _this.delimiter; // If internal target is defined on machine,\n      // do not include machine key on target\n\n      if (isInternalTarget && !_this.parent) {\n        return _this.getStateNodeByPath(target.slice(1));\n      }\n\n      var resolvedTarget = isInternalTarget ? _this.key + target : target;\n\n      if (_this.parent) {\n        try {\n          var targetStateNode = _this.parent.getStateNodeByPath(resolvedTarget);\n\n          return targetStateNode;\n        } catch (err) {\n          throw new Error(\"Invalid transition definition for state node '\" + _this.id + \"':\\n\" + err.message);\n        }\n      } else {\n        return _this.getStateNodeByPath(resolvedTarget);\n      }\n    });\n  };\n\n  StateNode.prototype.formatTransition = function (transitionConfig) {\n    var _this = this;\n\n    var normalizedTarget = normalizeTarget(transitionConfig.target);\n    var internal = 'internal' in transitionConfig ? transitionConfig.internal : normalizedTarget ? normalizedTarget.some(function (_target) {\n      return isString(_target) && _target[0] === _this.delimiter;\n    }) : true;\n    var guards = this.machine.options.guards;\n    var target = this.resolveTarget(normalizedTarget);\n    return __assign(__assign({}, transitionConfig), {\n      actions: toActionObjects(toArray(transitionConfig.actions)),\n      cond: toGuard(transitionConfig.cond, guards),\n      target: target,\n      source: this,\n      internal: internal,\n      eventType: transitionConfig.event\n    });\n  };\n\n  StateNode.prototype.formatTransitions = function () {\n    var e_9, _a;\n\n    var _this = this;\n\n    var onConfig;\n\n    if (!this.config.on) {\n      onConfig = [];\n    } else if (Array.isArray(this.config.on)) {\n      onConfig = this.config.on;\n    } else {\n      var _b = this.config.on,\n          _c = WILDCARD,\n          _d = _b[_c],\n          wildcardConfigs = _d === void 0 ? [] : _d,\n          strictOnConfigs_1 = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n\n      onConfig = flatten(keys(strictOnConfigs_1).map(function (key) {\n        var arrayified = toTransitionConfigArray(key, strictOnConfigs_1[key]);\n\n        if (!IS_PRODUCTION) {\n          validateArrayifiedTransitions(_this, key, arrayified);\n        }\n\n        return arrayified;\n      }).concat(toTransitionConfigArray(WILDCARD, wildcardConfigs)));\n    }\n\n    var doneConfig = this.config.onDone ? toTransitionConfigArray(String(done(this.id)), this.config.onDone) : [];\n    var invokeConfig = flatten(this.invoke.map(function (invokeDef) {\n      var settleTransitions = [];\n\n      if (invokeDef.onDone) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(doneInvoke(invokeDef.id)), invokeDef.onDone)));\n      }\n\n      if (invokeDef.onError) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(error(invokeDef.id)), invokeDef.onError)));\n      }\n\n      return settleTransitions;\n    }));\n    var delayedTransitions = this.after;\n    var formattedTransitions = flatten(__spread(doneConfig, invokeConfig, onConfig).map(function (transitionConfig) {\n      return toArray(transitionConfig).map(function (transition) {\n        return _this.formatTransition(transition);\n      });\n    }));\n\n    try {\n      for (var delayedTransitions_1 = __values(delayedTransitions), delayedTransitions_1_1 = delayedTransitions_1.next(); !delayedTransitions_1_1.done; delayedTransitions_1_1 = delayedTransitions_1.next()) {\n        var delayedTransition = delayedTransitions_1_1.value;\n        formattedTransitions.push(delayedTransition);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (delayedTransitions_1_1 && !delayedTransitions_1_1.done && (_a = delayedTransitions_1.return)) _a.call(delayedTransitions_1);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    }\n\n    return formattedTransitions;\n  };\n\n  return StateNode;\n}();\n\nexport { StateNode };","import { StateNode } from './StateNode.js';\n\nfunction Machine(config, options, initialContext) {\n  if (initialContext === void 0) {\n    initialContext = config.context;\n  }\n\n  var resolvedInitialContext = typeof initialContext === 'function' ? initialContext() : initialContext;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nfunction createMachine(config, options) {\n  var resolvedInitialContext = typeof config.context === 'function' ? config.context() : config.context;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nexport { Machine, createMachine };","import { __assign } from './_virtual/_tslib.js';\nvar defaultOptions = {\n  deferEvents: false\n};\n\nvar Scheduler =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function Scheduler(options) {\n    this.processingEvent = false;\n    this.queue = [];\n    this.initialized = false;\n    this.options = __assign(__assign({}, defaultOptions), options);\n  }\n\n  Scheduler.prototype.initialize = function (callback) {\n    this.initialized = true;\n\n    if (callback) {\n      if (!this.options.deferEvents) {\n        this.schedule(callback);\n        return;\n      }\n\n      this.process(callback);\n    }\n\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.schedule = function (task) {\n    if (!this.initialized || this.processingEvent) {\n      this.queue.push(task);\n      return;\n    }\n\n    if (this.queue.length !== 0) {\n      throw new Error('Event queue should be empty when it is not processing events');\n    }\n\n    this.process(task);\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.clear = function () {\n    this.queue = [];\n  };\n\n  Scheduler.prototype.flushEvents = function () {\n    var nextCallback = this.queue.shift();\n\n    while (nextCallback) {\n      this.process(nextCallback);\n      nextCallback = this.queue.shift();\n    }\n  };\n\n  Scheduler.prototype.process = function (callback) {\n    this.processingEvent = true;\n\n    try {\n      callback();\n    } catch (e) {\n      // there is no use to keep the future events\n      // as the situation is not anymore the same\n      this.clear();\n      throw e;\n    } finally {\n      this.processingEvent = false;\n    }\n  };\n\n  return Scheduler;\n}();\n\nexport { Scheduler };","var children =\n/*#__PURE__*/\nnew Map();\nvar idMap =\n/*#__PURE__*/\nnew Map();\nvar sessionIdIndex = 0;\nvar registry = {\n  register: function (actor) {\n    var id = \"x:\" + sessionIdIndex++;\n    children.set(id, actor);\n    idMap.set(actor, id);\n    return id;\n  },\n  get: function (id) {\n    return children.get(id);\n  },\n  lookup: function (actorRef) {\n    return idMap.get(actorRef);\n  }\n};\nexport { registry };","import { IS_PRODUCTION } from './environment.js';\n\nfunction getDevTools() {\n  var w = window;\n\n  if (!!w.__xstate__) {\n    return w.__xstate__;\n  }\n\n  return undefined;\n}\n\nfunction registerService(service) {\n  if (IS_PRODUCTION || typeof window === 'undefined') {\n    return;\n  }\n\n  var devTools = getDevTools();\n\n  if (devTools) {\n    devTools.register(service);\n  }\n}\n\nexport { registerService };","import { __values, __assign, __spread } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { warn, mapContext, isFunction, keys, toSCXMLEvent, isPromiseLike, isObservable, isMachine, reportUnhandledExceptionOnInvocation, symbolObservable, isArray, toEventObject, isString, uniqueId } from './utils.js';\nimport { ActionTypes, SpecialTargets } from './types.js';\nimport { isInFinalState } from './stateUtils.js';\nimport { errorPlatform, log, stop, start, cancel, send, update, error as error$1 } from './actionTypes.js';\nimport { doneInvoke, initEvent, getActionFunction, error } from './actions.js';\nimport { isState, State, bindActionToState } from './State.js';\nimport { isActor } from './Actor.js';\nimport { Scheduler } from './scheduler.js';\nimport { registry } from './registry.js';\nimport { registerService } from './devTools.js';\nvar DEFAULT_SPAWN_OPTIONS = {\n  sync: false,\n  autoForward: false\n};\n/**\r\n * Maintains a stack of the current service in scope.\r\n * This is used to provide the correct service to spawn().\r\n *\r\n * @private\r\n */\n\nvar withServiceScope =\n/*#__PURE__*/\nfunction () {\n  var serviceStack = [];\n  return function (service, fn) {\n    service && serviceStack.push(service);\n    var result = fn(service || serviceStack[serviceStack.length - 1]);\n    service && serviceStack.pop();\n    return result;\n  };\n}();\n\nvar InterpreterStatus;\n\n(function (InterpreterStatus) {\n  InterpreterStatus[InterpreterStatus[\"NotStarted\"] = 0] = \"NotStarted\";\n  InterpreterStatus[InterpreterStatus[\"Running\"] = 1] = \"Running\";\n  InterpreterStatus[InterpreterStatus[\"Stopped\"] = 2] = \"Stopped\";\n})(InterpreterStatus || (InterpreterStatus = {}));\n\nvar Interpreter =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new Interpreter instance (i.e., service) for the given machine with the provided options, if any.\r\n   *\r\n   * @param machine The machine to be interpreted\r\n   * @param options Interpreter options\r\n   */\n  function Interpreter(machine, options, sessionId) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = Interpreter.defaultOptions;\n    }\n\n    this.machine = machine;\n    this.scheduler = new Scheduler();\n    this.delayedEventsMap = {};\n    this.listeners = new Set();\n    this.contextListeners = new Set();\n    this.stopListeners = new Set();\n    this.doneListeners = new Set();\n    this.eventListeners = new Set();\n    this.sendListeners = new Set();\n    /**\r\n     * Whether the service is started.\r\n     */\n\n    this.initialized = false;\n    this._status = InterpreterStatus.NotStarted;\n    this.children = new Map();\n    this.forwardTo = new Set();\n    /**\r\n     * Alias for Interpreter.prototype.start\r\n     */\n\n    this.init = this.start;\n    /**\r\n     * Sends an event to the running interpreter to trigger a transition.\r\n     *\r\n     * An array of events (batched) can be sent as well, which will send all\r\n     * batched events to the running interpreter. The listeners will be\r\n     * notified only **once** when all events are processed.\r\n     *\r\n     * @param event The event(s) to send\r\n     */\n\n    this.send = function (event, payload) {\n      if (isArray(event)) {\n        _this.batch(event);\n\n        return _this.state;\n      }\n\n      var _event = toSCXMLEvent(toEventObject(event, payload));\n\n      if (_this._status === InterpreterStatus.Stopped) {\n        // do nothing\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to stopped service \\\"\" + _this.machine.id + \"\\\". This service has already reached its final state, and will not transition.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n\n        return _this.state;\n      }\n\n      if (_this._status === InterpreterStatus.NotStarted && _this.options.deferEvents) {\n        // tslint:disable-next-line:no-console\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\" and is deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n      } else if (_this._status !== InterpreterStatus.Running) {\n        throw new Error(\"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\\nEvent: \" + JSON.stringify(_event.data));\n      }\n\n      _this.scheduler.schedule(function () {\n        // Forward copy of event to child actors\n        _this.forward(_event);\n\n        var nextState = _this.nextState(_event);\n\n        _this.update(nextState, _event);\n      });\n\n      return _this._state; // TODO: deprecate (should return void)\n      // tslint:disable-next-line:semicolon\n    };\n\n    this.sendTo = function (event, to) {\n      var isParent = _this.parent && (to === SpecialTargets.Parent || _this.parent.id === to);\n      var target = isParent ? _this.parent : isActor(to) ? to : _this.children.get(to) || registry.get(to);\n\n      if (!target) {\n        if (!isParent) {\n          throw new Error(\"Unable to send event to child '\" + to + \"' from service '\" + _this.id + \"'.\");\n        } // tslint:disable-next-line:no-console\n\n\n        if (!IS_PRODUCTION) {\n          warn(false, \"Service '\" + _this.id + \"' has no parent: unable to send event \" + event.type);\n        }\n\n        return;\n      }\n\n      if ('machine' in target) {\n        // Send SCXML events to machines\n        target.send(__assign(__assign({}, event), {\n          name: event.name === error$1 ? \"\" + error(_this.id) : event.name,\n          origin: _this.sessionId\n        }));\n      } else {\n        // Send normal events to other targets\n        target.send(event.data);\n      }\n    };\n\n    var resolvedOptions = __assign(__assign({}, Interpreter.defaultOptions), options);\n\n    var clock = resolvedOptions.clock,\n        logger = resolvedOptions.logger,\n        parent = resolvedOptions.parent,\n        id = resolvedOptions.id;\n    var resolvedId = id !== undefined ? id : machine.id;\n    this.id = resolvedId;\n    this.logger = logger;\n    this.clock = clock;\n    this.parent = parent;\n    this.options = resolvedOptions;\n    this.scheduler = new Scheduler({\n      deferEvents: this.options.deferEvents\n    });\n    this.sessionId = sessionId !== undefined ? sessionId : registry.register(this);\n  }\n\n  Object.defineProperty(Interpreter.prototype, \"initialState\", {\n    get: function () {\n      var _this = this;\n\n      if (this._initialState) {\n        return this._initialState;\n      }\n\n      return withServiceScope(this, function () {\n        _this._initialState = _this.machine.initialState;\n        return _this._initialState;\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Interpreter.prototype, \"state\", {\n    get: function () {\n      if (!IS_PRODUCTION) {\n        warn(this._status !== InterpreterStatus.NotStarted, \"Attempted to read state from uninitialized service '\" + this.id + \"'. Make sure the service is started first.\");\n      }\n\n      return this._state;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Executes the actions of the given state, with that state's `context` and `event`.\r\n   *\r\n   * @param state The state whose actions will be executed\r\n   * @param actionsConfig The action implementations to use\r\n   */\n\n  Interpreter.prototype.execute = function (state, actionsConfig) {\n    var e_1, _a;\n\n    try {\n      for (var _b = __values(state.actions), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var action = _c.value;\n        this.exec(action, state, actionsConfig);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.update = function (state, _event) {\n    var e_2, _a, e_3, _b, e_4, _c, e_5, _d;\n\n    var _this = this; // Attach session ID to state\n\n\n    state._sessionid = this.sessionId; // Update state\n\n    this._state = state; // Execute actions\n\n    if (this.options.execute) {\n      this.execute(this.state);\n    } // Dev tools\n\n\n    if (this.devTools) {\n      this.devTools.send(_event.data, state);\n    } // Execute listeners\n\n\n    if (state.event) {\n      try {\n        for (var _e = __values(this.eventListeners), _f = _e.next(); !_f.done; _f = _e.next()) {\n          var listener = _f.value;\n          listener(state.event);\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_f && !_f.done && (_a = _e.return)) _a.call(_e);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    }\n\n    try {\n      for (var _g = __values(this.listeners), _h = _g.next(); !_h.done; _h = _g.next()) {\n        var listener = _h.value;\n        listener(state, state.event);\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_h && !_h.done && (_b = _g.return)) _b.call(_g);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    try {\n      for (var _j = __values(this.contextListeners), _k = _j.next(); !_k.done; _k = _j.next()) {\n        var contextListener = _k.value;\n        contextListener(this.state.context, this.state.history ? this.state.history.context : undefined);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_k && !_k.done && (_c = _j.return)) _c.call(_j);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    var isDone = isInFinalState(state.configuration || [], this.machine);\n\n    if (this.state.configuration && isDone) {\n      // get final child state node\n      var finalChildStateNode = state.configuration.find(function (sn) {\n        return sn.type === 'final' && sn.parent === _this.machine;\n      });\n      var doneData = finalChildStateNode && finalChildStateNode.data ? mapContext(finalChildStateNode.data, state.context, _event) : undefined;\n\n      try {\n        for (var _l = __values(this.doneListeners), _m = _l.next(); !_m.done; _m = _l.next()) {\n          var listener = _m.value;\n          listener(doneInvoke(this.id, doneData));\n        }\n      } catch (e_5_1) {\n        e_5 = {\n          error: e_5_1\n        };\n      } finally {\n        try {\n          if (_m && !_m.done && (_d = _l.return)) _d.call(_l);\n        } finally {\n          if (e_5) throw e_5.error;\n        }\n      }\n\n      this.stop();\n    }\n  };\n  /*\r\n   * Adds a listener that is notified whenever a state transition happens. The listener is called with\r\n   * the next state and the event object that caused the state transition.\r\n   *\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onTransition = function (listener) {\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state, this.state.event);\n    }\n\n    return this;\n  };\n\n  Interpreter.prototype.subscribe = function (nextListenerOrObserver, // @ts-ignore\n  errorListener, completeListener) {\n    var _this = this;\n\n    if (!nextListenerOrObserver) {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    }\n\n    var listener;\n    var resolvedCompleteListener = completeListener;\n\n    if (typeof nextListenerOrObserver === 'function') {\n      listener = nextListenerOrObserver;\n    } else {\n      listener = nextListenerOrObserver.next.bind(nextListenerOrObserver);\n      resolvedCompleteListener = nextListenerOrObserver.complete.bind(nextListenerOrObserver);\n    }\n\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state);\n    }\n\n    if (resolvedCompleteListener) {\n      this.onDone(resolvedCompleteListener);\n    }\n\n    return {\n      unsubscribe: function () {\n        listener && _this.listeners.delete(listener);\n        resolvedCompleteListener && _this.doneListeners.delete(resolvedCompleteListener);\n      }\n    };\n  };\n  /**\r\n   * Adds an event listener that is notified whenever an event is sent to the running interpreter.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onEvent = function (listener) {\n    this.eventListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds an event listener that is notified whenever a `send` event occurs.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onSend = function (listener) {\n    this.sendListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a context listener that is notified whenever the state context changes.\r\n   * @param listener The context listener\r\n   */\n\n\n  Interpreter.prototype.onChange = function (listener) {\n    this.contextListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a listener that is notified when the machine is stopped.\r\n   * @param listener The listener\r\n   */\n\n\n  Interpreter.prototype.onStop = function (listener) {\n    this.stopListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a state listener that is notified when the statechart has reached its final state.\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onDone = function (listener) {\n    this.doneListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Removes a listener.\r\n   * @param listener The listener to remove\r\n   */\n\n\n  Interpreter.prototype.off = function (listener) {\n    this.listeners.delete(listener);\n    this.eventListeners.delete(listener);\n    this.sendListeners.delete(listener);\n    this.stopListeners.delete(listener);\n    this.doneListeners.delete(listener);\n    this.contextListeners.delete(listener);\n    return this;\n  };\n  /**\r\n   * Starts the interpreter from the given state, or the initial state.\r\n   * @param initialState The state to start the statechart from\r\n   */\n\n\n  Interpreter.prototype.start = function (initialState) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.Running) {\n      // Do not restart the service if it is already started\n      return this;\n    }\n\n    this.initialized = true;\n    this._status = InterpreterStatus.Running;\n    var resolvedState = initialState === undefined ? this.initialState : withServiceScope(this, function () {\n      return isState(initialState) ? _this.machine.resolveState(initialState) : _this.machine.resolveState(State.from(initialState, _this.machine.context));\n    });\n\n    if (this.options.devTools) {\n      this.attachDev();\n    }\n\n    this.scheduler.initialize(function () {\n      _this.update(resolvedState, initEvent);\n    });\n    return this;\n  };\n  /**\r\n   * Stops the interpreter and unsubscribe all listeners.\r\n   *\r\n   * This will also notify the `onStop` listeners.\r\n   */\n\n\n  Interpreter.prototype.stop = function () {\n    var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;\n\n    try {\n      for (var _f = __values(this.listeners), _g = _f.next(); !_g.done; _g = _f.next()) {\n        var listener = _g.value;\n        this.listeners.delete(listener);\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (_g && !_g.done && (_a = _f.return)) _a.call(_f);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    try {\n      for (var _h = __values(this.stopListeners), _j = _h.next(); !_j.done; _j = _h.next()) {\n        var listener = _j.value; // call listener, then remove\n\n        listener();\n        this.stopListeners.delete(listener);\n      }\n    } catch (e_7_1) {\n      e_7 = {\n        error: e_7_1\n      };\n    } finally {\n      try {\n        if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\n      } finally {\n        if (e_7) throw e_7.error;\n      }\n    }\n\n    try {\n      for (var _k = __values(this.contextListeners), _l = _k.next(); !_l.done; _l = _k.next()) {\n        var listener = _l.value;\n        this.contextListeners.delete(listener);\n      }\n    } catch (e_8_1) {\n      e_8 = {\n        error: e_8_1\n      };\n    } finally {\n      try {\n        if (_l && !_l.done && (_c = _k.return)) _c.call(_k);\n      } finally {\n        if (e_8) throw e_8.error;\n      }\n    }\n\n    try {\n      for (var _m = __values(this.doneListeners), _o = _m.next(); !_o.done; _o = _m.next()) {\n        var listener = _o.value;\n        this.doneListeners.delete(listener);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (_o && !_o.done && (_d = _m.return)) _d.call(_m);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    } // Stop all children\n\n\n    this.children.forEach(function (child) {\n      if (isFunction(child.stop)) {\n        child.stop();\n      }\n    });\n\n    try {\n      // Cancel all delayed events\n      for (var _p = __values(keys(this.delayedEventsMap)), _q = _p.next(); !_q.done; _q = _p.next()) {\n        var key = _q.value;\n        this.clock.clearTimeout(this.delayedEventsMap[key]);\n      }\n    } catch (e_10_1) {\n      e_10 = {\n        error: e_10_1\n      };\n    } finally {\n      try {\n        if (_q && !_q.done && (_e = _p.return)) _e.call(_p);\n      } finally {\n        if (e_10) throw e_10.error;\n      }\n    }\n\n    this.scheduler.clear();\n    this.initialized = false;\n    this._status = InterpreterStatus.Stopped;\n    return this;\n  };\n\n  Interpreter.prototype.batch = function (events) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.NotStarted && this.options.deferEvents) {\n      // tslint:disable-next-line:no-console\n      if (!IS_PRODUCTION) {\n        warn(false, events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\" and are deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(event));\n      }\n    } else if (this._status !== InterpreterStatus.Running) {\n      throw new Error( // tslint:disable-next-line:max-line-length\n      events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\");\n    }\n\n    this.scheduler.schedule(function () {\n      var e_11, _a;\n\n      var nextState = _this.state;\n      var batchChanged = false;\n      var batchedActions = [];\n\n      var _loop_1 = function (event_1) {\n        var _event = toSCXMLEvent(event_1);\n\n        _this.forward(_event);\n\n        nextState = withServiceScope(_this, function () {\n          return _this.machine.transition(nextState, _event);\n        });\n        batchedActions.push.apply(batchedActions, __spread(nextState.actions.map(function (a) {\n          return bindActionToState(a, nextState);\n        })));\n        batchChanged = batchChanged || !!nextState.changed;\n      };\n\n      try {\n        for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {\n          var event_1 = events_1_1.value;\n\n          _loop_1(event_1);\n        }\n      } catch (e_11_1) {\n        e_11 = {\n          error: e_11_1\n        };\n      } finally {\n        try {\n          if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);\n        } finally {\n          if (e_11) throw e_11.error;\n        }\n      }\n\n      nextState.changed = batchChanged;\n      nextState.actions = batchedActions;\n\n      _this.update(nextState, toSCXMLEvent(events[events.length - 1]));\n    });\n  };\n  /**\r\n   * Returns a send function bound to this interpreter instance.\r\n   *\r\n   * @param event The event to be sent by the sender.\r\n   */\n\n\n  Interpreter.prototype.sender = function (event) {\n    return this.send.bind(this, event);\n  };\n  /**\r\n   * Returns the next state given the interpreter's current state and the event.\r\n   *\r\n   * This is a pure method that does _not_ update the interpreter's state.\r\n   *\r\n   * @param event The event to determine the next state\r\n   */\n\n\n  Interpreter.prototype.nextState = function (event) {\n    var _this = this;\n\n    var _event = toSCXMLEvent(event);\n\n    if (_event.name.indexOf(errorPlatform) === 0 && !this.state.nextEvents.some(function (nextEvent) {\n      return nextEvent.indexOf(errorPlatform) === 0;\n    })) {\n      throw _event.data.data;\n    }\n\n    var nextState = withServiceScope(this, function () {\n      return _this.machine.transition(_this.state, _event);\n    });\n    return nextState;\n  };\n\n  Interpreter.prototype.forward = function (event) {\n    var e_12, _a;\n\n    try {\n      for (var _b = __values(this.forwardTo), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var id = _c.value;\n        var child = this.children.get(id);\n\n        if (!child) {\n          throw new Error(\"Unable to forward event '\" + event + \"' from interpreter '\" + this.id + \"' to nonexistant child '\" + id + \"'.\");\n        }\n\n        child.send(event);\n      }\n    } catch (e_12_1) {\n      e_12 = {\n        error: e_12_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_12) throw e_12.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.defer = function (sendAction) {\n    var _this = this;\n\n    this.delayedEventsMap[sendAction.id] = this.clock.setTimeout(function () {\n      if (sendAction.to) {\n        _this.sendTo(sendAction._event, sendAction.to);\n      } else {\n        _this.send(sendAction._event);\n      }\n    }, sendAction.delay);\n  };\n\n  Interpreter.prototype.cancel = function (sendId) {\n    this.clock.clearTimeout(this.delayedEventsMap[sendId]);\n    delete this.delayedEventsMap[sendId];\n  };\n\n  Interpreter.prototype.exec = function (action, state, actionFunctionMap) {\n    var context = state.context,\n        _event = state._event;\n    var actionOrExec = getActionFunction(action.type, actionFunctionMap) || action.exec;\n    var exec = isFunction(actionOrExec) ? actionOrExec : actionOrExec ? actionOrExec.exec : action.exec;\n\n    if (exec) {\n      try {\n        return exec(context, _event.data, {\n          action: action,\n          state: this.state,\n          _event: _event\n        });\n      } catch (err) {\n        if (this.parent) {\n          this.parent.send({\n            type: 'xstate.error',\n            data: err\n          });\n        }\n\n        throw err;\n      }\n    }\n\n    switch (action.type) {\n      case send:\n        var sendAction = action;\n\n        if (typeof sendAction.delay === 'number') {\n          this.defer(sendAction);\n          return;\n        } else {\n          if (sendAction.to) {\n            this.sendTo(sendAction._event, sendAction.to);\n          } else {\n            this.send(sendAction._event);\n          }\n        }\n\n        break;\n\n      case cancel:\n        this.cancel(action.sendId);\n        break;\n\n      case start:\n        {\n          var activity = action.activity; // If the activity will be stopped right after it's started\n          // (such as in transient states)\n          // don't bother starting the activity.\n\n          if (!this.state.activities[activity.type]) {\n            break;\n          } // Invoked services\n\n\n          if (activity.type === ActionTypes.Invoke) {\n            var serviceCreator = this.machine.options.services ? this.machine.options.services[activity.src] : undefined;\n            var id = activity.id,\n                data = activity.data;\n\n            if (!IS_PRODUCTION) {\n              warn(!('forward' in activity), // tslint:disable-next-line:max-line-length\n              \"`forward` property is deprecated (found in invocation of '\" + activity.src + \"' in in machine '\" + this.machine.id + \"'). \" + \"Please use `autoForward` instead.\");\n            }\n\n            var autoForward = 'autoForward' in activity ? activity.autoForward : !!activity.forward;\n\n            if (!serviceCreator) {\n              // tslint:disable-next-line:no-console\n              if (!IS_PRODUCTION) {\n                warn(false, \"No service found for invocation '\" + activity.src + \"' in machine '\" + this.machine.id + \"'.\");\n              }\n\n              return;\n            }\n\n            var source = isFunction(serviceCreator) ? serviceCreator(context, _event.data) : serviceCreator;\n\n            if (isPromiseLike(source)) {\n              this.state.children[id] = this.spawnPromise(Promise.resolve(source), id);\n            } else if (isFunction(source)) {\n              this.state.children[id] = this.spawnCallback(source, id);\n            } else if (isObservable(source)) {\n              this.state.children[id] = this.spawnObservable(source, id);\n            } else if (isMachine(source)) {\n              // TODO: try/catch here\n              this.state.children[id] = this.spawnMachine(data ? source.withContext(mapContext(data, context, _event)) : source, {\n                id: id,\n                autoForward: autoForward\n              });\n            }\n          } else {\n            this.spawnActivity(activity);\n          }\n\n          break;\n        }\n\n      case stop:\n        {\n          this.stopChild(action.activity.id);\n          break;\n        }\n\n      case log:\n        var label = action.label,\n            value = action.value;\n\n        if (label) {\n          this.logger(label, value);\n        } else {\n          this.logger(value);\n        }\n\n        break;\n\n      default:\n        if (!IS_PRODUCTION) {\n          warn(false, \"No implementation found for action type '\" + action.type + \"'\");\n        }\n\n        break;\n    }\n\n    return undefined;\n  };\n\n  Interpreter.prototype.stopChild = function (childId) {\n    var child = this.children.get(childId);\n\n    if (!child) {\n      return;\n    }\n\n    this.children.delete(childId);\n    this.forwardTo.delete(childId);\n    delete this.state.children[childId];\n\n    if (isFunction(child.stop)) {\n      child.stop();\n    }\n  };\n\n  Interpreter.prototype.spawn = function (entity, name, options) {\n    if (isPromiseLike(entity)) {\n      return this.spawnPromise(Promise.resolve(entity), name);\n    } else if (isFunction(entity)) {\n      return this.spawnCallback(entity, name);\n    } else if (isActor(entity)) {\n      return this.spawnActor(entity);\n    } else if (isObservable(entity)) {\n      return this.spawnObservable(entity, name);\n    } else if (isMachine(entity)) {\n      return this.spawnMachine(entity, __assign(__assign({}, options), {\n        id: name\n      }));\n    } else {\n      throw new Error(\"Unable to spawn entity \\\"\" + name + \"\\\" of type \\\"\" + typeof entity + \"\\\".\");\n    }\n  };\n\n  Interpreter.prototype.spawnMachine = function (machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var childService = new Interpreter(machine, __assign(__assign({}, this.options), {\n      parent: this,\n      id: options.id || machine.id\n    }));\n\n    var resolvedOptions = __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), options);\n\n    if (resolvedOptions.sync) {\n      childService.onTransition(function (state) {\n        _this.send(update, {\n          state: state,\n          id: childService.id\n        });\n      });\n    }\n\n    childService.onDone(function (doneEvent) {\n      _this.send(toSCXMLEvent(doneEvent, {\n        origin: childService.id\n      }));\n    }).start();\n    var actor = childService;\n    this.children.set(childService.id, actor);\n\n    if (resolvedOptions.autoForward) {\n      this.forwardTo.add(childService.id);\n    }\n\n    return actor;\n  };\n\n  Interpreter.prototype.spawnPromise = function (promise, id) {\n    var _this = this;\n\n    var canceled = false;\n    promise.then(function (response) {\n      if (!canceled) {\n        _this.send(toSCXMLEvent(doneInvoke(id, response), {\n          origin: id\n        }));\n      }\n    }, function (errorData) {\n      if (!canceled) {\n        var errorEvent = error(id, errorData);\n\n        try {\n          // Send \"error.platform.id\" to this (parent).\n          _this.send(toSCXMLEvent(errorEvent, {\n            origin: id\n          }));\n        } catch (error) {\n          reportUnhandledExceptionOnInvocation(errorData, error, id);\n\n          if (_this.devTools) {\n            _this.devTools.send(errorEvent, _this.state);\n          }\n\n          if (_this.machine.strict) {\n            // it would be better to always stop the state machine if unhandled\n            // exception/promise rejection happens but because we don't want to\n            // break existing code so enforce it on strict mode only especially so\n            // because documentation says that onError is optional\n            _this.stop();\n          }\n        }\n      }\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        var unsubscribed = false;\n        promise.then(function (response) {\n          if (unsubscribed) {\n            return;\n          }\n\n          next && next(response);\n\n          if (unsubscribed) {\n            return;\n          }\n\n          complete && complete();\n        }, function (err) {\n          if (unsubscribed) {\n            return;\n          }\n\n          handleError(err);\n        });\n        return {\n          unsubscribe: function () {\n            return unsubscribed = true;\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnCallback = function (callback, id) {\n    var _this = this;\n\n    var canceled = false;\n    var receivers = new Set();\n    var listeners = new Set();\n\n    var receive = function (e) {\n      listeners.forEach(function (listener) {\n        return listener(e);\n      });\n\n      if (canceled) {\n        return;\n      }\n\n      _this.send(e);\n    };\n\n    var callbackStop;\n\n    try {\n      callbackStop = callback(receive, function (newListener) {\n        receivers.add(newListener);\n      });\n    } catch (err) {\n      this.send(error(id, err));\n    }\n\n    if (isPromiseLike(callbackStop)) {\n      // it turned out to be an async function, can't reliably check this before calling `callback`\n      // because transpiled async functions are not recognizable\n      return this.spawnPromise(callbackStop, id);\n    }\n\n    var actor = {\n      id: id,\n      send: function (event) {\n        return receivers.forEach(function (receiver) {\n          return receiver(event);\n        });\n      },\n      subscribe: function (next) {\n        listeners.add(next);\n        return {\n          unsubscribe: function () {\n            listeners.delete(next);\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n\n        if (isFunction(callbackStop)) {\n          callbackStop();\n        }\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnObservable = function (source, id) {\n    var _this = this;\n\n    var subscription = source.subscribe(function (value) {\n      _this.send(toSCXMLEvent(value, {\n        origin: id\n      }));\n    }, function (err) {\n      _this.send(toSCXMLEvent(error(id, err), {\n        origin: id\n      }));\n    }, function () {\n      _this.send(toSCXMLEvent(doneInvoke(id), {\n        origin: id\n      }));\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        return source.subscribe(next, handleError, complete);\n      },\n      stop: function () {\n        return subscription.unsubscribe();\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActor = function (actor) {\n    this.children.set(actor.id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActivity = function (activity) {\n    var implementation = this.machine.options && this.machine.options.activities ? this.machine.options.activities[activity.type] : undefined;\n\n    if (!implementation) {\n      if (!IS_PRODUCTION) {\n        warn(false, \"No implementation found for activity '\" + activity.type + \"'\");\n      } // tslint:disable-next-line:no-console\n\n\n      return;\n    } // Start implementation\n\n\n    var dispose = implementation(this.state.context, activity);\n    this.spawnEffect(activity.id, dispose);\n  };\n\n  Interpreter.prototype.spawnEffect = function (id, dispose) {\n    this.children.set(id, {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function () {\n        return {\n          unsubscribe: function () {\n            return void 0;\n          }\n        };\n      },\n      stop: dispose || undefined,\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    });\n  };\n\n  Interpreter.prototype.attachDev = function () {\n    if (this.options.devTools && typeof window !== 'undefined') {\n      if (window.__REDUX_DEVTOOLS_EXTENSION__) {\n        var devToolsOptions = typeof this.options.devTools === 'object' ? this.options.devTools : undefined;\n        this.devTools = window.__REDUX_DEVTOOLS_EXTENSION__.connect(__assign(__assign({\n          name: this.id,\n          autoPause: true,\n          stateSanitizer: function (state) {\n            return {\n              value: state.value,\n              context: state.context,\n              actions: state.actions\n            };\n          }\n        }, devToolsOptions), {\n          features: __assign({\n            jump: false,\n            skip: false\n          }, devToolsOptions ? devToolsOptions.features : undefined)\n        }), this.machine);\n        this.devTools.init(this.state);\n      } // add XState-specific dev tooling hook\n\n\n      registerService(this);\n    }\n  };\n\n  Interpreter.prototype.toJSON = function () {\n    return {\n      id: this.id\n    };\n  };\n\n  Interpreter.prototype[symbolObservable] = function () {\n    return this;\n  };\n  /**\r\n   * The default interpreter options:\r\n   *\r\n   * - `clock` uses the global `setTimeout` and `clearTimeout` functions\r\n   * - `logger` uses the global `console.log()` method\r\n   */\n\n\n  Interpreter.defaultOptions =\n  /*#__PURE__*/\n  function (global) {\n    return {\n      execute: true,\n      deferEvents: true,\n      clock: {\n        setTimeout: function (fn, ms) {\n          return global.setTimeout.call(null, fn, ms);\n        },\n        clearTimeout: function (id) {\n          return global.clearTimeout.call(null, id);\n        }\n      },\n      logger: global.console.log.bind(console),\n      devTools: false\n    };\n  }(typeof window === 'undefined' ? global : window);\n\n  Interpreter.interpret = interpret;\n  return Interpreter;\n}();\n\nvar createNullActor = function (name) {\n  if (name === void 0) {\n    name = 'null';\n  }\n\n  return {\n    id: name,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      // tslint:disable-next-line:no-empty\n      return {\n        unsubscribe: function () {}\n      };\n    },\n    toJSON: function () {\n      return {\n        id: name\n      };\n    }\n  };\n};\n\nvar resolveSpawnOptions = function (nameOrOptions) {\n  if (isString(nameOrOptions)) {\n    return __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n      name: nameOrOptions\n    });\n  }\n\n  return __assign(__assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n    name: uniqueId()\n  }), nameOrOptions);\n};\n\nfunction spawn(entity, nameOrOptions) {\n  var resolvedOptions = resolveSpawnOptions(nameOrOptions);\n  return withServiceScope(undefined, function (service) {\n    if (!IS_PRODUCTION) {\n      warn(!!service, \"Attempted to spawn an Actor (ID: \\\"\" + (isMachine(entity) ? entity.id : 'undefined') + \"\\\") outside of a service. This will have no effect.\");\n    }\n\n    if (service) {\n      return service.spawn(entity, resolvedOptions.name, resolvedOptions);\n    } else {\n      return createNullActor(resolvedOptions.name);\n    }\n  });\n}\n/**\r\n * Creates a new Interpreter instance for the given machine with the provided options, if any.\r\n *\r\n * @param machine The machine to interpret\r\n * @param options Interpreter options\r\n */\n\n\nfunction interpret(machine, options) {\n  var interpreter = new Interpreter(machine, options);\n  return interpreter;\n}\n\nexport { Interpreter, interpret, spawn };","import { __values, __read } from './_virtual/_tslib.js';\nimport { State } from './State.js';\n\nfunction matchState(state, patterns, defaultValue) {\n  var e_1, _a;\n\n  var resolvedState = State.from(state, state instanceof State ? state.context : undefined);\n\n  try {\n    for (var patterns_1 = __values(patterns), patterns_1_1 = patterns_1.next(); !patterns_1_1.done; patterns_1_1 = patterns_1.next()) {\n      var _b = __read(patterns_1_1.value, 2),\n          stateValue = _b[0],\n          getValue = _b[1];\n\n      if (resolvedState.matches(stateValue)) {\n        return getValue(resolvedState);\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (patterns_1_1 && !patterns_1_1.done && (_a = patterns_1.return)) _a.call(patterns_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return defaultValue(resolvedState);\n}\n\nexport { matchState };","export { matchesState } from './utils.js';\nexport { mapState } from './mapState.js';\nexport { ActionTypes, SpecialTargets } from './types.js';\nimport { raise, send, sendParent, sendUpdate, log, cancel, start, stop, assign, after, done, respond, forwardTo, escalate } from './actions.js';\nexport { assign, doneInvoke, forwardTo, send, sendParent, sendUpdate } from './actions.js';\nexport { State } from './State.js';\nexport { StateNode } from './StateNode.js';\nexport { Machine, createMachine } from './Machine.js';\nexport { Interpreter, interpret, spawn } from './interpreter.js';\nexport { matchState } from './match.js';\nvar actions = {\n  raise: raise,\n  send: send,\n  sendParent: sendParent,\n  sendUpdate: sendUpdate,\n  log: log,\n  cancel: cancel,\n  start: start,\n  stop: stop,\n  assign: assign,\n  after: after,\n  done: done,\n  respond: respond,\n  forwardTo: forwardTo,\n  escalate: escalate\n};\nexport { actions };","import { Machine, interpret } from \"xstate\";\r\nimport { IndexState, IndexEvent } from \"./interfaces\";\r\n\r\nexport function createStateMachine(\r\n  machine,\r\n  onTransition: (state: IndexState) => void = (state) => {}\r\n) {\r\n  let interpreter = interpret(machine)\r\n    .onTransition((state) => onTransition(state?.value as IndexState))\r\n    // .onTransition((state) => console.log(\"State Transition\", state?.value))\r\n    .start();\r\n\r\n  return interpreter;\r\n}\r\n\r\nexport function createMachineConfig(reIndex, query, indexingDelay = 750) {\r\n  return Machine({\r\n    id: \"indexer\",\r\n    initial: IndexState.IDLE,\r\n    states: {\r\n      [IndexState.STALE]: {\r\n        on: {\r\n          [IndexEvent.INDEX_START]: IndexState.PENDING,\r\n        },\r\n        after: {\r\n          [indexingDelay]: IndexState.PENDING,\r\n        },\r\n      },\r\n      [IndexState.PENDING]: {\r\n        on: {\r\n          [IndexEvent.INVALIDATE]: IndexState.STALE,\r\n        },\r\n        invoke: {\r\n          id: \"reindex\",\r\n          src: () => reIndex(),\r\n          onDone: {\r\n            target: IndexState.QUERYING,\r\n          },\r\n          onError: {\r\n            target: IndexState.FAILED,\r\n            actions: (context, event) => console.log(\"INDEX ERROR\", event.data),\r\n          },\r\n        },\r\n      },\r\n      [IndexState.QUERYING]: {\r\n        on: {\r\n          [IndexEvent.INVALIDATE]: IndexState.STALE,\r\n          [IndexEvent.QUERY_START]: IndexState.QUERYING,\r\n        },\r\n        invoke: {\r\n          id: \"query\",\r\n          src: () => query(),\r\n          onDone: {\r\n            target: IndexState.IDLE,\r\n          },\r\n          onError: {\r\n            target: IndexState.FAILED,\r\n            actions: (context, event) => console.log(\"QUERY ERROR\", event.data),\r\n          },\r\n        },\r\n      },\r\n      [IndexState.IDLE]: {\r\n        on: {\r\n          [IndexEvent.INVALIDATE]: IndexState.STALE,\r\n          [IndexEvent.QUERY_START]: IndexState.QUERYING,\r\n        },\r\n      },\r\n      [IndexState.FAILED]: {\r\n        on: {\r\n          [IndexEvent.INVALIDATE]: IndexState.STALE,\r\n          [IndexEvent.RETRY]: IndexState.PENDING,\r\n        },\r\n      },\r\n    },\r\n  });\r\n}\r\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var Symbol = require('./_Symbol'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray');\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nmodule.exports = isFlattenable;\n","var arrayPush = require('./_arrayPush'),\n    isFlattenable = require('./_isFlattenable');\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseFlatten;\n","var baseFlatten = require('./_baseFlatten');\n\n/**\n * Flattens `array` a single level deep.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flatten([1, [2, [3, [4]], 5]]);\n * // => [1, 2, [3, [4]], 5]\n */\nfunction flatten(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, 1) : [];\n}\n\nmodule.exports = flatten;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = baseFindIndex;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nmodule.exports = baseIsNaN;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = strictIndexOf;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIsNaN = require('./_baseIsNaN'),\n    strictIndexOf = require('./_strictIndexOf');\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nmodule.exports = baseIndexOf;\n","var baseIndexOf = require('./_baseIndexOf');\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nmodule.exports = arrayIncludes;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arrayIncludesWith;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nmodule.exports = noop;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","var Set = require('./_Set'),\n    noop = require('./noop'),\n    setToArray = require('./_setToArray');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nmodule.exports = createSet;\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    cacheHas = require('./_cacheHas'),\n    createSet = require('./_createSet'),\n    setToArray = require('./_setToArray');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseUniq;\n","var baseUniq = require('./_baseUniq');\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nmodule.exports = uniq;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * The base implementation of methods like `_.intersection`, without support\n * for iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of shared values.\n */\nfunction baseIntersection(arrays, iteratee, comparator) {\n  var includes = comparator ? arrayIncludesWith : arrayIncludes,\n      length = arrays[0].length,\n      othLength = arrays.length,\n      othIndex = othLength,\n      caches = Array(othLength),\n      maxLength = Infinity,\n      result = [];\n\n  while (othIndex--) {\n    var array = arrays[othIndex];\n    if (othIndex && iteratee) {\n      array = arrayMap(array, baseUnary(iteratee));\n    }\n    maxLength = nativeMin(array.length, maxLength);\n    caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n      ? new SetCache(othIndex && array)\n      : undefined;\n  }\n  array = arrays[0];\n\n  var index = -1,\n      seen = caches[0];\n\n  outer:\n  while (++index < length && result.length < maxLength) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (!(seen\n          ? cacheHas(seen, computed)\n          : includes(result, computed, comparator)\n        )) {\n      othIndex = othLength;\n      while (--othIndex) {\n        var cache = caches[othIndex];\n        if (!(cache\n              ? cacheHas(cache, computed)\n              : includes(arrays[othIndex], computed, comparator))\n            ) {\n          continue outer;\n        }\n      }\n      if (seen) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseIntersection;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var isArrayLike = require('./isArrayLike'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nmodule.exports = isArrayLikeObject;\n","var isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Casts `value` to an empty array if it's not an array like object.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array|Object} Returns the cast array-like object.\n */\nfunction castArrayLikeObject(value) {\n  return isArrayLikeObject(value) ? value : [];\n}\n\nmodule.exports = castArrayLikeObject;\n","var arrayMap = require('./_arrayMap'),\n    baseIntersection = require('./_baseIntersection'),\n    baseRest = require('./_baseRest'),\n    castArrayLikeObject = require('./_castArrayLikeObject');\n\n/**\n * Creates an array of unique values that are included in all given arrays\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons. The order and references of result values are\n * determined by the first array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of intersecting values.\n * @example\n *\n * _.intersection([2, 1], [2, 3]);\n * // => [2]\n */\nvar intersection = baseRest(function(arrays) {\n  var mapped = arrayMap(arrays, castArrayLikeObject);\n  return (mapped.length && mapped[0] === arrays[0])\n    ? baseIntersection(mapped)\n    : [];\n});\n\nmodule.exports = intersection;\n","// Inspired by: https://github.com/darkskyapp/binary-search#readme\r\nexport default function binarySearch<T>(\r\n  sortedArray: T[],\r\n  target: T,\r\n  comparator: (item: T, target: T) => number,\r\n  round?: \"up\" | \"down\"\r\n) {\r\n  var mid, cmp;\r\n\r\n  let low = 0;\r\n  let high = sortedArray.length - 1;\r\n\r\n  while (low <= high) {\r\n    // The naive `low + high >>> 1` could fail for array lengths > 2**31\r\n    // because `>>>` converts its operands to int32. `low + (high - low >>> 1)`\r\n    // works for array lengths <= 2**32-1 which is also Javascript's max array\r\n    // length.\r\n    mid = low + ((high - low) >>> 1);\r\n    cmp = +comparator(sortedArray[mid], target);\r\n\r\n    // Too low.\r\n    if (cmp < 0.0) low = mid + 1;\r\n    // Too high.\r\n    else if (cmp > 0.0) high = mid - 1;\r\n    // Key found.\r\n    else {\r\n      return mid;\r\n    }\r\n  }\r\n\r\n  // return closest\r\n  if (round === \"up\") {\r\n    if (high + 1 > sortedArray.length - 1) {\r\n      return -1;\r\n    }\r\n    return high + 1;\r\n  }\r\n  if (round === \"down\") {\r\n    if (high < 0) {\r\n      return -1;\r\n    }\r\n    return high <= sortedArray.length - 1 ? high : sortedArray.length - 1;\r\n  }\r\n  // Key not found.\r\n  return ~low;\r\n}\r\n\r\nexport function findRange<T>(\r\n  sortedArray: T[],\r\n  comparator: (item: T, target: T) => number,\r\n  min?: T,\r\n  max?: T\r\n): T[] {\r\n  let startIndex = 0;\r\n  let endIndex = sortedArray.length - 1;\r\n\r\n  // // console.log(\"TCL: sortedKeys\", sortedKeys);\r\n  if (min) {\r\n    startIndex = binarySearch(sortedArray, min, comparator, \"up\");\r\n  }\r\n  if (max) {\r\n    endIndex = binarySearch(sortedArray, max, comparator, \"down\");\r\n  }\r\n\r\n  // Binary search will\r\n  if (endIndex < 0 || startIndex < 0) {\r\n    return [];\r\n  }\r\n\r\n  return sortedArray.slice(startIndex, endIndex + 1);\r\n}\r\n\r\nexport function findNumberRange(sortedArray: number[], min?: number, max?: number): number[] {\r\n  return findRange(sortedArray, compareNumbers, min, max);\r\n}\r\n\r\nexport function findStringRange(sortedArray: string[], min?: string, max?: string): string[] {\r\n  return findRange(sortedArray, compareStrings, min, max);\r\n}\r\nexport function compareStrings(a: string, b: string) {\r\n  if (a === b) return 0;\r\n  return a < b ? -1 : 1;\r\n}\r\n\r\nexport function compareNumbers(a: number, b: number) {\r\n  return a - b;\r\n}\r\n","import { IndexFilter, SearchIndex, IndexType, FilterResult, RefinerOption } from \"../interfaces\";\r\nimport flatten from \"lodash/flatten\";\r\nimport uniq from \"lodash/uniq\";\r\nimport intersection from \"lodash/intersection\";\r\n\r\nimport { findNumberRange, findStringRange } from \"./binarySearch\";\r\n\r\nfunction findByNumber(index: SearchIndex, min?: number, max?: number) {\r\n  if (min === undefined && max === undefined) return null;\r\n\r\n  let hashes = findNumberRange(index.sortedKeys, min, max);\r\n  return uniq(flatten(hashes.map((hash) => index.value[hash])));\r\n}\r\n\r\nfunction findByDate(\r\n  // Date Index stores a sorted array of ISO Date Strings\r\n  index: SearchIndex,\r\n  min?: Date,\r\n  max?: Date\r\n) {\r\n  if (min === undefined && max === undefined) return null;\r\n\r\n  let minDateStr = min ? min.toISOString() : \"\";\r\n  let maxDateStr = max ? max.toISOString() : \"\";\r\n  let hashes = findStringRange(index.sortedKeys, minDateStr, maxDateStr);\r\n  // console.log(\"TCL: hashes\", startIndex, endIndex, hashes);\r\n  return uniq(flatten(hashes.map((hash) => index.value[hash])));\r\n}\r\n\r\nfunction findByString(index: SearchIndex, values: string[]) {\r\n  values = values.filter(Boolean);\r\n  let isExactEquals = !values.find((v) => v.indexOf(\"*\") > -1);\r\n\r\n  if (isExactEquals) {\r\n    return index.sortedKeys.reduce((results, hashKey) => {\r\n      // Is it a match? Or do we not have values?\r\n      if (values.indexOf(hashKey) > -1 || !values.length) {\r\n        //It's a match so push any items that aren't already in the results array\r\n        let hashMatches = index.value[hashKey];\r\n        hashMatches.forEach((itemId) => {\r\n          if (results.indexOf(itemId) < 0) {\r\n            results.push(itemId);\r\n          }\r\n        });\r\n      }\r\n      return results;\r\n    }, []);\r\n  } else {\r\n    let filterValues = values.map((value) => value.replace(/\\*/gi, \"\").toLowerCase());\r\n    let hashKeys = index.sortedKeys;\r\n    let filteredHashes = hashKeys.filter((hashKey) => {\r\n      let matches = filterValues.filter(\r\n        (filterValue) => hashKey.toLowerCase().indexOf(filterValue) > -1\r\n      );\r\n      return matches.length;\r\n    });\r\n    let itemKeys = filteredHashes.map((hash) => index.value[hash]);\r\n    return uniq(flatten(itemKeys));\r\n  }\r\n}\r\n\r\nfunction findByIndexFilter(\r\n  { indexDefinition, values, min, max }: IndexFilter,\r\n  index: SearchIndex\r\n): number[] {\r\n  if (!indexDefinition || !index) return [];\r\n\r\n  // return null if there is no filter value\r\n  if (values === undefined && min === undefined && max === undefined) {\r\n    return null;\r\n  }\r\n\r\n  if (indexDefinition.type === IndexType.String) {\r\n    return findByString(index, values as string[]);\r\n  }\r\n\r\n  if (indexDefinition.type === IndexType.Number) {\r\n    return findByNumber(index, min as number, max as number);\r\n  }\r\n\r\n  if (indexDefinition.type === IndexType.Date) {\r\n    return findByDate(index, min as Date, max as Date);\r\n  }\r\n}\r\n\r\nfunction getRefinerOptions(index: SearchIndex, filterResults: FilterResult[]): RefinerOption[] {\r\n  // Figure out which filter result sets should be used to calculate the options\r\n  // All results sets except the index being calculated\r\n  let nonTargetFilterResults = filterResults.filter((f) => f.indexKey !== index.key);\r\n  // Find all matches except for matches for this index\r\n  let nonTargetMatches: number[] = intersection(...nonTargetFilterResults.map((f) => f.matches));\r\n\r\n  let refinerOptions: RefinerOption[] = [];\r\n  let hashKeys = Object.keys(index.value);\r\n  for (var i = 0; i < hashKeys.length; i++) {\r\n    let count =\r\n      !nonTargetFilterResults || !nonTargetFilterResults.length\r\n        ? // We weren't passed any non target filter results so return the whole hash count\r\n          index.value[hashKeys[i]].length\r\n        : nonTargetMatches.length\r\n        ? // If we have non target index filter results, then return the count of their intersection\r\n          intersection(index.value[hashKeys[i]], nonTargetMatches).length\r\n        : // otherwise return Zero because we have a nonTarget index filter with no matches\r\n          0;\r\n\r\n    if (count) {\r\n      refinerOptions.push({ key: hashKeys[i], count });\r\n    }\r\n  }\r\n\r\n  return refinerOptions;\r\n}\r\n\r\nexport const finders = {\r\n  findByDate,\r\n  findByNumber,\r\n  findByString,\r\n  findByIndexFilter,\r\n  getRefinerOptions,\r\n};\r\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var copyObject = require('./_copyObject'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.assign` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return object && copyObject(source, keys(source), object);\n}\n\nmodule.exports = baseAssign;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n","var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n","var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * The base implementation of `_.assignIn` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssignIn(object, source) {\n  return object && copyObject(source, keysIn(source), object);\n}\n\nmodule.exports = baseAssignIn;\n","var root = require('./_root');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nmodule.exports = cloneBuffer;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var copyObject = require('./_copyObject'),\n    getSymbols = require('./_getSymbols');\n\n/**\n * Copies own symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbols(source, object) {\n  return copyObject(source, getSymbols(source), object);\n}\n\nmodule.exports = copySymbols;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","var arrayPush = require('./_arrayPush'),\n    getPrototype = require('./_getPrototype'),\n    getSymbols = require('./_getSymbols'),\n    stubArray = require('./stubArray');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nmodule.exports = getSymbolsIn;\n","var copyObject = require('./_copyObject'),\n    getSymbolsIn = require('./_getSymbolsIn');\n\n/**\n * Copies own and inherited symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbolsIn(source, object) {\n  return copyObject(source, getSymbolsIn(source), object);\n}\n\nmodule.exports = copySymbolsIn;\n","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbolsIn = require('./_getSymbolsIn'),\n    keysIn = require('./keysIn');\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nmodule.exports = getAllKeysIn;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nmodule.exports = initCloneArray;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var Uint8Array = require('./_Uint8Array');\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nmodule.exports = cloneArrayBuffer;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nmodule.exports = cloneDataView;\n","/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nmodule.exports = cloneRegExp;\n","var Symbol = require('./_Symbol');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nmodule.exports = cloneSymbol;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nmodule.exports = cloneTypedArray;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer'),\n    cloneDataView = require('./_cloneDataView'),\n    cloneRegExp = require('./_cloneRegExp'),\n    cloneSymbol = require('./_cloneSymbol'),\n    cloneTypedArray = require('./_cloneTypedArray');\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nmodule.exports = initCloneByTag;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var baseCreate = require('./_baseCreate'),\n    getPrototype = require('./_getPrototype'),\n    isPrototype = require('./_isPrototype');\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nmodule.exports = initCloneObject;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nmodule.exports = baseIsMap;\n","var baseIsMap = require('./_baseIsMap'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nmodule.exports = isMap;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nmodule.exports = baseIsSet;\n","var baseIsSet = require('./_baseIsSet'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nmodule.exports = isSet;\n","var Stack = require('./_Stack'),\n    arrayEach = require('./_arrayEach'),\n    assignValue = require('./_assignValue'),\n    baseAssign = require('./_baseAssign'),\n    baseAssignIn = require('./_baseAssignIn'),\n    cloneBuffer = require('./_cloneBuffer'),\n    copyArray = require('./_copyArray'),\n    copySymbols = require('./_copySymbols'),\n    copySymbolsIn = require('./_copySymbolsIn'),\n    getAllKeys = require('./_getAllKeys'),\n    getAllKeysIn = require('./_getAllKeysIn'),\n    getTag = require('./_getTag'),\n    initCloneArray = require('./_initCloneArray'),\n    initCloneByTag = require('./_initCloneByTag'),\n    initCloneObject = require('./_initCloneObject'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isMap = require('./isMap'),\n    isObject = require('./isObject'),\n    isSet = require('./isSet'),\n    keys = require('./keys');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nmodule.exports = baseClone;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nmodule.exports = last;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","/**\n * The base implementation of `_.slice` without an iteratee call guard.\n *\n * @private\n * @param {Array} array The array to slice.\n * @param {number} [start=0] The start position.\n * @param {number} [end=array.length] The end position.\n * @returns {Array} Returns the slice of `array`.\n */\nfunction baseSlice(array, start, end) {\n  var index = -1,\n      length = array.length;\n\n  if (start < 0) {\n    start = -start > length ? 0 : (length + start);\n  }\n  end = end > length ? length : end;\n  if (end < 0) {\n    end += length;\n  }\n  length = start > end ? 0 : ((end - start) >>> 0);\n  start >>>= 0;\n\n  var result = Array(length);\n  while (++index < length) {\n    result[index] = array[index + start];\n  }\n  return result;\n}\n\nmodule.exports = baseSlice;\n","var baseGet = require('./_baseGet'),\n    baseSlice = require('./_baseSlice');\n\n/**\n * Gets the parent value at `path` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} path The path to get the parent value of.\n * @returns {*} Returns the parent value.\n */\nfunction parent(object, path) {\n  return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));\n}\n\nmodule.exports = parent;\n","var castPath = require('./_castPath'),\n    last = require('./last'),\n    parent = require('./_parent'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.unset`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The property path to unset.\n * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n */\nfunction baseUnset(object, path) {\n  path = castPath(path, object);\n  object = parent(object, path);\n  return object == null || delete object[toKey(last(path))];\n}\n\nmodule.exports = baseUnset;\n","var baseGetTag = require('./_baseGetTag'),\n    getPrototype = require('./_getPrototype'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nmodule.exports = isPlainObject;\n","var isPlainObject = require('./isPlainObject');\n\n/**\n * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain\n * objects.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {string} key The key of the property to inspect.\n * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.\n */\nfunction customOmitClone(value) {\n  return isPlainObject(value) ? undefined : value;\n}\n\nmodule.exports = customOmitClone;\n","var flatten = require('./flatten'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * A specialized version of `baseRest` which flattens the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @returns {Function} Returns the new function.\n */\nfunction flatRest(func) {\n  return setToString(overRest(func, undefined, flatten), func + '');\n}\n\nmodule.exports = flatRest;\n","var arrayMap = require('./_arrayMap'),\n    baseClone = require('./_baseClone'),\n    baseUnset = require('./_baseUnset'),\n    castPath = require('./_castPath'),\n    copyObject = require('./_copyObject'),\n    customOmitClone = require('./_customOmitClone'),\n    flatRest = require('./_flatRest'),\n    getAllKeysIn = require('./_getAllKeysIn');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * The opposite of `_.pick`; this method creates an object composed of the\n * own and inherited enumerable property paths of `object` that are not omitted.\n *\n * **Note:** This method is considerably slower than `_.pick`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The source object.\n * @param {...(string|string[])} [paths] The property paths to omit.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.omit(object, ['a', 'c']);\n * // => { 'b': '2' }\n */\nvar omit = flatRest(function(object, paths) {\n  var result = {};\n  if (object == null) {\n    return result;\n  }\n  var isDeep = false;\n  paths = arrayMap(paths, function(path) {\n    path = castPath(path, object);\n    isDeep || (isDeep = path.length > 1);\n    return path;\n  });\n  copyObject(object, getAllKeysIn(object), result);\n  if (isDeep) {\n    result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);\n  }\n  var length = paths.length;\n  while (length--) {\n    baseUnset(result, paths[length]);\n  }\n  return result;\n});\n\nmodule.exports = omit;\n","import { IndexFilter, Filter } from \"../interfaces\";\r\nimport omit from \"lodash/omit\";\r\n\r\nexport function parseFilter(filter: Filter): IndexFilter[] {\r\n  if (!filter) return [];\r\n\r\n  let filters = Object.keys(filter).map((indexKey) => {\r\n    let indexFilter: IndexFilter = {\r\n      indexKey,\r\n    };\r\n    let filterVal = filter[indexKey];\r\n    if (Array.isArray(filterVal)) {\r\n      indexFilter.values = filterVal;\r\n    } else if (typeof filterVal === \"object\") {\r\n      indexFilter = {\r\n        ...indexFilter,\r\n        ...filterVal,\r\n      };\r\n    } else {\r\n      indexFilter.values = [filterVal as any];\r\n    }\r\n    return indexFilter;\r\n  });\r\n\r\n  return filters;\r\n}\r\n\r\nexport function filterToString(filter: IndexFilter) {\r\n  if (!filter) return \"\";\r\n  return JSON.stringify(omit(filter, \"indexDefinition\"));\r\n}\r\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","import { parse as parseQS } from \"querystring\";\r\n\r\nexport interface CacheOptions {\r\n  duration?: number;\r\n  location?: Storage;\r\n  key?: string;\r\n  // Allow figuring out cache key at runtime using the args provided to the wrapped async function\r\n  getCacheKey?: (...providedParams: any[]) => string;\r\n  cacheBustKey?: string;\r\n}\r\n\r\nlet defaultConfig: CacheOptions = {\r\n  duration: 1000 * 60 * 60 * 24 * 30 /* 30 days */,\r\n  location: localStorage,\r\n  cacheBustKey: \"bustcache\", // bustcache=true or bustcache=true\r\n};\r\n\r\nlet _isExpired = (cacheValue) => {\r\n  return cacheValue.expiration && Date.now() > cacheValue.expiration;\r\n};\r\n\r\nlet getOptions = function(cacheOpts: CacheOptions | string): CacheOptions {\r\n  if (typeof cacheOpts === \"string\") {\r\n    cacheOpts = {\r\n      key: cacheOpts as string,\r\n    };\r\n  }\r\n  return { ...defaultConfig, ...cacheOpts };\r\n};\r\n\r\n/*\r\n *  Check the querystring for a the specified cache buste param key.\r\n *  Note: Currently only look for presence of key, doesn't care what value is\r\n *  So 'bustcache=false' would actually flag as true in \"shouldBustCache\"\r\n */\r\nlet shouldBustCache = function(cbKey: string) {\r\n  cbKey = cbKey.toLowerCase();\r\n  try {\r\n    if (window.location.search) {\r\n      let qsObj = parseQS(window.location.search.substr(1));\r\n      // Lowercasify each querystring param, then check if there is one that matches our cache bust key\r\n      return (\r\n        Object.keys(qsObj)\r\n          .map((key) => key.toLowerCase())\r\n          .indexOf(cbKey) > -1\r\n      );\r\n    }\r\n  } catch (err) {\r\n    console.log(\"Error: Unable to check 'shouldBustCache'\", err);\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getCache = (cacheOpts: CacheOptions | string) => {\r\n  let opts = getOptions(cacheOpts);\r\n  if (shouldBustCache(opts.cacheBustKey)) return null;\r\n  let { location } = opts;\r\n  if (!opts.key && !opts.getCacheKey) throw new Error(\"key is required\");\r\n\r\n  let valueStr = location.getItem(opts.key);\r\n\r\n  if (valueStr) {\r\n    let val = JSON.parse(valueStr);\r\n    return !_isExpired(val) ? val.payload : null;\r\n  } else {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const setCache = (cacheOpts: CacheOptions | string, payload: any) => {\r\n  let opts = getOptions(cacheOpts);\r\n  let { duration, location } = opts;\r\n\r\n  if (!opts.key && !opts.getCacheKey) throw new Error(\"key is required\");\r\n\r\n  let nowTicks = Date.now();\r\n  let expiration = (duration && nowTicks + duration) || null;\r\n  location.setItem(opts.key, JSON.stringify({ payload, expiration }));\r\n  return getCache(opts);\r\n};\r\n\r\nexport const cachify = function(asyncFn: any, cacheConfig: CacheOptions, context: any = this) {\r\n  if (!asyncFn || typeof asyncFn !== \"function\") {\r\n    throw new Error(\"Cachify Error: You must pass an async function as the first param\");\r\n  }\r\n  if (!cacheConfig && !cacheConfig.getCacheKey) {\r\n    throw new Error(\r\n      \"Cachify Error: You must pass a cacheConfig object with a 'key' or 'getCacheKey', Ex: cachify(fetchUsers, { key: 'myapp-users' }\"\r\n    );\r\n  }\r\n  return async function(...args) {\r\n    let cacheOptions = { ...cacheConfig };\r\n    // Allow figuring out cache key at runtime using the args provided to the wrapped async function\r\n    if (!cacheOptions.key) {\r\n      cacheOptions.key = cacheOptions.getCacheKey(...args);\r\n    }\r\n    let data = getCache(cacheOptions);\r\n    if (!data) {\r\n      data = await asyncFn.apply(context, args);\r\n      setCache(cacheOptions, data);\r\n    }\r\n    return data;\r\n  };\r\n};\r\n\r\nexport default { get: getCache, set: setCache };\r\n","import RefinerDB from \"../RefinerDB\";\r\nimport { SearchIndex } from \"..\";\r\nimport { indexers } from \"./indexers\";\r\nimport Dexie from \"dexie\";\r\nimport omit from \"lodash/omit\";\r\n\r\nlet activeQueryId = -1;\r\n\r\nexport default async function reindex(db: RefinerDB, queryId = Date.now()) {\r\n  activeQueryId = queryId;\r\n\r\n  return db.transaction(\"rw\", db.allItems, db.indexes, db.filterResults, db.queryResults, () => {\r\n    db.filterResults.clear();\r\n    db.queryResults.clear();\r\n    let indexes: SearchIndex[] = db._indexRegistrations.map((index) => {\r\n      return {\r\n        ...index,\r\n        value: {},\r\n        sortedKeys: [],\r\n      };\r\n    });\r\n    // Loop through each items\r\n    db.allItems\r\n      .each((item, { primaryKey }) => {\r\n        db._indexRegistrations.forEach((indexDefinition, i) => {\r\n          // STRING INDEX\r\n          let indexer = indexers[indexDefinition.type];\r\n          if (indexer) {\r\n            indexer(item, primaryKey, indexes[i]);\r\n          }\r\n        });\r\n      })\r\n      .then(() => {\r\n        if (activeQueryId === queryId) {\r\n          indexes.forEach((index) => {\r\n            index.sortedKeys = index.sortedKeys.sort();\r\n            db.indexes.put(omit(index, \"hashFn\"));\r\n          });\r\n        }\r\n      });\r\n    if (activeQueryId !== queryId) {\r\n      Dexie.currentTransaction.abort();\r\n    }\r\n  });\r\n}\r\n","import Dexie from \"dexie\";\r\nimport {\r\n  SearchIndex,\r\n  IndexConfig,\r\n  RefinerDBConfig,\r\n  IndexState,\r\n  IndexEvent,\r\n  QueryResult,\r\n  FilterResult,\r\n  QueryCriteria,\r\n  Filter,\r\n} from \"./interfaces\";\r\nimport { spawn, Thread, Worker } from \"threads\";\r\nimport { indexers, checkIfModifiedIndexes } from \"./helpers/indexers\";\r\nimport { createStateMachine, createMachineConfig } from \"./stateMachine\";\r\nimport { finders } from \"./helpers/finders\";\r\nimport intersection from \"lodash/intersection\";\r\nimport { Interpreter } from \"xstate\";\r\nimport omit from \"lodash/omit\";\r\nimport { parseFilter, filterToString } from \"./helpers/filterParser\";\r\nimport { setCache, getCache } from \"./helpers/cache\";\r\nimport reindex from \"./helpers/reindex\";\r\n\r\nexport default class RefinerDB extends Dexie {\r\n  static destroy = (dbName: string) => {\r\n    Dexie.delete(dbName);\r\n  };\r\n  allItems: Dexie.Table<any, number>;\r\n  indexes: Dexie.Table<SearchIndex, string>;\r\n  filterResults: Dexie.Table<FilterResult, string>;\r\n  queryResults: Dexie.Table<QueryResult, string>;\r\n\r\n  _criteria: QueryCriteria = { filter: null };\r\n  _indexRegistrations: IndexConfig[] = [];\r\n  private stateMachine: Interpreter<any>;\r\n  private activeIndexingId = -1;\r\n  private activeQueryId = -1;\r\n  config: RefinerDBConfig = {\r\n    indexDelay: 750,\r\n    itemsIndexSchema: \"++_id\",\r\n    useWebWorkers: true,\r\n  };\r\n\r\n  constructor(dbName: string, config?: RefinerDBConfig) {\r\n    super(dbName);\r\n    this.config = {\r\n      ...this.config,\r\n      ...config,\r\n    };\r\n    this.initDB();\r\n    this.stateMachine = createStateMachine(\r\n      createMachineConfig(this._reIndex, this._query, this.config.indexDelay),\r\n      this.config.onTransition\r\n    );\r\n    this._indexRegistrations = getCache(this.name + \"-indexes\") || [];\r\n  }\r\n\r\n  initDB = () => {\r\n    this.version(1).stores({\r\n      allItems: this.config.itemsIndexSchema,\r\n      indexes: \"key\",\r\n      filterResults: \"key\",\r\n      queryResults: \"key\",\r\n    });\r\n    this.allItems = this.table(\"allItems\");\r\n    this.indexes = this.table(\"indexes\");\r\n    this.filterResults = this.table(\"filterResults\");\r\n  };\r\n\r\n  get criteria() {\r\n    return this._criteria;\r\n  }\r\n  setCriteria = (criteria: QueryCriteria) => {\r\n    if (!criteria) {\r\n      return;\r\n    }\r\n    this._criteria = criteria;\r\n    this.stateMachine.send(IndexEvent.QUERY_START);\r\n  };\r\n  getCriteriaKey = () => {\r\n    return JSON.stringify(this._criteria);\r\n  };\r\n  get indexRegistrations() {\r\n    return this._indexRegistrations;\r\n  }\r\n  setIndexes = (indexes: IndexConfig[], forceReindex = false) => {\r\n    if (forceReindex === true || checkIfModifiedIndexes(this._indexRegistrations, indexes)) {\r\n      this._indexRegistrations = indexes;\r\n      setCache(this.name + \"-indexes\", this._indexRegistrations);\r\n      this.stateMachine.send(IndexEvent.INVALIDATE);\r\n    }\r\n  };\r\n\r\n  getIndexState = (): IndexState => {\r\n    return this.stateMachine?.state?.value as IndexState;\r\n  };\r\n\r\n  setItems = async (items: any[]) => {\r\n    this.stateMachine.send(IndexEvent.INVALIDATE);\r\n    await this.transaction(\r\n      \"rw\",\r\n      this.allItems,\r\n      this.indexes,\r\n      this.filterResults,\r\n      this.queryResults,\r\n      () => {\r\n        // TODO: queryResults.clear() throws an error if there are none?\r\n        // this.queryResults.clear();\r\n        this.indexes.clear();\r\n        this.filterResults.clear();\r\n        this.queryResults.clear();\r\n        this.allItems.clear();\r\n        this.allItems.bulkAdd(items);\r\n      }\r\n    );\r\n  };\r\n\r\n  pushItems = async (items: any[]) => {\r\n    this.stateMachine.send(IndexEvent.INVALIDATE);\r\n    await this.transaction(\r\n      \"rw\",\r\n      this.allItems,\r\n      this.indexes,\r\n      this.filterResults,\r\n      this.queryResults,\r\n      () => {\r\n        // TODO: queryResults.clear() throws an error if there are none?\r\n        // this.queryResults.clear();\r\n        this.indexes.clear();\r\n        this.filterResults.clear();\r\n        this.allItems.clear();\r\n        this.queryResults.clear();\r\n        this.allItems.bulkPut(items);\r\n      }\r\n    );\r\n  };\r\n\r\n  // deleteItems = async (filter?: Filter) => {\r\n  //   // TODO: query using the filter for a set of itemId's to delete\r\n\r\n  // }\r\n\r\n  waitForState = (targetState: IndexState) => {\r\n    return new Promise((resolve, reject) => {\r\n      let handler = (state) => {\r\n        if (state?.value === targetState) {\r\n          this.stateMachine.off(handler);\r\n          resolve(true);\r\n        }\r\n      };\r\n      this.stateMachine.onTransition(handler);\r\n    });\r\n  };\r\n\r\n  reIndex = async () => {\r\n    this.stateMachine.send(IndexEvent.INDEX_START);\r\n    await this.waitForState(IndexState.IDLE);\r\n    return;\r\n  };\r\n\r\n  getQueryResult = async () => {\r\n    await this.waitForState(IndexState.IDLE);\r\n    return this.queryResults.get(this.getCriteriaKey());\r\n  };\r\n\r\n  query = async (criteria: QueryCriteria) => {\r\n    if (criteria) {\r\n      this.setCriteria(criteria);\r\n    }\r\n    return this.getQueryResult();\r\n  };\r\n\r\n  _query = async (queryId: number = Date.now()): Promise<QueryResult> => {\r\n    this.activeQueryId = queryId;\r\n    let result: QueryResult = null;\r\n    let filters = parseFilter(this._criteria.filter);\r\n\r\n    let allIndexes: SearchIndex[] = (await this.indexes.bulkGet(\r\n      this._indexRegistrations.map((index) => index.key)\r\n    )) as any;\r\n\r\n    // Check for a stale query id after every async activity\r\n    if (this.activeQueryId !== queryId) return;\r\n\r\n    await this.transaction(\r\n      \"rw\",\r\n      this.indexes,\r\n      this.allItems,\r\n      this.filterResults,\r\n      this.queryResults,\r\n      async () => {\r\n        // Get an array of arrays. where we store a set of itemId matches for each filter\r\n        let filterResults: FilterResult[] = [];\r\n        for (var i = 0; i < filters.length; i++) {\r\n          let filter = filters[i];\r\n          let filterKey = filterToString(filter);\r\n          let matches = [];\r\n          let indexDefinition = this._indexRegistrations.find((i) => i.key === filter.indexKey);\r\n          let cachedFilterResult = this.filterResults.get(filterKey) as any;\r\n          if (cachedFilterResult && cachedFilterResult.matches) {\r\n            matches = cachedFilterResult.itemIds;\r\n          } else {\r\n            matches = finders.findByIndexFilter(\r\n              { indexDefinition, ...filter },\r\n              allIndexes.find((i) => i.key === filter.indexKey)\r\n            );\r\n            this.filterResults.put({ key: filterKey, matches, indexKey: filter.indexKey });\r\n          }\r\n          filterResults.push({\r\n            indexKey: filter.indexKey,\r\n            key: filterKey,\r\n            matches,\r\n          });\r\n        }\r\n\r\n        let refiners = null;\r\n\r\n        if (this._criteria.includeRefiners !== false) {\r\n          let allRefinerOptions = this._indexRegistrations.map((indexRegistration, i) => {\r\n            if (indexRegistration.skipRefinerOptions) {\r\n              return [];\r\n            }\r\n            let index = allIndexes.find((i) => i.key === indexRegistration.key);\r\n            return finders.getRefinerOptions(index, filterResults);\r\n          });\r\n\r\n          refiners = allRefinerOptions.reduce((refiners, options, i) => {\r\n            refiners[this._indexRegistrations[i].key] = options;\r\n            return refiners;\r\n          }, {});\r\n        }\r\n\r\n        let itemIds: number[] = [];\r\n        // If there are no filters, return all items\r\n        if (filterResults.length === 0) {\r\n          itemIds = await this.allItems.toCollection().primaryKeys();\r\n        } else {\r\n          // There are filters so return the intersection of all the matches\r\n          itemIds = intersection(...filterResults.map((r) => r.matches).filter(Boolean));\r\n        }\r\n        // TODO: how to handle sort?\r\n\r\n        let skip = this._criteria.skip || 0;\r\n        let limit = this._criteria.limit || 1000;\r\n        let trimmedIds = itemIds.slice(skip, skip + limit);\r\n\r\n        let items = await this.allItems.bulkGet(trimmedIds);\r\n        // Check for a stale query id after every async activity\r\n        if (this.activeQueryId !== queryId) return;\r\n\r\n        result = { items, refiners, totalCount: itemIds.length, key: this.getCriteriaKey() };\r\n        this.queryResults.put(result);\r\n      }\r\n    );\r\n\r\n    // Check for a stale query id after every async activity\r\n    if (this.activeQueryId !== queryId) return;\r\n    return result;\r\n  };\r\n\r\n  _reIndex = async (indexingId: number = Date.now()) => {\r\n    return reindex(this, indexingId);\r\n    // if (!this.config.useWebWorkers) {\r\n    // }\r\n    // const reindexWorker = await spawn(new Worker(\"./workers/worker/reindex\"));\r\n    // let result = await reindexWorker.reindex(this.name, indexingId);\r\n    // console.log(\"TCL: _reIndex -> Web Worker result\", result);\r\n  };\r\n}\r\n","export default function symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n","/* global window */\nimport ponyfill from './ponyfill.js';\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = ponyfill(root);\nexport default result;\n","'use strict';\nconst symbolObservable = require('symbol-observable').default;\n\nmodule.exports = value => Boolean(value && value[symbolObservable] && value === value[symbolObservable]());\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction rehydrateError(error) {\n    return Object.assign(Error(error.message), {\n        name: error.name,\n        stack: error.stack\n    });\n}\nexports.rehydrateError = rehydrateError;\nfunction serializeError(error) {\n    return {\n        message: error.message,\n        name: error.name,\n        stack: error.stack\n    };\n}\nexports.serializeError = serializeError;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.$errors = Symbol(\"thread.errors\");\nexports.$events = Symbol(\"thread.events\");\nexports.$terminate = Symbol(\"thread.terminate\");\nexports.$transferable = Symbol(\"thread.transferable\");\nexports.$worker = Symbol(\"thread.worker\");\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst symbols_1 = require(\"./symbols\");\nfunction isTransferable(thing) {\n    if (!thing || typeof thing !== \"object\")\n        return false;\n    // Don't check too thoroughly, since the list of transferable things in JS might grow over time\n    return true;\n}\nfunction isTransferDescriptor(thing) {\n    return thing && typeof thing === \"object\" && thing[symbols_1.$transferable];\n}\nexports.isTransferDescriptor = isTransferDescriptor;\nfunction Transfer(payload, transferables) {\n    if (!transferables) {\n        if (!isTransferable(payload))\n            throw Error();\n        transferables = [payload];\n    }\n    return {\n        [symbols_1.$transferable]: true,\n        send: payload,\n        transferables\n    };\n}\nexports.Transfer = Transfer;\n","\"use strict\";\n/////////////////////////////\n// Messages sent by master:\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MasterMessageType;\n(function (MasterMessageType) {\n    MasterMessageType[\"run\"] = \"run\";\n})(MasterMessageType = exports.MasterMessageType || (exports.MasterMessageType = {}));\n////////////////////////////\n// Messages sent by worker:\nvar WorkerMessageType;\n(function (WorkerMessageType) {\n    WorkerMessageType[\"error\"] = \"error\";\n    WorkerMessageType[\"init\"] = \"init\";\n    WorkerMessageType[\"result\"] = \"result\";\n    WorkerMessageType[\"running\"] = \"running\";\n    WorkerMessageType[\"uncaughtError\"] = \"uncaughtError\";\n})(WorkerMessageType = exports.WorkerMessageType || (exports.WorkerMessageType = {}));\n","\"use strict\";\n/// <reference lib=\"dom\" />\n// tslint:disable no-shadowed-variable\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst isWorkerRuntime = function isWorkerRuntime() {\n    return typeof self !== \"undefined\" && self.postMessage ? true : false;\n};\nconst postMessageToMaster = function postMessageToMaster(data, transferList) {\n    self.postMessage(data, transferList);\n};\nconst subscribeToMasterMessages = function subscribeToMasterMessages(onMessage) {\n    const messageHandler = (messageEvent) => {\n        onMessage(messageEvent.data);\n    };\n    const unsubscribe = () => {\n        self.removeEventListener(\"message\", messageHandler);\n    };\n    self.addEventListener(\"message\", messageHandler);\n    return unsubscribe;\n};\nexports.default = {\n    isWorkerRuntime,\n    postMessageToMaster,\n    subscribeToMasterMessages\n};\n","\"use strict\";\n/// <reference lib=\"dom\" />\n// tslint:disable no-shadowed-variable\nObject.defineProperty(exports, \"__esModule\", { value: true });\nif (typeof self === \"undefined\") {\n    global.self = global;\n}\nconst isWorkerRuntime = function isWorkerRuntime() {\n    return typeof self !== \"undefined\" && self.postMessage ? true : false;\n};\nconst postMessageToMaster = function postMessageToMaster(data) {\n    // TODO: Warn that Transferables are not supported on first attempt to use feature\n    self.postMessage(data);\n};\nconst subscribeToMasterMessages = function subscribeToMasterMessages(onMessage) {\n    const messageHandler = (messageEvent) => {\n        onMessage(messageEvent.data);\n    };\n    const unsubscribe = () => {\n        self.removeEventListener(\"message\", messageHandler);\n    };\n    self.addEventListener(\"message\", messageHandler);\n    return unsubscribe;\n};\nexports.default = {\n    isWorkerRuntime,\n    postMessageToMaster,\n    subscribeToMasterMessages\n};\n","\"use strict\";\n// Webpack hack\n// tslint:disable no-eval\nObject.defineProperty(exports, \"__esModule\", { value: true });\nlet implementation;\nfunction selectImplementation() {\n    return typeof __non_webpack_require__ === \"function\"\n        ? __non_webpack_require__(\"worker_threads\")\n        : eval(\"require\")(\"worker_threads\");\n}\nfunction getImplementation() {\n    if (!implementation) {\n        implementation = selectImplementation();\n    }\n    return implementation;\n}\nexports.default = getImplementation;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst worker_threads_1 = __importDefault(require(\"../worker_threads\"));\nfunction assertMessagePort(port) {\n    if (!port) {\n        throw Error(\"Invariant violation: MessagePort to parent is not available.\");\n    }\n    return port;\n}\nconst isWorkerRuntime = function isWorkerRuntime() {\n    return !worker_threads_1.default().isMainThread;\n};\nconst postMessageToMaster = function postMessageToMaster(data, transferList) {\n    assertMessagePort(worker_threads_1.default().parentPort).postMessage(data, transferList);\n};\nconst subscribeToMasterMessages = function subscribeToMasterMessages(onMessage) {\n    const parentPort = worker_threads_1.default().parentPort;\n    if (!parentPort) {\n        throw Error(\"Invariant violation: MessagePort to parent is not available.\");\n    }\n    const messageHandler = (message) => {\n        onMessage(message);\n    };\n    const unsubscribe = () => {\n        assertMessagePort(parentPort).off(\"message\", messageHandler);\n    };\n    assertMessagePort(parentPort).on(\"message\", messageHandler);\n    return unsubscribe;\n};\nfunction testImplementation() {\n    // Will throw if `worker_threads` are not available\n    worker_threads_1.default();\n}\nexports.default = {\n    isWorkerRuntime,\n    postMessageToMaster,\n    subscribeToMasterMessages,\n    testImplementation\n};\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","\"use strict\";\n// tslint:disable no-var-requires\n/*\n * This file is only a stub to make './implementation' resolve to the right module.\n */\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst implementation_browser_1 = __importDefault(require(\"./implementation.browser\"));\nconst implementation_tiny_worker_1 = __importDefault(require(\"./implementation.tiny-worker\"));\nconst implementation_worker_threads_1 = __importDefault(require(\"./implementation.worker_threads\"));\nconst runningInNode = typeof process !== 'undefined' && process.arch !== 'browser' && 'pid' in process;\nfunction selectNodeImplementation() {\n    try {\n        implementation_worker_threads_1.default.testImplementation();\n        return implementation_worker_threads_1.default;\n    }\n    catch (error) {\n        return implementation_tiny_worker_1.default;\n    }\n}\nexports.default = runningInNode\n    ? selectNodeImplementation()\n    : implementation_browser_1.default;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst is_observable_1 = __importDefault(require(\"is-observable\"));\nconst common_1 = require(\"../common\");\nconst transferable_1 = require(\"../transferable\");\nconst messages_1 = require(\"../types/messages\");\nconst implementation_1 = __importDefault(require(\"./implementation\"));\nvar transferable_2 = require(\"../transferable\");\nexports.Transfer = transferable_2.Transfer;\nlet exposeCalled = false;\nconst isMasterJobRunMessage = (thing) => thing && thing.type === messages_1.MasterMessageType.run;\n/**\n * There are issues with `is-observable` not recognizing zen-observable's instances.\n * We are using `observable-fns`, but it's based on zen-observable, too.\n */\nconst isObservable = (thing) => is_observable_1.default(thing) || isZenObservable(thing);\nfunction isZenObservable(thing) {\n    return thing && typeof thing === \"object\" && typeof thing.subscribe === \"function\";\n}\nfunction deconstructTransfer(thing) {\n    return transferable_1.isTransferDescriptor(thing)\n        ? { payload: thing.send, transferables: thing.transferables }\n        : { payload: thing, transferables: undefined };\n}\nfunction postFunctionInitMessage() {\n    const initMessage = {\n        type: messages_1.WorkerMessageType.init,\n        exposed: {\n            type: \"function\"\n        }\n    };\n    implementation_1.default.postMessageToMaster(initMessage);\n}\nfunction postModuleInitMessage(methodNames) {\n    const initMessage = {\n        type: messages_1.WorkerMessageType.init,\n        exposed: {\n            type: \"module\",\n            methods: methodNames\n        }\n    };\n    implementation_1.default.postMessageToMaster(initMessage);\n}\nfunction postJobErrorMessage(uid, rawError) {\n    const { payload: error, transferables } = deconstructTransfer(rawError);\n    const errorMessage = {\n        type: messages_1.WorkerMessageType.error,\n        uid,\n        error: common_1.serializeError(error)\n    };\n    implementation_1.default.postMessageToMaster(errorMessage, transferables);\n}\nfunction postJobResultMessage(uid, completed, resultValue) {\n    const { payload, transferables } = deconstructTransfer(resultValue);\n    const resultMessage = {\n        type: messages_1.WorkerMessageType.result,\n        uid,\n        complete: completed ? true : undefined,\n        payload\n    };\n    implementation_1.default.postMessageToMaster(resultMessage, transferables);\n}\nfunction postJobStartMessage(uid, resultType) {\n    const startMessage = {\n        type: messages_1.WorkerMessageType.running,\n        uid,\n        resultType\n    };\n    implementation_1.default.postMessageToMaster(startMessage);\n}\nfunction postUncaughtErrorMessage(error) {\n    const errorMessage = {\n        type: messages_1.WorkerMessageType.uncaughtError,\n        error: common_1.serializeError(error)\n    };\n    implementation_1.default.postMessageToMaster(errorMessage);\n}\nfunction runFunction(jobUID, fn, args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let syncResult;\n        try {\n            syncResult = fn(...args);\n        }\n        catch (error) {\n            return postJobErrorMessage(jobUID, error);\n        }\n        const resultType = isObservable(syncResult) ? \"observable\" : \"promise\";\n        postJobStartMessage(jobUID, resultType);\n        if (isObservable(syncResult)) {\n            syncResult.subscribe(value => postJobResultMessage(jobUID, false, value), error => postJobErrorMessage(jobUID, error), () => postJobResultMessage(jobUID, true));\n        }\n        else {\n            try {\n                const result = yield syncResult;\n                postJobResultMessage(jobUID, true, result);\n            }\n            catch (error) {\n                postJobErrorMessage(jobUID, error);\n            }\n        }\n    });\n}\n/**\n * Expose a function or a module (an object whose values are functions)\n * to the main thread. Must be called exactly once in every worker thread\n * to signal its API to the main thread.\n *\n * @param exposed Function or object whose values are functions\n */\nfunction expose(exposed) {\n    if (!implementation_1.default.isWorkerRuntime()) {\n        throw Error(\"expose() called in the master thread.\");\n    }\n    if (exposeCalled) {\n        throw Error(\"expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.\");\n    }\n    exposeCalled = true;\n    if (typeof exposed === \"function\") {\n        implementation_1.default.subscribeToMasterMessages(messageData => {\n            if (isMasterJobRunMessage(messageData) && !messageData.method) {\n                runFunction(messageData.uid, exposed, messageData.args);\n            }\n        });\n        postFunctionInitMessage();\n    }\n    else if (typeof exposed === \"object\" && exposed) {\n        implementation_1.default.subscribeToMasterMessages(messageData => {\n            if (isMasterJobRunMessage(messageData) && messageData.method) {\n                runFunction(messageData.uid, exposed[messageData.method], messageData.args);\n            }\n        });\n        const methodNames = Object.keys(exposed).filter(key => typeof exposed[key] === \"function\");\n        postModuleInitMessage(methodNames);\n    }\n    else {\n        throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${exposed}`);\n    }\n}\nexports.expose = expose;\nif (typeof self !== \"undefined\" && typeof self.addEventListener === \"function\" && implementation_1.default.isWorkerRuntime()) {\n    self.addEventListener(\"error\", event => {\n        // Post with some delay, so the master had some time to subscribe to messages\n        setTimeout(() => postUncaughtErrorMessage(event.error || event), 250);\n    });\n    self.addEventListener(\"unhandledrejection\", event => {\n        const error = event.reason;\n        if (error && typeof error.message === \"string\") {\n            // Post with some delay, so the master had some time to subscribe to messages\n            setTimeout(() => postUncaughtErrorMessage(error), 250);\n        }\n    });\n}\nif (typeof process !== \"undefined\" && typeof process.on === \"function\" && implementation_1.default.isWorkerRuntime()) {\n    process.on(\"uncaughtException\", (error) => {\n        // Post with some delay, so the master had some time to subscribe to messages\n        setTimeout(() => postUncaughtErrorMessage(error), 250);\n    });\n    process.on(\"unhandledRejection\", (error) => {\n        if (error && typeof error.message === \"string\") {\n            // Post with some delay, so the master had some time to subscribe to messages\n            setTimeout(() => postUncaughtErrorMessage(error), 250);\n        }\n    });\n}\n","module.exports = require(\"./dist/worker/index\")\n","import RefinerDB from \"../RefinerDB\";\r\nimport reindex from \"../helpers/reindex\";\r\nimport { expose } from \"threads/worker\";\r\n\r\nexpose({\r\n  reindex(dbName) {\r\n    let refinerDB = new RefinerDB(dbName, { useWebWorkers: false });\r\n    return reindex(refinerDB);\r\n  },\r\n});\r\n"]}